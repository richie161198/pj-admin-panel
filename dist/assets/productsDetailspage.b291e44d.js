import{a1 as M,b as Q,r as G,j as e,L,c as t,B as n,I as d,F as J,Q as m}from"./index.a3fd4963.js";import{d as q,e as K,f as z,g as W,h as Z}from"./authApiSlice.09c3723a.js";const Y=()=>{var w,k,v,P,j,D,A,C,I;const{id:c}=M(),h=Q(),[u,$]=G.exports.useState(0),{data:l,isLoading:y,error:g,refetch:x}=q(c),[N,{isLoading:f}]=K(),[B,{isLoading:T}]=z(),{data:o,isLoading:R,refetch:F}=W({productId:c,page:1,limit:20,sort:"newest"},{skip:!c}),[O,{isLoading:U}]=Z(),b=r=>{if(!r||typeof r!="string")return!1;const s=r.toLowerCase();return s.includes(".mp4")||s.includes(".webm")||s.includes(".mov")||s.includes("/video/")||s.includes("video/upload")};console.log("API Call Debug:",{id:c,isLoading:y,error:g,productResponse:l,url:`/commerce/singleProduct/${c}`});let a=null;(l==null?void 0:l.products)&&Array.isArray(l.products)?a=l.products[0]:l!=null&&l.product?a=l.product:l&&!l.products&&(a=l),console.log("Product Details:",a),console.log("Product Response:",l);const E=async()=>{if(window.confirm("Are you sure you want to delete this product? This action cannot be undone."))try{await B(c).unwrap(),m.success("Product deleted successfully"),h("/products")}catch{m.error("Failed to delete product")}},V=async()=>{try{await N({id:c,trending:!a.trending}).unwrap(),m.success(`Product ${a.trending?"removed from":"added to"} trending`),x()}catch{m.error("Failed to update trending status")}},_=async()=>{try{await N({id:c,popular:!a.popular}).unwrap(),m.success(`Product ${a.popular?"removed from":"added to"} popular`),x()}catch{m.error("Failed to update popular status")}};return y?e("div",{className:"flex justify-center items-center h-64",children:e(L,{})}):g?(console.error("Product Details Error:",g),t("div",{className:"text-center py-8",children:[t("p",{className:"text-red-500",children:["Error loading product: ",g.message]}),t("p",{className:"text-sm text-gray-500 mt-2",children:["Product ID: ",c]}),t("p",{className:"text-sm text-gray-500",children:["Status: ",g.status]}),t("p",{className:"text-sm text-gray-500",children:["Data: ",JSON.stringify(g.data)]}),t("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-left",children:[e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Full Error:"}),e("pre",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 overflow-auto",children:JSON.stringify(g,null,2)})]}),t("div",{className:"flex space-x-2 mt-4",children:[e(n,{onClick:()=>x(),className:"btn btn-primary",children:"Retry"}),e(n,{onClick:()=>h("/products"),className:"btn btn-outline",children:"Back to Products"})]})]})):a?(console.log("Final Product Check:",{product:a,hasProduct:!!a,productKeys:a?Object.keys(a):[],productId:a==null?void 0:a._id,productName:a==null?void 0:a.name}),t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{className:"flex items-center space-x-4",children:[t(n,{onClick:()=>h("/products"),className:"btn btn-outline",children:[e(d,{icon:"ph:arrow-left",className:"mr-2"}),"Back"]}),t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Product Details"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"View and manage product information"})]})]}),t("div",{className:"flex space-x-3",children:[t(n,{onClick:()=>h(`/products/${c}/edit`),className:"btn btn-outline-secondary",children:[e(d,{icon:"ph:pencil",className:"mr-2"}),"Edit"]}),t(n,{onClick:E,disabled:T,className:"btn btn-outline-danger",children:[e(d,{icon:"ph:trash",className:"mr-2"}),"Delete"]})]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t("div",{className:"lg:col-span-2 space-y-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Product Images"}),a.images&&a.images.length>0?t("div",{className:"space-y-4",children:[e("div",{className:"aspect-square bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden",children:b(a.images[u])?e("video",{src:a.images[u],controls:!0,className:"w-full h-full object-cover",playsInline:!0}):e("img",{src:a.images[u],alt:a.name,className:"w-full h-full object-cover"})}),a.images.length>1&&e("div",{className:"flex space-x-2 overflow-x-auto",children:a.images.map((r,s)=>{const i=b(r);return e("button",{onClick:()=>$(s),className:`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 relative ${u===s?"border-blue-500":"border-gray-200 dark:border-gray-600"}`,children:i?t(J,{children:[e("video",{src:r,className:"w-full h-full object-cover",muted:!0,playsInline:!0}),e("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30",children:e(d,{icon:"ph:play-fill",className:"text-white text-2xl"})})]}):e("img",{src:r,alt:`${a.name} ${s+1}`,className:"w-full h-full object-cover"})},s)})})]}):e("div",{className:"aspect-square bg-gray-100 dark:bg-slate-700 rounded-lg flex items-center justify-center",children:e(d,{icon:"ph:image",className:"text-6xl text-gray-400"})})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[t("div",{className:"flex justify-between items-start mb-4",children:[t("div",{children:[e("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.name}),e("p",{className:"text-gray-600 dark:text-gray-400",children:a.brand}),t("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["SKU: ",a.skuId]})]}),t("div",{className:"flex flex-wrap gap-2",children:[e("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${a.active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:a.active?"Active":"Inactive"}),a.trending&&e("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",children:"Trending"}),a.popular&&e("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Popular"})]})]}),t("div",{className:"flex items-center mb-4",children:[e("div",{className:"flex items-center",children:[...Array(5)].map((r,s)=>{var i;return e(d,{icon:"ph:star-fill",className:`w-5 h-5 ${s<Math.floor(((i=a.rating)==null?void 0:i.value)||0)?"text-yellow-400":"text-gray-300"}`},s)})}),t("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-2",children:[((w=a.rating)==null?void 0:w.value)||0," (",((k=a.rating)==null?void 0:k.count)||0," reviews)"]})]}),t("div",{className:"mb-6",children:[e("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Description"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:a.description||"No description available"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Category"}),e("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:a.categories||"N/A"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Stock"}),t("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:[a.stock||0," units"]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Selected Carat"}),e("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:a.selectedCaret||"N/A"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Carat Options"}),e("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:((v=a.caretOptions)==null?void 0:v.join(", "))||"N/A"})]})]}),a.productDetails&&a.productDetails.length>0&&t("div",{className:"mb-6",children:[e("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Product Specifications"}),e("div",{className:"space-y-3",children:a.productDetails.map((r,s)=>t("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[t("h5",{className:"font-medium text-gray-900 dark:text-white",children:[r.type,": ",r.name]}),r.attributes&&e("div",{className:"mt-2 grid grid-cols-2 gap-2",children:Object.entries(r.attributes).map(([i,p])=>t("div",{children:[t("span",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:[i.replace(/([A-Z])/g," $1").trim(),":"]}),e("span",{className:"text-sm text-gray-900 dark:text-white ml-1",children:p})]},i))})]},s))})]})]})]}),t("div",{className:"space-y-6",children:[t("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pricing Information"}),t("div",{className:"space-y-4",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Selling Price"}),t("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["\u20B9",((P=a.sellingprice)==null?void 0:P.toLocaleString())||0]})]}),a.total&&a.total!==a.sellingprice&&t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Price"}),t("span",{className:"text-sm text-gray-900 dark:text-white line-through",children:["\u20B9 ",a.total.toLocaleString()]})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"GST"}),t("span",{className:"text-sm text-gray-900 dark:text-white",children:[a.gst||0," %"]})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Weight"}),e("span",{className:"text-sm text-gray-900 dark:text-white",children:((j=a.subtotal)==null?void 0:j.weight)||"N/A"})]})]}),a.priceDetails&&a.priceDetails.length>0&&t("div",{className:"mt-6",children:[e("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Price Breakdown"}),e("div",{className:"space-y-2",children:a.priceDetails.map((r,s)=>{var i;return t("div",{className:"flex justify-between text-sm",children:[t("span",{className:"text-gray-500 dark:text-gray-400",children:[r.name," ",r.weight&&`(${r.weight})`]}),t("span",{className:"text-gray-900 dark:text-white",children:["\u20B9 ",((i=r.value)==null?void 0:i.toLocaleString())||0]})]},s)})})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),t("div",{className:"space-y-3",children:[t(n,{onClick:V,disabled:f,className:`btn w-full justify-start ${a.trending?"btn-outline-warning":"btn-outline"}`,children:[e(d,{icon:a.trending?"ph:fire":"ph:fire-simple",className:"mr-2"}),a.trending?"Remove from Trending":"Add to Trending"]}),t(n,{onClick:_,disabled:f,className:`btn w-full justify-start ${a.popular?"btn-outline-success":"btn-outline"}`,children:[e(d,{icon:a.popular?"ph:heart-fill":"ph:heart",className:"mr-2"}),a.popular?"Remove from Popular":"Add to Popular"]}),t(n,{onClick:()=>h(`/products/${c}/edit`),className:"btn btn-outline w-full justify-start",children:[e(d,{icon:"ph:pencil",className:"mr-2"}),"Edit Product"]})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Product Statistics"}),t("div",{className:"space-y-4",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Created"}),e("span",{className:"text-sm text-gray-900 dark:text-white",children:a.createdAt?new Date(a.createdAt).toLocaleDateString():"N/A"})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Updated"}),e("span",{className:"text-sm text-gray-900 dark:text-white",children:a.updatedAt?new Date(a.updatedAt).toLocaleDateString():"N/A"})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Rating"}),t("span",{className:"text-sm text-gray-900 dark:text-white",children:[((D=a.rating)==null?void 0:D.value)||0,"/5"]})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Reviews"}),e("span",{className:"text-sm text-gray-900 dark:text-white",children:((A=a.rating)==null?void 0:A.count)||0})]})]})]})]})]}),t("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("div",{className:"flex justify-between items-center mb-6",children:t("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Product Reviews (",((C=o==null?void 0:o.pagination)==null?void 0:C.totalReviews)||((I=a.rating)==null?void 0:I.count)||0,")"]})}),R?e("div",{className:"flex justify-center py-8",children:e(L,{})}):(o==null?void 0:o.reviews)&&o.reviews.length>0?e("div",{className:"space-y-4",children:o.reviews.map(r=>{var s,i;return t("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[t("div",{className:"flex justify-between items-start mb-3",children:[t("div",{className:"flex items-start space-x-3",children:[e("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:((i=(s=r.userName)==null?void 0:s[0])==null?void 0:i.toUpperCase())||"A"}),t("div",{children:[t("div",{className:"flex items-center space-x-2",children:[e("p",{className:"font-medium text-gray-900 dark:text-white",children:r.userName||"Anonymous"}),r.isVerified&&e("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Verified"})]}),t("div",{className:"flex items-center space-x-2 mt-1",children:[e("div",{className:"flex items-center",children:[...Array(5)].map((p,S)=>e(d,{icon:"ph:star-fill",className:`w-4 h-4 ${S<r.rating?"text-yellow-400":"text-gray-300"}`},S))}),e("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(r.createdAt).toLocaleDateString()})]})]})]}),e(n,{onClick:async()=>{if(window.confirm("Are you sure you want to delete this review?"))try{await O(r._id).unwrap(),m.success("Review deleted successfully"),F(),x()}catch{m.error("Failed to delete review")}},disabled:U,className:"btn btn-outline-danger btn-sm",children:e(d,{icon:"ph:trash",className:"w-4 h-4"})})]}),r.title&&e("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:r.title}),e("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:r.body})]},r._id)})}):t("div",{className:"text-center py-8",children:[e(d,{icon:"ph:chat-circle-dots",className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e("p",{className:"text-gray-500 dark:text-gray-400",children:"No reviews yet"})]})]})]})):t("div",{className:"text-center py-8",children:[e("p",{className:"text-gray-500",children:"Product not found"}),t("p",{className:"text-sm text-gray-400 mt-2",children:["Product ID: ",c]}),t("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-left",children:[e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Debug Info:"}),e("pre",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 overflow-auto",children:JSON.stringify(l,null,2)})]}),t("div",{className:"flex space-x-2 mt-4",children:[e(n,{onClick:()=>h("/products"),className:"btn btn-outline",children:"Back to Products"}),e(n,{onClick:()=>x(),className:"btn btn-primary",children:"Test API Call"})]})]})};export{Y as default};
