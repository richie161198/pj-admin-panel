import{b as U,r as g,j as e,L as H,c as a,I as n,B as c,Q as T}from"./index.a3fd4963.js";import{g as J}from"./orderApi.f4e71a4b.js";import{B as E}from"./Badge.f053513c.js";import{u as f,a as K}from"./xlsx.0799a57e.js";const ae=()=>{var P,S,A,C,D;const M=U(),[p,L]=g.exports.useState(""),[j,m]=g.exports.useState(1),[y,B]=g.exports.useState(""),[b,F]=g.exports.useState(""),[x,v]=g.exports.useState(""),[N,G]=g.exports.useState(""),$={page:j,limit:10,...y&&{status:y},...b&&{type:b},...p&&{search:p},...x&&{startDate:x},...N&&{endDate:N}},{data:d,isLoading:V,error:k,refetch:z}=J($),o=((P=d==null?void 0:d.data)==null?void 0:P.orders)||[],r=((S=d==null?void 0:d.data)==null?void 0:S.pagination)||{},h=((A=d==null?void 0:d.data)==null?void 0:A.summary)||{};console.log("Investment Orders Response:",d),console.log("Orders:",o),console.log("Pagination:",r),console.log("Summary:",h);const Q=t=>{M(`/investment-orders/${t}`)},W=t=>{const l={pending:{color:"warning",text:"Pending"},processing:{color:"info",text:"Processing"},completed:{color:"success",text:"Completed"},failed:{color:"danger",text:"Failed"},cancelled:{color:"secondary",text:"Cancelled"},refunded:{color:"warning",text:"Refunded"}}[t]||{color:"secondary",text:t};return e(E,{className:`badge-${l.color}`,children:l.text})},w=t=>{const l={deposit:{color:"success",text:"Deposit"},withdrawal:{color:"warning",text:"Withdrawal"},gold_purchase:{color:"info",text:"Gold Purchase"},silver_purchase:{color:"secondary",text:"Silver Purchase"},gold_sale:{color:"danger",text:"Gold Sale"},silver_sale:{color:"secondary",text:"Silver Sale"}}[t]||{color:"secondary",text:t};return e(E,{className:`badge-${l.color}`,children:l.text})},q=()=>{try{const t=o.map((s,R)=>{var I,O,_;return{"S.No":R+1,"Order ID":s.orderId||"N/A","Customer Name":((I=s.userId)==null?void 0:I.name)||"N/A","Customer Email":((O=s.userId)==null?void 0:O.email)||"N/A","Customer Phone":((_=s.userId)==null?void 0:_.phone)||"N/A",Type:s.orderType||"N/A",Asset:s.transactionType||"N/A",Status:s.status||"N/A",Amount:s.inramount||0,Currency:s.currency||"INR","Payment Method":s.Payment_method||"N/A","Created At":s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A","Updated At":s.updatedAt?new Date(s.updatedAt).toLocaleDateString():"N/A"}}),i=f.json_to_sheet(t),l=f.book_new();f.book_append_sheet(l,i,"Investment Orders");const u=`investment-orders-${new Date().toISOString().split("T")[0]}.xlsx`;K(l,u),T.success("Excel file downloaded successfully")}catch(t){console.error("Error downloading Excel:",t),T.error("Failed to download Excel file")}};return V?e("div",{className:"flex justify-center items-center h-64",children:e(H,{})}):k?a("div",{className:"text-center py-12",children:[e(n,{icon:"ph:warning-circle",className:"text-6xl text-red-500 mx-auto mb-4"}),e("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Error Loading Orders"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:k.message}),a(c,{onClick:()=>z(),className:"btn btn-primary",children:[e(n,{icon:"ph:arrow-clockwise",className:"mr-2"}),"Try Again"]})]}):a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Investment Orders"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage investment transactions and orders"})]}),e("div",{className:"flex space-x-3",children:a(c,{onClick:q,className:"btn btn-outline-success",disabled:!o||o.length===0,children:[e(n,{icon:"ph:download",className:"mr-2"}),"Export Excel"]})})]}),h&&a("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-3 rounded-full bg-blue-100 dark:bg-blue-900/20",children:e(n,{icon:"ph:shopping-cart",className:"text-2xl text-blue-600 dark:text-blue-400"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Orders"}),e("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h.totalOrders||0})]})]})}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-3 rounded-full bg-green-100 dark:bg-green-900/20",children:e(n,{icon:"ph:currency-circle-dollar",className:"text-2xl text-green-600 dark:text-green-400"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Revenue"}),a("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["\u20B9",((C=h.totalAmount)==null?void 0:C.toLocaleString())||0]})]})]})}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-3 rounded-full bg-purple-100 dark:bg-purple-900/20",children:e(n,{icon:"ph:chart-line",className:"text-2xl text-purple-600 dark:text-purple-400"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Average Order Value"}),a("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["\u20B9",((D=h.averageOrderValue)==null?void 0:D.toLocaleString())||0]})]})]})})]}),a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[a("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e("div",{className:"lg:col-span-2",children:a("div",{className:"relative",children:[e(n,{icon:"ph:magnifying-glass",className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e("input",{type:"text",placeholder:"Search orders, customers...",value:p,onChange:t=>L(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})}),e("div",{children:a("select",{value:y,onChange:t=>B(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"All Statuses"}),e("option",{value:"pending",children:"Pending"}),e("option",{value:"processing",children:"Processing"}),e("option",{value:"completed",children:"Completed"}),e("option",{value:"failed",children:"Failed"}),e("option",{value:"cancelled",children:"Cancelled"}),e("option",{value:"refunded",children:"Refunded"})]})}),e("div",{children:a("select",{value:b,onChange:t=>F(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"All Types"}),e("option",{value:"deposit",children:"Deposit"}),e("option",{value:"withdrawal",children:"Withdrawal"}),e("option",{value:"gold_purchase",children:"Gold Purchase"}),e("option",{value:"silver_purchase",children:"Silver Purchase"}),e("option",{value:"gold_sale",children:"Gold Sale"}),e("option",{value:"silver_sale",children:"Silver Sale"})]})}),e("div",{children:e("input",{type:"date",value:x,onChange:t=>v(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",placeholder:"Start Date"})})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date"}),e("input",{type:"date",value:x,onChange:t=>v(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Date"}),e("input",{type:"date",value:N,onChange:t=>G(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]})]}),a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-hidden",children:[e("div",{className:"overflow-x-auto",children:a("table",{className:"w-full",children:[e("thead",{className:"bg-gray-50 dark:bg-slate-700",children:a("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Order ID"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Customer"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Type"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Asset"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Payment Method"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"})]})}),e("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-gray-700",children:o.length===0?e("tr",{children:e("td",{colSpan:"8",className:"px-6 py-12 text-center",children:a("div",{className:"flex flex-col items-center",children:[e(n,{icon:"ph:shopping-cart",className:"text-6xl text-gray-400 mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Investment Orders Found"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"No orders match your current filters."})]})})}):o.map(t=>{var i,l,u;return a("tr",{onClick:()=>Q(t._id),className:"hover:bg-gray-50 dark:hover:bg-slate-700",children:[a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.orderId||"N/A"}),e("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.currency||"INR"})]}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((i=t.userId)==null?void 0:i.name)||"N/A"}),e("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:((l=t.userId)==null?void 0:l.email)||"N/A"})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:w(t.orderType)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:w(t.transactionType)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:W(t.status)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["\u20B9 ",((u=t.inramount)==null?void 0:u.toLocaleString())||0]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"text-sm text-gray-900 dark:text-white",children:t.Payment_method||"N/A"})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]},t._id)})})]})}),r.totalPages>1&&a("div",{className:"bg-white dark:bg-slate-800 px-4 py-3 flex items-center justify-between border-t border-gray-200 dark:border-gray-700 sm:px-6",children:[a("div",{className:"flex-1 flex justify-between sm:hidden",children:[e(c,{onClick:()=>m(t=>Math.max(t-1,1)),disabled:!r.hasPrevPage,className:"btn btn-outline",children:"Previous"}),e(c,{onClick:()=>m(t=>Math.min(t+1,r.totalPages)),disabled:!r.hasNextPage,className:"btn btn-outline",children:"Next"})]}),a("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e("div",{children:a("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing"," ",e("span",{className:"font-medium",children:(r.currentPage-1)*r.limit+1})," ","to"," ",e("span",{className:"font-medium",children:Math.min(r.currentPage*r.limit,r.totalOrders)})," ","of"," ",e("span",{className:"font-medium",children:r.totalOrders})," ","results"]})}),e("div",{children:a("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e(c,{onClick:()=>m(t=>Math.max(t-1,1)),disabled:!r.hasPrevPage,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600",children:e(n,{icon:"ph:caret-left"})}),Array.from({length:Math.min(5,r.totalPages)},(t,i)=>{const l=Math.max(1,Math.min(r.totalPages-4,r.currentPage-2))+i;return l>r.totalPages?null:e(c,{onClick:()=>m(l),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${l===r.currentPage?"z-10 bg-blue-50 dark:bg-blue-900/20 border-blue-500 text-blue-600 dark:text-blue-400":"bg-white dark:bg-slate-700 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600"}`,children:l},l)}),e(c,{onClick:()=>m(t=>Math.min(t+1,r.totalPages)),disabled:!r.hasNextPage,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600",children:e(n,{icon:"ph:caret-right"})})]})})]})]})]})]})};export{ae as default};
