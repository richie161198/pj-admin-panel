import{r as l,ab as P,ac as A,j as e,c as t,Q as E}from"./index.67c6c4a2.js";const F=()=>{const[d,h]=l.exports.useState(!1),[b,x]=l.exports.useState(""),[y,N]=l.exports.useState(""),[o,v]=l.exports.useState(""),[w,M]=l.exports.useState("emergency"),[i,m]=l.exports.useState(["all"]),[u,S]=l.exports.useState(""),[g,k]=l.exports.useState(""),{data:s,isLoading:T,refetch:I}=P(),[U,{isLoading:p}]=A();l.exports.useEffect(()=>{if(s!=null&&s.data){const a=s.data;h(a.isMaintenanceMode||!1),x(a.maintenanceMessage||""),N(a.maintenanceTitle||""),v(a.estimatedEndTime?new Date(a.estimatedEndTime).toISOString().slice(0,16):""),M(a.maintenanceType||"emergency"),m(a.affectedServices||["all"]),S(a.allowedIPs?a.allowedIPs.join(", "):""),k(a.allowedUserIds?a.allowedUserIds.join(", "):"")}},[s]);const C=a=>{i.includes(a)?m(i.filter(c=>c!==a)):m([...i,a])},j=async a=>{var c;a.preventDefault();try{const n={isMaintenanceMode:d,maintenanceMessage:b,maintenanceTitle:y,estimatedEndTime:o?new Date(o).toISOString():null,maintenanceType:w,affectedServices:i,allowedIPs:u?u.split(",").map(r=>r.trim()).filter(r=>r):[],allowedUserIds:g?g.split(",").map(r=>r.trim()).filter(r=>r):[]};console.log("Updating maintenance with data:",n);const f=await U(n).unwrap();console.log("Maintenance update response:",f),f.status&&(E.success(f.message),I())}catch(n){console.error("Error updating maintenance:",n),console.error("Error details:",{status:n==null?void 0:n.status,data:n==null?void 0:n.data,message:n==null?void 0:n.message}),E.error(((c=n==null?void 0:n.data)==null?void 0:c.message)||(n==null?void 0:n.message)||"Failed to update maintenance status")}};return T?e("div",{className:"flex items-center justify-center h-64",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e("div",{className:"p-6",children:e("div",{className:"max-w-4xl mx-auto",children:t("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[t("div",{className:"flex items-center justify-between mb-6",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"System Maintenance"}),e("p",{className:"text-gray-600 mt-1",children:"Control system maintenance mode and settings"})]}),e("div",{className:`px-4 py-2 rounded-full text-sm font-medium ${d?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:d?"Maintenance ON":"Maintenance OFF"})]}),t("form",{onSubmit:j,className:"space-y-6",children:[e("div",{className:"bg-gray-50 p-4 rounded-lg",children:t("div",{className:"flex items-center justify-between",children:[t("div",{children:[e("h3",{className:"text-lg font-semibold text-gray-900",children:"Maintenance Mode"}),e("p",{className:"text-sm text-gray-600",children:"Enable or disable system maintenance mode"})]}),t("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",className:"sr-only peer",checked:d,onChange:a=>h(a.target.checked)}),e("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),d&&t("div",{className:"space-y-4",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maintenance Title"}),e("input",{type:"text",value:y,onChange:a=>N(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"System Maintenance"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maintenance Type"}),t("select",{value:w,onChange:a=>M(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e("option",{value:"emergency",children:"Emergency"}),e("option",{value:"scheduled",children:"Scheduled"}),e("option",{value:"update",children:"Update"})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maintenance Message"}),e("textarea",{value:b,onChange:a=>x(a.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"We are currently performing maintenance. Please try again later."})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estimated End Time"}),e("input",{type:"datetime-local",value:o,onChange:a=>v(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Affected Services"}),e("div",{className:"flex flex-wrap gap-2",children:["all","api","mobile","web"].map(a=>t("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:i.includes(a),onChange:()=>C(a),className:"mr-2"}),e("span",{className:"text-sm capitalize",children:a})]},a))})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allowed IPs (comma-separated)"}),e("input",{type:"text",value:u,onChange:a=>S(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"192.168.1.1, 10.0.0.1"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allowed User IDs (comma-separated)"}),e("input",{type:"text",value:g,onChange:a=>k(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"user1, user2, user3"})]})]})]}),t("div",{className:"flex justify-end space-x-4",children:[e("button",{type:"button",onClick:()=>I(),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),e("button",{type:"submit",disabled:p,className:`px-6 py-2 rounded-md font-medium transition-colors ${d?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"} ${p?"opacity-50 cursor-not-allowed":""}`,children:p?"Updating...":d?"Enable Maintenance":"Disable Maintenance"})]})]}),(s==null?void 0:s.data)&&t("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Status"}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[t("div",{children:[e("span",{className:"font-medium text-gray-700",children:"Status:"}),e("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${s.data.isMaintenanceMode?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.data.isMaintenanceMode?"Maintenance ON":"Maintenance OFF"})]}),s.data.lastUpdated&&t("div",{children:[e("span",{className:"font-medium text-gray-700",children:"Last Updated:"}),e("span",{className:"ml-2 text-gray-600",children:new Date(s.data.lastUpdated).toLocaleString()})]})]})]})]})})})};export{F as default};
