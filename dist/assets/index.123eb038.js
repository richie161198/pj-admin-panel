import{u as W,a as Z,r as L,j as e,L as Y,t as D,R as I,F as V,b as q,c as r,I as c,C}from"./index.a3fd4963.js";import{_ as J}from"./react-apexcharts.min.ffe8f082.js";import{u as ee,a as te,b as ae,c as re}from"./orderApi.f4e71a4b.js";import{u as se}from"./userApi.c86c194a.js";import{u as le,a as ie}from"./productApi.0747bb22.js";import{r as R}from"./index.dd141d8d.js";import{u as ce}from"./ticketApi.d79564bb.js";const ne=({height:g=400})=>{W();const[l]=Z(),{data:p,isLoading:i}=ee({months:12}),n=(p==null?void 0:p.data)||{categories:[],series:[{name:"Gold",data:[],orderCounts:[]},{name:"Silver",data:[],orderCounts:[]}]},S=L.exports.useMemo(()=>{const d={};return n.series.forEach((u,o)=>{u.orderCounts.forEach((x,T)=>{const y=`${o}_${T}`;d[y]=x})}),d},[n.series]),w=n.series.map(d=>({name:d.name,data:d.data})),j=L.exports.useRef(n),$=L.exports.useRef(S);L.exports.useEffect(()=>{j.current=n,$.current=S},[n,S]);const F={chart:{toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,endingShape:"rounded",columnWidth:"55%",borderRadius:4}},legend:{show:!0,markers:{width:10,height:10,radius:12},labels:{colors:"#f9fafb"},itemMargin:{horizontal:10,vertical:5}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},yaxis:{opposite:!!l,labels:{style:{colors:"#f9fafb",fontFamily:"Inter"},formatter:function(d){return"\u20B9"+(d/1e3).toFixed(1)+"k"}},title:{text:"Value (\u20B9)",style:{color:"#f9fafb"}}},xaxis:{categories:n.categories,labels:{style:{colors:"#f9fafb",fontFamily:"Inter"}},axisBorder:{show:!1},axisTicks:{show:!1}},fill:{opacity:1},tooltip:{custom:function({seriesIndex:d,dataPointIndex:u,w:o}){var f;const x=j.current,T=$.current,y=o.globals.seriesNames[d]||((f=x==null?void 0:x.series[d])==null?void 0:f.name)||"Unknown",P=o.globals.series[d][u]||0;let k="Unknown Month";o.globals.categoryLabels&&o.globals.categoryLabels[u]?k=o.globals.categoryLabels[u]:(x==null?void 0:x.categories)&&x.categories[u]?k=x.categories[u]:o.config.xaxis&&o.config.xaxis.categories&&o.config.xaxis.categories[u]&&(k=o.config.xaxis.categories[u]);const A=T[`${d}_${u}`]||0;return`
          <div style="padding: 10px; background: rgba(0, 0, 0, 0.9); border-radius: 5px; border: 1px solid rgba(255, 255, 255, 0.1);">
            <div style="font-weight: bold; margin-bottom: 8px; color: #fff; font-size: 14px;">
              ${y} - ${k}
            </div>
            <div style="color: #f9fafb; margin-bottom: 5px; font-size: 13px;">
              <span style="opacity: 0.8;">Orders:</span> <strong style="color: #60a5fa;">${A}</strong>
            </div>
            <div style="color: #f9fafb; font-size: 13px;">
              <span style="opacity: 0.8;">Value:</span> <strong style="color: #60a5fa;">\u20B9${P.toLocaleString("en-IN")}</strong>
            </div>
          </div>
        `}},colors:["#FFD700","#C0C0C0"],grid:{show:!0,borderColor:"#60a5fa",strokeDashArray:10,position:"back"},responsive:[{breakpoint:600,options:{legend:{position:"bottom",offsetY:8,horizontalAlign:"center"},plotOptions:{bar:{columnWidth:"80%"}}}}]};return i?e("div",{className:"flex justify-center items-center",style:{height:g},children:e(Y,{})}):e("div",{children:e(J,{options:F,series:w,type:"bar",height:g})})},de=({height:g=340})=>{const[l]=W(),p=[50],i={chart:{toolbar:{show:!1}},plotOptions:{radialBar:{size:200,offsetY:-20,startAngle:-180,endAngle:150,hollow:{size:"60%"},track:{background:"#fff",strokeWidth:"100%"},dataLabels:{name:{fontSize:"22px",color:l?"#E2E8F0":"#475569"},value:{fontSize:"32px",offsetY:30,fontWeight:700,color:l?"#E2E8F0":"#475569"},total:{show:!0,label:"Completed Task",color:l?"#E2E8F0":"#475569",fontWeight:400,formatter:function(){return 8}}}}},fill:{type:"gradient",gradient:{shade:"light",shadeIntensity:.35,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,65,91]}},stroke:{dashArray:8},colors:[D.colors.primary]};return e("div",{children:e(J,{series:p,options:i,type:"radialBar",height:g})})};I.forwardRef(({indeterminate:g,...l},p)=>{const i=I.useRef(),n=p||i;return I.useEffect(()=>{n.current.indeterminate=g},[n,g]),e(V,{children:e("input",{type:"checkbox",ref:n,...l,className:"table-checkbox"})})});const oe=()=>{const g=q(),{data:l,isLoading:p,error:i}=te();console.log("Orders response:",l,"Loading:",p,"Error:",i);const n=L.exports.useMemo(()=>{var s,m;if(!l)return[];const t=(l==null?void 0:l.orders)||(l==null?void 0:l.details)||((s=l==null?void 0:l.data)==null?void 0:s.orders)||((m=l==null?void 0:l.data)==null?void 0:m.details)||(Array.isArray(l==null?void 0:l.data)?l.data:null)||(Array.isArray(l)?l:[]);return Array.isArray(t)?t.slice(0,10):[]},[l]),S=t=>t?new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}):"N/A",w=t=>!t&&t!==0?"\u20B90.00":`\u20B9${parseFloat(t).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,j=t=>{switch((t==null?void 0:t.toLowerCase())||""){case"delivered":return"bg-green-500 text-green-500";case"shipped":return"bg-blue-500 text-blue-500";case"placed":return"bg-yellow-500 text-yellow-500";case"cancelled":return"bg-red-500 text-red-500";default:return"bg-gray-500 text-gray-500"}},$=[{Header:"Order ID",accessor:"_id",Cell:({row:t})=>{var a;const s=((a=t==null?void 0:t.original)==null?void 0:a._id)||"",m=s.slice(-8).toUpperCase();return r("span",{className:"text-sm text-indigo-500 font-medium cursor-pointer hover:underline",onClick:()=>g(`/orders/${s}`),children:["#",m]})}},{Header:"Customer",accessor:"userId",Cell:({row:t})=>{var a,v,N;(a=t==null?void 0:t.original)==null||a.userId;const s=((v=t==null?void 0:t.original.user)==null?void 0:v.name)||"Guest User",m=((N=t==null?void 0:t.original.user)==null?void 0:N.email)||"N/A";return r("div",{children:[e("span",{className:"text-sm text-gray-600 dark:text-gray-300 capitalize block",children:s}),e("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-light mt-[1px] block lowercase",children:m})]})}},{Header:"Date",accessor:"createdAt",Cell:({row:t})=>{var s;return e("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:S((s=t==null?void 0:t.original)==null?void 0:s.createdAt)})}},{Header:"Items",accessor:"products",Cell:({row:t})=>{var m,a,v,N,_;return(((m=t==null?void 0:t.original)==null?void 0:m.products)||[]).reduce((K,X)=>K+(X.quantity||0),0),r("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[((v=(a=t==null?void 0:t.original)==null?void 0:a.items)==null?void 0:v.length)||0," ",((_=(N=t==null?void 0:t.original)==null?void 0:N.items)==null?void 0:_.length)===1?"item":"items"]})}},{Header:"Amount",accessor:"totalAmount",Cell:({row:t})=>{var s;return e("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:w((s=t==null?void 0:t.original)==null?void 0:s.totalAmount)})}},{Header:"Status",accessor:"status",Cell:({row:t})=>{var a;const s=((a=t==null?void 0:t.original)==null?void 0:a.status)||"pending",m=j(s);return r("span",{className:"flex items-center space-x-2",children:[e("span",{className:`h-2 w-2 rounded-full inline-block ${m.split(" ")[0]}`}),e("span",{className:`text-sm capitalize ${m.split(" ")[1]}`,children:s})]})}}],F=L.exports.useMemo(()=>$,[g]),d=L.exports.useMemo(()=>n,[n]),u=R.exports.useTable({columns:F,data:d},R.exports.useGlobalFilter,R.exports.useSortBy,R.exports.usePagination,R.exports.useRowSelect),{getTableProps:o,getTableBodyProps:x,headerGroups:T,footerGroups:y,page:P,nextPage:k,previousPage:A,canNextPage:f,canPreviousPage:h,pageOptions:b,state:O,gotoPage:G,pageCount:Q,setPageSize:z,setGlobalFilter:U,prepareRow:E}=u,{globalFilter:M,pageIndex:B,pageSize:H}=O;return p?e("div",{className:"card",children:e("div",{className:"flex items-center justify-center py-20",children:r("div",{className:"flex flex-col items-center space-y-4",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"}),e("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading recent orders..."})]})})}):i?e("div",{className:"card",children:e("div",{className:"flex items-center justify-center py-20",children:r("div",{className:"text-center",children:[e(c,{icon:"heroicons-outline:exclamation-circle",className:"text-red-500 text-5xl mb-4 mx-auto"}),e("p",{className:"text-red-500 font-semibold mb-2",children:"Failed to load orders"}),e("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:(i==null?void 0:i.message)||"Something went wrong"})]})})}):n.length===0?e("div",{className:"card",children:e("div",{className:"flex items-center justify-center py-20",children:r("div",{className:"text-center",children:[e(c,{icon:"heroicons-outline:shopping-bag",className:"text-gray-400 text-5xl mb-4 mx-auto"}),e("p",{className:"text-gray-500 dark:text-gray-400 font-semibold mb-2",children:"No orders yet"}),e("p",{className:"text-gray-400 dark:text-gray-500 text-sm",children:"Recent product orders will appear here"})]})})}):e(V,{children:r("div",{className:"card",children:[e("div",{className:"overflow-x-auto",children:e("div",{className:"inline-block min-w-full align-middle",children:e("div",{className:"overflow-hidden",children:r("table",{className:"min-w-full divide-y divide-gray-100 table-fixed dark:divide-gray-700",...o,children:[e("thead",{className:"bg-gray-100 dark:bg-gray-700",children:T.map(t=>e("tr",{...t.getHeaderGroupProps(),children:t.headers.map(s=>e("th",{...s.getHeaderProps(s.getSortByToggleProps()),scope:"col",className:"table-th",children:r("div",{className:"flex items-center justify-between",children:[s.render("Header"),e("span",{children:s.isSorted?s.isSortedDesc?e(c,{icon:"ph:caret-up-fill"}):e(c,{icon:"ph:caret-down-fill"}):e(c,{icon:"ri:expand-up-down-fill",className:"text-[15px] text-gray-400"})})]})}))}))}),e("tbody",{className:"bg-white divide-y divide-gray-100 dark:bg-gray-800 dark:divide-gray-700",...x,children:P.map(t=>(E(t),e("tr",{...t.getRowProps(),className:"hover:bg-gray-100 dark:hover:bg-gray-700 hover:bg-opacity-30 transition-all duration-200 cursor-pointer",onClick:()=>g(`/orders/${t.original._id}`),children:t.cells.map(s=>e("td",{...s.getCellProps(),className:"table-td",children:s.render("Cell")}))})))})]})})})}),b.length>1&&e("div",{className:"p-6",children:r("ul",{className:"flex items-center justify-center space-x-3 rtl:space-x-reverse",children:[e("li",{className:"text-xl leading-4 text-gray-900 dark:text-white rtl:rotate-180",children:e("button",{className:`${h?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>A(),disabled:!h,children:e(c,{icon:"heroicons-outline:chevron-left"})})}),b.map((t,s)=>e("li",{children:e("button",{"aria-current":"page",className:`${s===B?"bg-indigo-500 text-white font-medium":"bg-gray-100 dark:bg-gray-700 dark:text-gray-400 text-gray-900 font-normal"} text-sm rounded leading-[16px] flex h-6 w-6 items-center justify-center transition-all duration-150`,onClick:()=>G(s),children:t+1})},s)),e("li",{className:"text-xl leading-4 text-gray-900 dark:text-white rtl:rotate-180",children:e("button",{className:`${f?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>k(),disabled:!f,children:e(c,{icon:"heroicons-outline:chevron-right"})})})]})})]})})},ye=()=>{var M,B,H,t,s,m;const g=q(),[l,p]=L.exports.useState({status:"",category:"",page:1,limit:10}),{data:i,isLoading:n,refetch:S}=ce(l),{data:w,isLoading:j,error:$}=se(),{data:F,isLoading:d}=le(),{data:u,isLoading:o}=ae(),{data:x,isLoading:T}=ie(),{data:y,isLoading:P}=re();console.log("Users Query State:",{users:w,usersLoading:j,usersError:$});const k=j||d||o||T,A=(a,v=["details","data","users","products","orders","categories"])=>{if(!a)return console.log("extractArrayData: response is null/undefined"),[];if(Array.isArray(a))return console.log("extractArrayData: response is already an array",a.length),a;console.log("extractArrayData: response structure",{response:a,type:typeof a,keys:Object.keys(a||{}),hasDetails:a==null?void 0:a.details,detailsIsArray:Array.isArray(a==null?void 0:a.details)});for(const N of v)if(a[N]&&Array.isArray(a[N]))return console.log(`extractArrayData: Found array in key "${N}"`,a[N].length),a[N];return console.log("extractArrayData: No array found, returning empty array"),[]},f=A(w,["details","data","users"]),h=A(F,["details","data","products"]),b=A(u,["details","data","orders"]),O=A(x,["details","data","categories"]);console.log("usersData?.length",f==null?void 0:f.length,w);const G=(f==null?void 0:f.length)||0,Q=(h==null?void 0:h.length)||0,z=(b==null?void 0:b.length)||0,U=(O==null?void 0:O.length)||0;console.log("Ticket:",i==null?void 0:i.data.tickets);const E=((M=y==null?void 0:y.data)==null?void 0:M.netRevenue)||((B=y==null?void 0:y.data)==null?void 0:B.totalRevenue)||0;return b!=null&&b.slice(0,5),k?e("div",{className:"flex justify-center items-center h-64",children:e(Y,{})}):r("div",{className:" space-y-5",children:[r("div",{className:"grid xl:grid-cols-4 sm:grid-cols-2 grid-cols-1 gap-5",children:[e(C,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Total Orders"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-indigo-500 text-white text-2xl flex items-center justify-center",children:e(c,{icon:"ph:shopping-cart"})})})]}),r("div",{children:[e("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:z}),r("span",{className:"  space-x-2 block mt-4 ",children:[e("span",{className:"badge bg-indigo-500/10 text-indigo-500 ",children:z>0?"Active":"No Orders"}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Total orders"})]})]})]})}),e(C,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Total Revenue"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-yellow-500 text-white text-2xl flex items-center justify-center",children:e(c,{icon:"ph:currency-inr"})})})]}),r("div",{children:[r("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:["\u20B9 ",E.toLocaleString("en-IN").trim()]}),r("span",{className:"  space-x-2 block mt-4 ",children:[r("span",{className:"badge bg-yellow-500/10 text-yellow-500 ",children:[z," orders"]}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Total revenue"})]})]})]})}),e(C,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Total Users"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-red-500 text-white text-2xl flex items-center justify-center",children:e(c,{icon:"ph:users"})})})]}),r("div",{children:[e("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:G}),r("span",{className:"  space-x-2 block mt-4 ",children:[e("span",{className:"badge bg-red-500/10 text-red-500 ",children:"Active"}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Registered users"})]})]})]})}),e(C,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Products"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-green-500 text-white text-2xl flex items-center justify-center",children:e(c,{icon:"ph:package"})})})]}),r("div",{children:[e("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:Q}),r("span",{className:"  space-x-2 block mt-4 ",children:[r("span",{className:"badge bg-green-500/10 text-green-500 ",children:[U," categories"]}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Total products"})]})]})]})})]}),r("div",{className:"grid   grid-cols-12 gap-5",children:[e("div",{className:"xl:col-span-7 col-span-12",children:e(C,{className:"!bg-indigo-500 ",title:"Investment History",titleClass:"!text-white",noborder:!0,children:e(ne,{})})}),e("div",{className:"xl:col-span-5 col-span-12",children:r(C,{title:"Support Tracker",subscribe:!0,children:[e(de,{}),r("div",{className:"grid  grid-cols-3 gap-2 py-4",children:[r("div",{className:" text-center",children:[e("div",{children:e("div",{className:"h-10 w-10 mb-2 mx-auto rounded-md bg-indigo-500/10 text-indigo-500 text-xl flex items-center justify-center",children:e(c,{icon:"ph:ticket"})})}),r("div",{children:[e("div",{className:" font-medium text-gray-800 dark:text-white text-sm truncate mb-[2px]",children:"All Tickets"}),e("div",{className:" text-xs text-gray-400",children:i==null?void 0:i.data.tickets.length})]})]}),r("div",{className:" text-center",children:[e("div",{children:e("div",{className:"h-10 w-10 mb-2 mx-auto rounded-md bg-green-500/10 text-green-500 text-xl flex items-center justify-center",children:e(c,{icon:"ph:clock-countdown"})})}),r("div",{children:[e("div",{className:" font-medium text-gray-800 dark:text-white text-sm truncate mb-[2px]",children:"Open Tickets"}),e("div",{className:" text-xs text-gray-400",children:i==null?void 0:i.data.tickets.filter(a=>a.status==="open").length})]})]}),r("div",{className:" text-center",children:[e("div",{children:e("div",{className:"h-10 w-10 mb-2 mx-auto rounded-md bg-yellow-500/10 text-yellow-500 text-xl flex items-center justify-center",children:e(c,{icon:"ph:check"})})}),r("div",{children:[e("div",{className:" font-medium text-gray-800 dark:text-white text-sm truncate mb-[2px]",children:"Resolved Tickets"}),e("div",{className:" text-xs text-gray-400",children:i==null?void 0:i.data.tickets.filter(a=>a.status==="resolved").length})]})]})]})]})})]}),r("div",{className:"grid xl:grid-cols-3 gap-5 ",children:[e(C,{title:"Trending Products",subtitle:"Trending products Overview",children:e("ul",{className:" space-y-4",children:(t=(H=h==null?void 0:h.filter(a=>a.trending===!0))==null?void 0:H.slice(0,h.filter(a=>a.popular===!0).length<=5?void 0:5))==null?void 0:t.map((a,v)=>r("li",{className:"flex justify-between items-center",children:[r("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",onClick:()=>g(`/products/${a._id}`),children:[e("div",{className:"flex-none",children:e("div",{className:"h-[34px] w-[34px] rounded-full",children:a.images&&a.images.length>0?e("img",{src:a.images[0],alt:a.name,className:"w-full h-full object-cover"}):e("div",{className:"w-full h-full flex items-center justify-center",children:e(c,{icon:"ph:image",className:"text-4xl text-gray-400"})})})}),e("div",{className:"flex-1",children:e("div",{className:" text-sm ",children:a.name})})]}),r("div",{className:"text-gray-800 dark:text-white   flex items-center space-x-[2px] rtl:space-x-reverse",children:[e("span",{className:" text-sm  ",children:a.rating.value}),e(c,{icon:a.icon,className:`${a.icon==="heroicons:arrow-small-up"?" text-green-500 ":" text-red-500"}  text-lg`})]})]},v))})}),e(C,{title:"Popular Products",subtitle:"Most popular products",children:e("ul",{className:" space-y-4",children:(m=(s=h==null?void 0:h.filter(a=>a.popular===!0))==null?void 0:s.slice(0,h.filter(a=>a.popular===!0).length<=5?void 0:5))==null?void 0:m.map((a,v)=>r("li",{className:"flex justify-between items-center",children:[r("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",onClick:()=>g(`/products/${a._id}`),children:[e("div",{className:"flex-none",children:e("div",{className:"h-[34px] w-[34px] bg-gray-200 text-gray-500 dark:bg-gray-700 dark:text-gray-300 flex  items-center justify-center rounded-full",children:a.images&&a.images.length>0?e("img",{src:a.images[0],alt:a.name,className:"w-full h-full object-cover"}):e("div",{className:"w-full h-full flex items-center justify-center",children:e(c,{icon:"ph:image",className:"text-4xl text-gray-400"})})})}),e("div",{className:"flex-1",children:e("div",{className:" text-sm ",children:a.name})})]}),r("div",{className:"text-gray-800 dark:text-white   flex items-center space-x-[2px] rtl:space-x-reverse",children:[e("span",{className:" text-sm  ",children:a.rating.value}),e(c,{icon:a.icon,className:`${a.icon==="heroicons:arrow-small-up"?" text-green-500 ":" text-red-500"}  text-lg`})]})]},v))})})]}),r("div",{children:[e("div",{className:"card-title mb-5",children:"Latest Order"}),e(oe,{})]})]})};export{ye as default};
