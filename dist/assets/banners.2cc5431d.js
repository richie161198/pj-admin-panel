import{r as c,j as e,c as a}from"./index.51fda1b3.js";import{a as x}from"./axios.49395b7f.js";import"./productApi.a85569aa.js";const k=({children:r,className:d=""})=>e("div",{className:`border rounded bg-white ${d}`,children:r}),h=({children:r,className:d="",onClick:f,type:y="button",disabled:b})=>e("button",{type:y,disabled:b,onClick:f,className:`px-4 py-2 border rounded ${b?"opacity-60 cursor-not-allowed":""} ${d}`,children:r}),j=({className:r=""})=>e("span",{className:r,"aria-hidden":!0}),F=r=>e("input",{...r,className:`w-full border rounded px-3 py-2 ${r.className||""}`}),L=({children:r,...d})=>e("select",{...d,className:`w-full border rounded px-3 py-2 ${d.className||""}`,children:r}),Z=({checked:r,onChange:d,name:f})=>e("input",{type:"checkbox",name:f,checked:r,onChange:d}),re=()=>{const[r,d]=c.exports.useState([]),[f,y]=c.exports.useState(!0);c.exports.useState(!1);const[b,N]=c.exports.useState(!1),[ee,_]=c.exports.useState(null),[A,P]=c.exports.useState(null),[E,I]=c.exports.useState(null),[U,T]=c.exports.useState(!1),[$,te]=c.exports.useState(""),[m,G]=c.exports.useState("all"),[v,O]=c.exports.useState(1),[w,W]=c.exports.useState(1),[p,H]=c.exports.useState("all"),D=(()=>{const t=new Set;return r.forEach(s=>{s.category&&s.category.trim()&&t.add(s.category.trim())}),Array.from(t).sort()})(),[u,M]=c.exports.useState({title:"",position:0,isActive:!0,category:""}),C=async()=>{var t;try{y(!0);const s=await x.get("/banners",{params:{page:v,limit:10,search:$,isActive:m==="all"?void 0:m==="active"}});s.data.success&&(d(s.data.data.banners||[]),W(((t=s.data.data.pagination)==null?void 0:t.totalPages)||1))}catch(s){console.error("Error fetching banners:",s)}finally{y(!1)}};c.exports.useEffect(()=>{C()},[v,$,m]);const S=t=>{const{name:s,value:i,type:n,checked:o}=t.target;M(l=>({...l,[s]:n==="checkbox"?o:i}))},V=t=>{var n;const s=(n=t.target.files)==null?void 0:n[0];if(!s)return;if(!s.type.startsWith("image/")){alert("Please select a valid image file");return}if(s.size>8*1024*1024){alert("Image size should be less than 8MB");return}P(s);const i=URL.createObjectURL(s);I(i)},Y=async t=>{var s,i,n,o;if(t.preventDefault(),!A){alert("Please choose an image");return}T(!0);try{const l=new FormData;l.append("image",A);const R=await x.post("/images/upload",l,{headers:{"Content-Type":"multipart/form-data"}});if(!((s=R.data)!=null&&s.success))throw new Error("Image upload failed");const g=R.data.data,X={title:u.title,position:Number(u.position)||0,isActive:!!u.isActive,category:u.category||void 0,imageUrl:g.url,publicId:g.public_id,imageWidth:g.width,imageHeight:g.height,imageFormat:g.format,imageBytes:g.bytes};if(!((i=(await x.post("/banners",X)).data)!=null&&i.success))throw new Error("Banner save failed");B(),N(!1),await C()}catch(l){console.error("Error saving banner:",l),alert(((o=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:o.message)||l.message||"Failed to save")}finally{T(!1)}},B=()=>{M({title:"",position:0,isActive:!0,category:""}),I(null),P(null),_(null)},q=()=>{const t={};return r.forEach(s=>{const i=s.category||"Uncategorized";t[i]||(t[i]=[]),t[i].push(s)}),t},J=()=>{let t=r;return m!=="all"&&(t=t.filter(s=>m==="active"?s.isActive:!s.isActive)),p!=="all"&&(t=t.filter(s=>(s.category||"Uncategorized")===p)),t},z=()=>{B(),N(!0)},K=async t=>{if(!!window.confirm("Are you sure you want to delete this banner?"))try{(await x.delete(`/banners/${t}`)).data.success&&C()}catch(s){console.error("Error deleting banner:",s),alert("Failed to delete banner")}},Q=async(t,s)=>{try{(await x.patch(`/banners/${t}/toggle`)).data.success&&C()}catch(i){console.error("Error toggling banner status:",i),alert("Failed to update banner status")}};return f?e("div",{className:"flex items-center justify-center h-64",children:"Loading..."}):a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Banner Management"}),e("p",{className:"text-gray-600",children:"Manage your website banners and promotional content"})]}),a(h,{onClick:z,className:"bg-blue-600 text-white hover:bg-blue-700",children:[e(j,{icon:"heroicons:plus",className:"w-5 h-5 mr-2"}),"Add New Banner"]})]}),e(k,{className:"p-6",children:a("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),a(L,{value:p,onChange:t=>H(t.target.value),children:[e("option",{value:"all",children:"All Categories"}),D.map(t=>e("option",{value:t,children:t},t))]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a(L,{value:m,onChange:t=>G(t.target.value),children:[e("option",{value:"all",children:"All Banners"}),e("option",{value:"active",children:"Active Only"}),e("option",{value:"inactive",children:"Inactive Only"})]})]})]})}),b&&a("div",{className:"p-4 border rounded space-y-3",children:[a("div",{className:"flex items-center justify-between",children:[e("h2",{className:"font-medium",children:"Create New Banner"}),e("button",{className:"text-sm",onClick:()=>N(!1),children:"Close"})]}),a("form",{onSubmit:Y,className:"space-y-3",children:[a("div",{children:[e("label",{className:"block text-sm mb-1",children:"Title (optional)"}),e(F,{name:"title",value:u.title,onChange:S,placeholder:"Banner title"})]}),a("div",{children:[e("label",{className:"block text-sm mb-1",children:"Position"}),e(F,{type:"number",name:"position",value:u.position,onChange:S})]}),a("div",{children:[e("label",{className:"block text-sm mb-1",children:"Category"}),e(F,{name:"category",value:u.category,onChange:S,placeholder:"Enter category name (e.g., main, top-collections, ecommerce)",list:"category-suggestions"}),a("datalist",{id:"category-suggestions",children:[D.map(t=>e("option",{value:t},t)),e("option",{value:"main"}),e("option",{value:"top-collections"}),e("option",{value:"ecommerce"}),e("option",{value:"offer&deals"}),e("option",{value:"home"}),e("option",{value:"featured"})]})]}),a("div",{className:"flex items-center gap-2",children:[e(Z,{name:"isActive",checked:u.isActive,onChange:S}),e("span",{className:"text-sm",children:"Active"})]}),a("div",{children:[e("input",{type:"file",accept:"image/*",onChange:V}),E&&e("img",{src:E,alt:"preview",className:"mt-3 h-40 object-cover rounded"})]}),a("div",{className:"flex justify-end gap-2",children:[e(h,{type:"button",onClick:()=>{B(),N(!1)},children:"Cancel"}),e(h,{type:"submit",className:"bg-blue-600 text-white",disabled:U||!A,children:U?"Saving...":"Save Banner"})]})]})]}),(()=>{const t=J(),s=q(),i={};return Object.keys(s).forEach(n=>{(p==="all"||n===p)&&(i[n]=s[n].filter(o=>m==="all"?!0:m==="active"?o.isActive:!o.isActive),i[n].length===0&&delete i[n])}),t.length===0?a(k,{className:"p-8 text-center",children:[e(j,{icon:"heroicons:photo",className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Banners Found"}),e("p",{className:"text-gray-600 mb-4",children:p!=="all"||m!=="all"?"No banners match your current filters.":"Get started by creating your first banner."}),p==="all"&&m==="all"&&a(h,{onClick:z,className:"bg-blue-600 hover:bg-blue-700",children:[e(j,{icon:"heroicons:plus",className:"w-5 h-5 mr-2"}),"Create Your First Banner"]})]}):e("div",{className:"space-y-8",children:Object.keys(i).map(n=>{const o=i[n];return o.length===0?null:a("div",{className:"space-y-4",children:[e("div",{className:"flex items-center justify-between border-b pb-2",children:a("h2",{className:"text-xl font-bold text-gray-900",children:[n,a("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",o.length," ",o.length===1?"banner":"banners",")"]})]})}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(l=>a(k,{className:"overflow-hidden",children:[a("div",{className:"relative",children:[e("img",{src:l.imageUrl,alt:l.title,className:"w-full h-48 object-cover"}),e("div",{className:"absolute top-2 right-2",children:e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:l.isActive?"Active":"Inactive"})})]}),a("div",{className:"p-4",children:[e("h3",{className:"font-semibold text-lg text-gray-900 mb-2",children:l.title||"Untitled"}),l.description&&e("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:l.description}),a("div",{className:"space-y-2 text-sm text-gray-500",children:[a("div",{className:"flex justify-between",children:[e("span",{children:"Position:"}),e("span",{children:l.position})]}),l.targetAudience&&a("div",{className:"flex justify-between",children:[e("span",{children:"Target:"}),e("span",{className:"capitalize",children:l.targetAudience})]}),a("div",{className:"flex justify-between",children:[e("span",{children:"Category:"}),e("span",{className:"font-medium",children:n})]}),a("div",{className:"flex justify-between",children:[e("span",{children:"Views:"}),e("span",{children:l.views||0})]}),a("div",{className:"flex justify-between",children:[e("span",{children:"Clicks:"}),e("span",{children:l.clicks||0})]})]}),a("div",{className:"flex gap-2 mt-4",children:[e(h,{onClick:()=>Q(l._id,l.isActive),children:l.isActive?"Set Inactive":"Set Active"}),e(h,{onClick:()=>K(l._id),className:"text-red-600",children:"Delete"})]})]})]},l._id))})]},n)})})})(),w>1&&a("div",{className:"flex justify-center space-x-2",children:[e(h,{variant:"outline",onClick:()=>O(t=>Math.max(1,t-1)),disabled:v===1,children:"Previous"}),a("span",{className:"flex items-center px-4 py-2 text-sm text-gray-700",children:["Page ",v," of ",w]}),e(h,{variant:"outline",onClick:()=>O(t=>Math.min(w,t+1)),disabled:v===w,children:"Next"})]})]})};export{re as default};
