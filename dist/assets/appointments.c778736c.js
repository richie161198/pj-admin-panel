import{d as re,e as ie,r as B,c as o,j as r,I as A,B as F,C as se,L as ce,F as te,Q as R}from"./index.db93dc89.js";import{f as oe,g as le}from"./utilsApi.c92789ad.js";const de=re.injectEndpoints({endpoints:H=>({getAppointments:H.query({query:(y={})=>({url:"/appointments/admin",method:"GET",params:y}),providesTags:["Appointment"]}),markAppointmentContacted:H.mutation({query:y=>({url:`/appointments/admin/${y}/contacted`,method:"PATCH"}),invalidatesTags:["Appointment"]})})}),{useGetAppointmentsQuery:ue,useMarkAppointmentContactedMutation:he}=de;var ae={exports:{}};(function(H,y){(function(P,O){H.exports=O()})(ie,function(){var P=1e3,O=6e4,Y=36e5,I="millisecond",b="second",M="minute",_="hour",N="day",v="week",g="month",W="quarter",$="year",S="date",U="Invalid Date",E=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,K=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,X={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var n=["th","st","nd","rd"],e=t%100;return"["+t+(n[(e-20)%10]||n[e]||n[0])+"]"}},j=function(t,n,e){var i=String(t);return!i||i.length>=n?t:""+Array(n+1-i.length).join(e)+t},Q={s:j,z:function(t){var n=-t.utcOffset(),e=Math.abs(n),i=Math.floor(e/60),a=e%60;return(n<=0?"+":"-")+j(i,2,"0")+":"+j(a,2,"0")},m:function t(n,e){if(n.date()<e.date())return-t(e,n);var i=12*(e.year()-n.year())+(e.month()-n.month()),a=n.clone().add(i,g),c=e-a<0,s=n.clone().add(i+(c?-1:1),g);return+(-(i+(e-a)/(c?a-s:s-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:g,y:$,w:v,d:N,D:S,h:_,m:M,s:b,ms:I,Q:W}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return t===void 0}},u="en",w={};w[u]=X;var q=function(t){return t instanceof T},z=function t(n,e,i){var a;if(!n)return u;if(typeof n=="string"){var c=n.toLowerCase();w[c]&&(a=c),e&&(w[c]=e,a=c);var s=n.split("-");if(!a&&s.length>1)return t(s[0])}else{var d=n.name;w[d]=n,a=d}return!i&&a&&(u=a),a||!i&&u},m=function(t,n){if(q(t))return t.clone();var e=typeof n=="object"?n:{};return e.date=t,e.args=arguments,new T(e)},l=Q;l.l=z,l.i=q,l.w=function(t,n){return m(t,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var T=function(){function t(e){this.$L=z(e.locale,null,!0),this.parse(e)}var n=t.prototype;return n.parse=function(e){this.$d=function(i){var a=i.date,c=i.utc;if(a===null)return new Date(NaN);if(l.u(a))return new Date;if(a instanceof Date)return new Date(a);if(typeof a=="string"&&!/Z$/i.test(a)){var s=a.match(E);if(s){var d=s[2]-1||0,p=(s[7]||"0").substring(0,3);return c?new Date(Date.UTC(s[1],d,s[3]||1,s[4]||0,s[5]||0,s[6]||0,p)):new Date(s[1],d,s[3]||1,s[4]||0,s[5]||0,s[6]||0,p)}}return new Date(a)}(e),this.$x=e.x||{},this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return l},n.isValid=function(){return this.$d.toString()!==U},n.isSame=function(e,i){var a=m(e);return this.startOf(i)<=a&&a<=this.endOf(i)},n.isAfter=function(e,i){return m(e)<this.startOf(i)},n.isBefore=function(e,i){return this.endOf(i)<m(e)},n.$g=function(e,i,a){return l.u(e)?this[i]:this.set(a,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,i){var a=this,c=!!l.u(i)||i,s=l.p(e),d=function(L,x){var C=l.w(a.$u?Date.UTC(a.$y,x,L):new Date(a.$y,x,L),a);return c?C:C.endOf(N)},p=function(L,x){return l.w(a.toDate()[L].apply(a.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(x)),a)},h=this.$W,f=this.$M,D=this.$D,k="set"+(this.$u?"UTC":"");switch(s){case $:return c?d(1,0):d(31,11);case g:return c?d(1,f):d(0,f+1);case v:var G=this.$locale().weekStart||0,J=(h<G?h+7:h)-G;return d(c?D-J:D+(6-J),f);case N:case S:return p(k+"Hours",0);case _:return p(k+"Minutes",1);case M:return p(k+"Seconds",2);case b:return p(k+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,i){var a,c=l.p(e),s="set"+(this.$u?"UTC":""),d=(a={},a[N]=s+"Date",a[S]=s+"Date",a[g]=s+"Month",a[$]=s+"FullYear",a[_]=s+"Hours",a[M]=s+"Minutes",a[b]=s+"Seconds",a[I]=s+"Milliseconds",a)[c],p=c===N?this.$D+(i-this.$W):i;if(c===g||c===$){var h=this.clone().set(S,1);h.$d[d](p),h.init(),this.$d=h.set(S,Math.min(this.$D,h.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},n.set=function(e,i){return this.clone().$set(e,i)},n.get=function(e){return this[l.p(e)]()},n.add=function(e,i){var a,c=this;e=Number(e);var s=l.p(i),d=function(f){var D=m(c);return l.w(D.date(D.date()+Math.round(f*e)),c)};if(s===g)return this.set(g,this.$M+e);if(s===$)return this.set($,this.$y+e);if(s===N)return d(1);if(s===v)return d(7);var p=(a={},a[M]=O,a[_]=Y,a[b]=P,a)[s]||1,h=this.$d.getTime()+e*p;return l.w(h,this)},n.subtract=function(e,i){return this.add(-1*e,i)},n.format=function(e){var i=this,a=this.$locale();if(!this.isValid())return a.invalidDate||U;var c=e||"YYYY-MM-DDTHH:mm:ssZ",s=l.z(this),d=this.$H,p=this.$m,h=this.$M,f=a.weekdays,D=a.months,k=function(x,C,ee,Z){return x&&(x[C]||x(i,c))||ee[C].slice(0,Z)},G=function(x){return l.s(d%12||12,x,"0")},J=a.meridiem||function(x,C,ee){var Z=x<12?"AM":"PM";return ee?Z.toLowerCase():Z},L={YY:String(this.$y).slice(-2),YYYY:this.$y,M:h+1,MM:l.s(h+1,2,"0"),MMM:k(a.monthsShort,h,D,3),MMMM:k(D,h),D:this.$D,DD:l.s(this.$D,2,"0"),d:String(this.$W),dd:k(a.weekdaysMin,this.$W,f,2),ddd:k(a.weekdaysShort,this.$W,f,3),dddd:f[this.$W],H:String(d),HH:l.s(d,2,"0"),h:G(1),hh:G(2),a:J(d,p,!0),A:J(d,p,!1),m:String(p),mm:l.s(p,2,"0"),s:String(this.$s),ss:l.s(this.$s,2,"0"),SSS:l.s(this.$ms,3,"0"),Z:s};return c.replace(K,function(x,C){return C||L[x]||s.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,i,a){var c,s=l.p(i),d=m(e),p=(d.utcOffset()-this.utcOffset())*O,h=this-d,f=l.m(this,d);return f=(c={},c[$]=f/12,c[g]=f,c[W]=f/3,c[v]=(h-p)/6048e5,c[N]=(h-p)/864e5,c[_]=h/Y,c[M]=h/O,c[b]=h/P,c)[s]||h,a?f:l.a(f)},n.daysInMonth=function(){return this.endOf(g).$D},n.$locale=function(){return w[this.$L]},n.locale=function(e,i){if(!e)return this.$L;var a=this.clone(),c=z(e,i,!0);return c&&(a.$L=c),a},n.clone=function(){return l.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},t}(),V=T.prototype;return m.prototype=V,[["$ms",I],["$s",b],["$m",M],["$H",_],["$W",N],["$M",g],["$y",$],["$D",S]].forEach(function(t){V[t[1]]=function(n){return this.$g(n,t[0],t[1])}}),m.extend=function(t,n){return t.$i||(t(n,T,m),t.$i=!0),m},m.locale=z,m.isDayjs=q,m.unix=function(t){return m(1e3*t)},m.en=w[u],m.Ls=w,m.p={},m})})(ae);const ne=ae.exports,fe=()=>{var m,l,T,V;const[H,y]=B.exports.useState(1),[P,O]=B.exports.useState(""),[Y,I]=B.exports.useState(""),[b,M]=B.exports.useState(""),N={page:H,limit:10,...P&&{search:P},...Y&&{status:Y},...b&&{contacted:b}},{data:v,isLoading:g,error:W,refetch:$}=ue(N),[S,{isLoading:U}]=he(),{data:E,refetch:K}=oe(),[X,{isLoading:j}]=le(),Q=((m=v==null?void 0:v.data)==null?void 0:m.appointments)||[],u=((l=v==null?void 0:v.data)==null?void 0:l.pagination)||{},w=(V=(T=E==null?void 0:E.data)==null?void 0:T.appointmentEnabled)!=null?V:!0,q=async t=>{var n;try{await S(t).unwrap(),R.success("Appointment marked as contacted"),$()}catch(e){R.error(((n=e==null?void 0:e.data)==null?void 0:n.message)||"Failed to mark appointment as contacted")}};return o("div",{className:"space-y-6",children:[o("div",{className:"flex justify-between items-center",children:[o("div",{children:[r("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Appointments"}),r("p",{className:"text-gray-600 dark:text-gray-400",children:"View appointment requests from the app"})]}),o("div",{className:"flex items-center gap-3",children:[o("div",{className:"flex items-center gap-2",children:[r("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Show in App:"}),o("label",{className:"relative inline-flex items-center cursor-pointer",children:[r("input",{type:"checkbox",checked:w,onChange:async t=>{var e;const n=t.target.checked;try{await X({appointmentEnabled:n}).unwrap(),R.success(`Appointment booking ${n?"enabled":"disabled"} successfully`),K()}catch(i){console.error("Failed to update appointment option:",i),R.error(((e=i==null?void 0:i.data)==null?void 0:e.message)||"Failed to update appointment option")}},disabled:j,className:"sr-only peer"}),r("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),j&&r(A,{icon:"heroicons:arrow-path",className:"w-4 h-4 animate-spin text-gray-500"})]}),o(F,{onClick:()=>$(),className:"btn btn-outline-primary btn-sm",children:[r(A,{icon:"heroicons:arrow-path",className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),o(se,{children:[o("div",{className:"mb-6 flex flex-wrap gap-4 items-end",children:[o("div",{className:"flex-1 min-w-[200px]",children:[r("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search"}),r("input",{type:"text",placeholder:"Search by name, phone, email...",className:"form-control",value:P,onChange:t=>{O(t.target.value),y(1)}})]}),o("div",{className:"w-full sm:w-auto",children:[r("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),o("select",{className:"form-control",value:Y,onChange:t=>{I(t.target.value),y(1)},children:[r("option",{value:"",children:"All Statuses"}),r("option",{value:"pending",children:"Pending"}),r("option",{value:"confirmed",children:"Confirmed"}),r("option",{value:"completed",children:"Completed"}),r("option",{value:"cancelled",children:"Cancelled"})]})]}),o("div",{className:"w-full sm:w-auto",children:[r("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contacted"}),o("select",{className:"form-control",value:b,onChange:t=>{M(t.target.value),y(1)},children:[r("option",{value:"",children:"All"}),r("option",{value:"true",children:"Contacted"}),r("option",{value:"false",children:"Not Contacted"})]})]})]}),g&&o("div",{className:"flex items-center justify-center py-10",children:[r(ce,{}),r("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Loading appointments..."})]}),W&&r("div",{className:"py-8 text-center text-red-500",children:"Failed to load appointments"}),!g&&!W&&o(te,{children:[r("div",{className:"overflow-x-auto",children:o("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[r("thead",{className:"bg-gray-50 dark:bg-slate-800",children:o("tr",{children:[r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Preferred"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),o("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-gray-800",children:[Q.length===0&&r("tr",{children:r("td",{colSpan:7,className:"px-4 py-6 text-center text-gray-500 dark:text-gray-400",children:"No appointments found."})}),Q.map(t=>o("tr",{children:[o("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100",children:[r("div",{className:"font-semibold",children:t.name}),t.notes&&r("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.notes})]}),r("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300",children:t.phone}),r("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300",children:t.email||"-"}),o("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300",children:[t.preferredDate||"-"," ",t.preferredTime||""]}),r("td",{className:"px-4 py-3 text-sm",children:o("div",{className:"flex flex-col gap-2",children:[r("div",{children:o("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium ${t.contacted?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400"}`,children:[r(A,{icon:t.contacted?"heroicons:check-circle":"heroicons:clock",className:"w-3.5 h-3.5"}),t.contacted?"Contacted":"Pending"]})}),t.contacted&&t.contactedAt&&o("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r(A,{icon:"heroicons:calendar",className:"w-3 h-3 inline mr-1"}),ne(t.contactedAt).format("DD MMM, HH:mm")]})]})}),r("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300",children:ne(t.createdAt).format("DD MMM YYYY, HH:mm")}),r("td",{className:"px-4 py-3 text-sm",children:t.contacted?r("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"-"}):r(F,{disabled:U,onClick:()=>q(t._id),className:"btn btn-sm btn-success",size:"sm",children:U?o(te,{children:[r(A,{icon:"heroicons:arrow-path",className:"w-4 h-4 mr-1.5 animate-spin"}),"Updating..."]}):o(te,{children:[r(A,{icon:"heroicons:phone",className:"w-4 h-4 mr-1.5"}),"Mark Contacted"]})})})]},t._id))]})]})}),u.totalPages>1&&o("div",{className:"flex items-center justify-between px-6 py-3 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:[o("div",{className:"flex-1 flex justify-between sm:hidden",children:[r(F,{onClick:()=>y(u.currentPage-1),disabled:!u.hasPrevPage,className:"btn btn-outline",children:"Previous"}),r(F,{onClick:()=>y(u.currentPage+1),disabled:!u.hasNextPage,className:"btn btn-outline",children:"Next"})]}),o("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[r("div",{children:o("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing"," ",r("span",{className:"font-medium",children:(u.currentPage-1)*u.limit+1})," ","to"," ",r("span",{className:"font-medium",children:Math.min(u.currentPage*u.limit,u.totalAppointments)})," ","of"," ",r("span",{className:"font-medium",children:u.totalAppointments})," ","results"]})}),r("div",{children:o("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[r(F,{onClick:()=>y(u.currentPage-1),disabled:!u.hasPrevPage,className:"btn btn-outline",children:r(A,{icon:"ph:chevron-left"})}),o("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm font-medium text-gray-500 dark:text-gray-300",children:["Page ",u.currentPage," of ",u.totalPages]}),r(F,{onClick:()=>y(u.currentPage+1),disabled:!u.hasNextPage,className:"btn btn-outline",children:r(A,{icon:"ph:chevron-right"})})]})})]})]})]})]})]})};export{fe as default};
