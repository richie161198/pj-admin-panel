import{a4 as O,b as Q,r as u,j as e,L as Y,c as a,B as r,I as l,F as R,Q as x}from"./index.93603967.js";import{g as G,h as q,i as H}from"./authApiSlice.761d4701.js";import{I as D}from"./InputGroup.84153851.js";import{u as _}from"./index.esm.9a454cb6.js";import"./cleave-phone.us.573a2888.js";const ae=()=>{const{id:o}=O(),p=Q(),[i,T]=u.exports.useState(!1),[U,v]=u.exports.useState(!1),[d,y]=u.exports.useState(null),[m,N]=u.exports.useState(null),g=u.exports.useRef(null),{data:s,isLoading:B,error:h,refetch:b}=G(o),[I,{isLoading:f}]=q(),[P,{isLoading:w}]=H(),{register:k,handleSubmit:S,reset:$,formState:{errors:C}}=_();let t=null;(s==null?void 0:s.categories)&&Array.isArray(s.categories)?t=s.categories[0]:s!=null&&s.category?t=s.category:s&&!s.categories&&(t=s),console.log("Category Details:",t),console.log("Category Response:",s);const V=async()=>{try{await P(o).unwrap(),x.success("Category deleted successfully"),p("/categories")}catch{x.error("Failed to delete category")}},A=()=>{i&&($(),y(null),N(null),g.current&&(g.current.value="")),T(!i)},j=async n=>{try{const c=new FormData;c.append("name",n.name),c.append("description",n.description),c.append("newTag",n.newTag),d&&c.append("image",d),await I({id:o,...n,image:d}).unwrap(),x.success("Category updated successfully"),T(!1),y(null),N(null),b()}catch{x.error("Failed to update category")}},z=n=>{const c=n.target.files[0];if(c){y(c);const F=new FileReader;F.onload=M=>{N(M.target.result)},F.readAsDataURL(c)}},L=()=>{var n;(n=g.current)==null||n.click()},J=()=>{y(null),N(null),g.current&&(g.current.value="")},E=async()=>{try{await I({id:o,newTag:!t.newTag}).unwrap(),x.success(`Category ${t.newTag?"removed from":"added to"} new tag`),b()}catch{x.error("Failed to update new tag status")}};return B?e("div",{className:"flex justify-center items-center h-64",children:e(Y,{})}):h?(console.error("Category Details Error:",h),a("div",{className:"text-center py-8",children:[a("p",{className:"text-red-500",children:["Error loading category: ",h.message]}),a("p",{className:"text-sm text-gray-500 mt-2",children:["Category ID: ",o]}),a("p",{className:"text-sm text-gray-500",children:["Status: ",h.status]}),a("p",{className:"text-sm text-gray-500",children:["Data: ",JSON.stringify(h.data)]}),a("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-left",children:[e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Full Error:"}),e("pre",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 overflow-auto",children:JSON.stringify(h,null,2)})]}),a("div",{className:"flex space-x-2 mt-4",children:[e(r,{onClick:()=>b(),className:"btn btn-primary",children:"Retry"}),e(r,{onClick:()=>p("/categories"),className:"btn btn-outline",children:"Back to Categories"})]})]})):t?a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{className:"flex items-center space-x-4",children:[a(r,{onClick:()=>p("/categories"),className:"btn btn-outline",children:[e(l,{icon:"ph:arrow-left",className:"mr-2"}),"Back"]}),a("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Category Details"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"View and manage category information"})]})]}),e("div",{className:"flex space-x-3",children:i?a(R,{children:[a(r,{onClick:S(j),disabled:f,className:"btn btn-success",children:[e(l,{icon:"ph:check",className:"mr-2"}),f?"Saving...":"Save Changes"]}),a(r,{onClick:A,className:"btn btn-outline",children:[e(l,{icon:"ph:x",className:"mr-2"}),"Cancel"]})]}):a(R,{children:[a(r,{onClick:A,className:"btn btn-outline-secondary",children:[e(l,{icon:"ph:pencil",className:"mr-2"}),"Edit"]}),a(r,{onClick:E,disabled:f,className:`btn ${t.newTag?"btn-outline-warning":"btn-outline-success"}`,children:[e(l,{icon:t.newTag?"ph:tag-slash":"ph:tag",className:"mr-2"}),t.newTag?"Remove New Tag":"Add New Tag"]}),a(r,{onClick:()=>v(!0),disabled:w,className:"btn btn-outline-danger",children:[e(l,{icon:"ph:trash",className:"mr-2"}),"Delete"]})]})})]}),a("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a("div",{className:"lg:col-span-2 space-y-6",children:[a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[a("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Category Image"}),i&&a("div",{className:"flex space-x-2",children:[a(r,{onClick:L,className:"btn btn-outline-primary btn-sm",children:[e(l,{icon:"ph:upload",className:"mr-2"}),"Upload Image"]}),(d||m)&&a(r,{onClick:J,className:"btn btn-outline-danger btn-sm",children:[e(l,{icon:"ph:trash",className:"mr-2"}),"Remove"]})]})]}),e("input",{ref:g,type:"file",accept:"image/*",onChange:z,className:"hidden"}),m?a("div",{className:"aspect-video bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden relative",children:[e("img",{src:m,alt:"Preview",className:"w-full h-full object-cover"}),e("div",{className:"absolute top-2 right-2 bg-green-500 text-white px-2 py-1 rounded-full text-xs",children:"New Image"})]}):t.image?e("div",{className:"aspect-video bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden",children:e("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"})}):e("div",{className:"aspect-video bg-gray-100 dark:bg-slate-700 rounded-lg flex items-center justify-center",children:a("div",{className:"text-center",children:[e(l,{icon:"ph:image",className:"text-6xl text-gray-400 mx-auto mb-2"}),e("p",{className:"text-gray-500 dark:text-gray-400",children:"No image uploaded"}),i&&a(r,{onClick:L,className:"btn btn-outline-primary btn-sm mt-2",children:[e(l,{icon:"ph:upload",className:"mr-2"}),"Upload Image"]})]})}),d&&a("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[a("div",{className:"flex items-center text-sm text-blue-700 dark:text-blue-300",children:[e(l,{icon:"ph:info",className:"mr-2"}),a("span",{children:["Selected: ",d.name]})]}),a("div",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Size: ",(d.size/1024/1024).toFixed(2)," MB"]})]})]}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("form",{onSubmit:S(j),children:[a("div",{className:"flex justify-between items-start mb-4",children:[a("div",{children:[i?e(D,{name:"name",label:"Category Name",placeholder:"Enter category name",defaultValue:t.name,register:k,error:C.name,className:"text-2xl font-bold"}):e("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.name}),a("p",{className:"text-gray-600 dark:text-gray-400",children:["Category ID: ",t._id]})]}),e("div",{className:"flex flex-wrap gap-2",children:e("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${t.newTag?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}`,children:t.newTag?"New Tag":"Regular"})})]}),a("div",{className:"mb-6",children:[e("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Description"}),i?e(D,{name:"description",label:"Description",placeholder:"Enter category description",defaultValue:t.description,register:k,error:C.description,type:"textarea",rows:3}):e("p",{className:"text-gray-600 dark:text-gray-400",children:t.description||"No description available"})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Category Name"}),i?e(D,{name:"name",placeholder:"Enter category name",defaultValue:t.name,register:k,error:C.name}):e("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:t.name||"N/A"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"New Tag Status"}),i?a("select",{...k("newTag"),defaultValue:t.newTag,className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:!1,children:"Regular"}),e("option",{value:!0,children:"New Tag"})]}):e("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:t.newTag?"Yes":"No"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Created At"}),e("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Last Updated"}),e("p",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:t.updatedAt?new Date(t.updatedAt).toLocaleDateString():"N/A"})]})]})]})})]}),a("div",{className:"space-y-6",children:[a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),a("div",{className:"space-y-3",children:[!i&&a(r,{onClick:E,disabled:f,className:`btn w-full justify-start ${t.newTag?"btn-outline-warning":"btn-outline-success"}`,children:[e(l,{icon:t.newTag?"ph:tag-slash":"ph:tag",className:"mr-2"}),t.newTag?"Remove New Tag":"Add New Tag"]}),a(r,{onClick:()=>v(!0),disabled:w,className:"btn btn-outline-danger w-full justify-start",children:[e(l,{icon:"ph:trash",className:"mr-2"}),"Delete Category"]})]})]}),a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Category Information"}),a("div",{className:"space-y-4",children:[a("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Created"}),e("span",{className:"text-sm text-gray-900 dark:text-white",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]}),a("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last Updated"}),e("span",{className:"text-sm text-gray-900 dark:text-white",children:t.updatedAt?new Date(t.updatedAt).toLocaleDateString():"N/A"})]}),a("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"New Tag"}),e("span",{className:`text-sm font-medium ${t.newTag?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-400"}`,children:t.newTag?"Yes":"No"})]}),a("div",{className:"flex justify-between",children:[e("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Has Image"}),e("span",{className:`text-sm font-medium ${t.image?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:t.image?"Yes":"No"})]})]})]}),(t.image||m)&&a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Image Preview"}),a("div",{className:"aspect-square bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden relative",children:[e("img",{src:m||t.image,alt:t.name,className:"w-full h-full object-cover"}),m&&e("div",{className:"absolute top-2 right-2 bg-green-500 text-white px-2 py-1 rounded-full text-xs",children:"New"})]})]})]})]}),U&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4",children:[a("div",{className:"flex items-center mb-4",children:[e(l,{icon:"ph:warning",className:"text-red-500 text-2xl mr-3"}),e("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Category"})]}),a("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:['Are you sure you want to delete the category "',t.name,'"? This action cannot be undone.']}),a("div",{className:"flex space-x-3",children:[a(r,{onClick:V,disabled:w,className:"btn btn-danger flex-1",children:[e(l,{icon:"ph:trash",className:"mr-2"}),w?"Deleting...":"Delete Category"]}),e(r,{onClick:()=>v(!1),className:"btn btn-outline flex-1",children:"Cancel"})]})]})})]}):a("div",{className:"text-center py-8",children:[e("p",{className:"text-gray-500",children:"Category not found"}),a("p",{className:"text-sm text-gray-400 mt-2",children:["Category ID: ",o]}),a("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-left",children:[e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Debug Info:"}),e("pre",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 overflow-auto",children:JSON.stringify(s,null,2)})]}),a("div",{className:"flex space-x-2 mt-4",children:[e(r,{onClick:()=>p("/categories"),className:"btn btn-outline",children:"Back to Categories"}),e(r,{onClick:()=>b(),className:"btn btn-primary",children:"Test API Call"})]})]})};export{ae as default};
