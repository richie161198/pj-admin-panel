import{a4 as T,b as V,ah as H,aa as J,r as h,ai as K,aj as O,ak as W,j as e,L as X,c as a,I as o,B as i,C as y,Q as m}from"./index.db1e92fc.js";const Z=()=>{var D,S;const{id:b}=T(),f=V(),[B]=H(),{user:k}=J(),U=B.get("edit")==="true",[u,w]=h.exports.useState(U),[E,x]=h.exports.useState(!1),[n,N]=h.exports.useState({name:"",email:"",role:"",department:"",phone:"",isActive:!0,permissions:[]}),[l,P]=h.exports.useState({newPassword:"",confirmPassword:""}),{data:v,isLoading:I,error:p,refetch:j}=K(b),[F,{isLoading:A}]=O(),[M,{isLoading:C}]=W(),t=(D=v==null?void 0:v.data)==null?void 0:D.admin;h.exports.useEffect(()=>{t&&N({name:t.name||"",email:t.email||"",role:t.role||"",department:t.department||"",phone:t.phone||"",isActive:t.isActive!==void 0?t.isActive:!0,permissions:t.permissions||[]})},[t]);const g=r=>{const{name:d,value:s,type:c,checked:z}=r.target;N(G=>({...G,[d]:c==="checkbox"?z:s}))},q=r=>{N(d=>({...d,permissions:d.permissions.includes(r)?d.permissions.filter(s=>s!==r):[...d.permissions,r]}))},L=r=>{const{name:d,value:s}=r.target;P(c=>({...c,[d]:s}))},R=async r=>{var d;if(r.preventDefault(),l.newPassword!==l.confirmPassword){m.error("Passwords do not match");return}try{await F({id:b,...n}).unwrap(),m.success("Admin updated successfully"),w(!1),x(!1),j()}catch(s){console.error("Update admin error:",s);const c=((d=s==null?void 0:s.data)==null?void 0:d.message)||(s==null?void 0:s.message)||"Failed to update admin";m.error(c)}},_=async r=>{var d;if(r.preventDefault(),l.newPassword!==l.confirmPassword){m.error("Passwords do not match");return}if(l.newPassword.length<8){m.error("Password must be at least 8 characters long");return}try{await M({id:b,newPassword:l.newPassword}).unwrap(),m.success("Password updated successfully"),x(!1),P({newPassword:"",confirmPassword:""})}catch(s){console.error("Update password error:",s);const c=((d=s==null?void 0:s.data)==null?void 0:d.message)||(s==null?void 0:s.message)||"Failed to update password";m.error(c)}},Q=r=>{switch(r){case"super_admin":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"admin":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"moderator":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"support":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},$=["users:read","users:write","users:delete","products:read","products:write","products:delete","orders:read","orders:write","orders:delete","categories:read","categories:write","categories:delete","analytics:read","settings:read","settings:write","tickets:read","tickets:write","tickets:delete","admins:read","admins:write","admins:delete"];return I?e("div",{className:"flex justify-center items-center h-64",children:e(X,{})}):p?a("div",{className:"text-center py-8",children:[e(o,{icon:"ph:warning",className:"mx-auto text-red-500 text-4xl mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Error Loading Admin"}),e("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:((S=p==null?void 0:p.data)==null?void 0:S.message)||"Failed to load admin details"}),a(i,{onClick:()=>f("/admin-list"),className:"btn btn-primary",children:[e(o,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Admin List"]})]}):t?a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{children:[a(i,{onClick:()=>f("/admin-list"),className:"btn btn-outline mb-4",children:[e(o,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Admin List"]}),e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Edit Admin":"Admin Details"}),e("p",{className:"text-gray-500 dark:text-gray-400",children:u?"Update admin information and permissions":"View admin details and activity"})]}),(k==null?void 0:k.role)==="super_admin"&&!u&&a("div",{className:"flex space-x-2",children:[a(i,{onClick:()=>w(!0),className:"btn btn-primary",children:[e(o,{icon:"ph:pencil",className:"mr-2"}),"Edit Admin"]}),a(i,{onClick:()=>x(!0),className:"btn btn-outline",children:[e(o,{icon:"ph:key",className:"mr-2"}),"Change Password"]})]})]}),a("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a("div",{className:"lg:col-span-2",children:[e(y,{title:"Basic Information",children:u?a("form",{onSubmit:R,className:"space-y-4",children:[a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Name *"}),e("input",{type:"text",name:"name",value:n.name,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email *"}),e("input",{type:"email",name:"email",value:n.email,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Role *"}),a("select",{name:"role",value:n.role,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white",children:[e("option",{value:"",children:"Select Role"}),e("option",{value:"admin",children:"Admin"}),e("option",{value:"moderator",children:"Moderator"}),e("option",{value:"support",children:"Support"})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Department"}),e("input",{type:"text",name:"department",value:n.department,onChange:g,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Phone"}),e("input",{type:"tel",name:"phone",value:n.phone,onChange:g,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]}),a("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"isActive",checked:n.isActive,onChange:g,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e("label",{className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:"Active Account"})]})]}),a("div",{className:"flex justify-end space-x-2",children:[e(i,{type:"button",onClick:()=>w(!1),className:"btn btn-outline",children:"Cancel"}),e(i,{type:"submit",disabled:A,className:"btn btn-primary",children:A?"Updating...":"Update Admin"})]})]}):e("div",{className:"space-y-4",children:a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Name"}),e("p",{className:"text-sm text-gray-900 dark:text-white",children:t.name})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Email"}),e("p",{className:"text-sm text-gray-900 dark:text-white",children:t.email})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Role"}),e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Q(t.role)}`,children:t.role.replace("_"," ").toUpperCase()})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Department"}),e("p",{className:"text-sm text-gray-900 dark:text-white",children:t.department||"-"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Phone"}),e("p",{className:"text-sm text-gray-900 dark:text-white",children:t.phone||"-"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Status"}),e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:t.isActive?"Active":"Inactive"})]})]})})}),e(y,{title:"Permissions",className:"mt-6",children:u?a("div",{className:"space-y-4",children:[e("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Select the permissions this admin should have:"}),e("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:$.map(r=>a("label",{className:"flex items-center",children:[e("input",{type:"checkbox",checked:n.permissions.includes(r),onChange:()=>q(r),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:r})]},r))})]}):e("div",{className:"space-y-2",children:t.permissions&&t.permissions.length>0?e("div",{className:"flex flex-wrap gap-2",children:t.permissions.map(r=>e("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:r},r))}):e("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No permissions assigned"})})})]}),a("div",{className:"space-y-6",children:[e(y,{title:"Account Status",children:a("div",{className:"space-y-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Created"}),e("p",{className:"text-sm text-gray-900 dark:text-white",children:new Date(t.createdAt).toLocaleDateString()})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Last Login"}),e("p",{className:"text-sm text-gray-900 dark:text-white",children:t.lastLogin?new Date(t.lastLogin).toLocaleDateString():"Never"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400",children:"Last Modified"}),e("p",{className:"text-sm text-gray-900 dark:text-white",children:t.updatedAt?new Date(t.updatedAt).toLocaleDateString():"-"})]})]})}),t.createdBy&&e(y,{title:"Created By",children:a("div",{className:"space-y-2",children:[e("p",{className:"text-sm text-gray-900 dark:text-white",children:t.createdBy.name}),e("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.createdBy.email})]})})]})]}),E&&e("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white dark:bg-gray-800",children:a("div",{className:"mt-3",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Change Password"}),a("form",{onSubmit:_,className:"space-y-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password *"}),e("input",{type:"password",name:"newPassword",value:l.newPassword,onChange:L,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Password *"}),e("input",{type:"password",name:"confirmPassword",value:l.confirmPassword,onChange:L,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white"})]}),a("div",{className:"flex justify-end space-x-2",children:[e(i,{type:"button",onClick:()=>x(!1),className:"btn btn-outline",children:"Cancel"}),e(i,{type:"submit",disabled:C,className:"btn btn-primary",children:C?"Updating...":"Update Password"})]})]})]})})})]}):a("div",{className:"text-center py-8",children:[e(o,{icon:"ph:user-x",className:"mx-auto text-gray-400 text-4xl mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Admin Not Found"}),e("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"The requested admin account could not be found."}),a(i,{onClick:()=>f("/admin-list"),className:"btn btn-primary",children:[e(o,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Admin List"]})]})};export{Z as default};
