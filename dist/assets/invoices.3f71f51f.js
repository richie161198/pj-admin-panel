import{b as Be,r as W,a5 as Qe,a6 as He,j as n,c,B as ne,I as Oe,L as Re,F as Xe,Q as E}from"./index.2de9f08c.js";import{B as $e}from"./Badge.bcab67cf.js";import{u as oe,a as Ve}from"./xlsx.0799a57e.js";const Le=6048e5,Ue=864e5,Ce=Symbol.for("constructDateFrom");function L(a,e){return typeof a=="function"?a(e):a&&typeof a=="object"&&Ce in a?a[Ce](e):a instanceof Date?new a.constructor(e):new Date(e)}function O(a,e){return L(e||a,a)}let Je={};function ie(){return Je}function Z(a,e){var u,x,b,w,y,k,N,S;const t=ie(),r=(S=(N=(w=(b=e==null?void 0:e.weekStartsOn)!=null?b:(x=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:x.weekStartsOn)!=null?w:t.weekStartsOn)!=null?N:(k=(y=t.locale)==null?void 0:y.options)==null?void 0:k.weekStartsOn)!=null?S:0,s=O(a,e==null?void 0:e.in),o=s.getDay(),d=(o<r?7:0)+o-r;return s.setDate(s.getDate()-d),s.setHours(0,0,0,0),s}function se(a,e){return Z(a,{...e,weekStartsOn:1})}function je(a,e){const t=O(a,e==null?void 0:e.in),r=t.getFullYear(),s=L(t,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const o=se(s),d=L(t,0);d.setFullYear(r,0,4),d.setHours(0,0,0,0);const u=se(d);return t.getTime()>=o.getTime()?r+1:t.getTime()>=u.getTime()?r:r-1}function Te(a){const e=O(a),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+a-+t}function ze(a,...e){const t=L.bind(null,a||e.find(r=>typeof r=="object"));return e.map(t)}function We(a,e){const t=O(a,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function Ke(a,e,t){const[r,s]=ze(t==null?void 0:t.in,a,e),o=We(r),d=We(s),u=+o-Te(o),x=+d-Te(d);return Math.round((u-x)/Ue)}function Ze(a,e){const t=je(a,e),r=L((e==null?void 0:e.in)||a,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),se(r)}function et(a){return a instanceof Date||typeof a=="object"&&Object.prototype.toString.call(a)==="[object Date]"}function tt(a){return!(!et(a)&&typeof a!="number"||isNaN(+O(a)))}function at(a,e){const t=O(a,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const rt={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},nt=(a,e,t)=>{let r;const s=rt[a];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function de(a){return(e={})=>{const t=e.width?String(e.width):a.defaultWidth;return a.formats[t]||a.formats[a.defaultWidth]}}const st={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},it={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ct={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ot={date:de({formats:st,defaultWidth:"full"}),time:de({formats:it,defaultWidth:"full"}),dateTime:de({formats:ct,defaultWidth:"full"})},dt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lt=(a,e,t,r)=>dt[a];function z(a){return(e,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let s;if(r==="formatting"&&a.formattingValues){const d=a.defaultFormattingWidth||a.defaultWidth,u=t!=null&&t.width?String(t.width):d;s=a.formattingValues[u]||a.formattingValues[d]}else{const d=a.defaultWidth,u=t!=null&&t.width?String(t.width):a.defaultWidth;s=a.values[u]||a.values[d]}const o=a.argumentCallback?a.argumentCallback(e):e;return s[o]}}const ut={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ht={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},mt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ft={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},gt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},xt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},wt=(a,e)=>{const t=Number(a),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},yt={ordinalNumber:wt,era:z({values:ut,defaultWidth:"wide"}),quarter:z({values:ht,defaultWidth:"wide",argumentCallback:a=>a-1}),month:z({values:mt,defaultWidth:"wide"}),day:z({values:ft,defaultWidth:"wide"}),dayPeriod:z({values:gt,defaultWidth:"wide",formattingValues:xt,defaultFormattingWidth:"wide"})};function K(a){return(e,t={})=>{const r=t.width,s=r&&a.matchPatterns[r]||a.matchPatterns[a.defaultMatchWidth],o=e.match(s);if(!o)return null;const d=o[0],u=r&&a.parsePatterns[r]||a.parsePatterns[a.defaultParseWidth],x=Array.isArray(u)?vt(u,y=>y.test(d)):bt(u,y=>y.test(d));let b;b=a.valueCallback?a.valueCallback(x):x,b=t.valueCallback?t.valueCallback(b):b;const w=e.slice(d.length);return{value:b,rest:w}}}function bt(a,e){for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)&&e(a[t]))return t}function vt(a,e){for(let t=0;t<a.length;t++)if(e(a[t]))return t}function kt(a){return(e,t={})=>{const r=e.match(a.matchPattern);if(!r)return null;const s=r[0],o=e.match(a.parsePattern);if(!o)return null;let d=a.valueCallback?a.valueCallback(o[0]):o[0];d=t.valueCallback?t.valueCallback(d):d;const u=e.slice(s.length);return{value:d,rest:u}}}const pt=/^(\d+)(th|st|nd|rd)?/i,Nt=/\d+/i,St={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Dt={any:[/^b/i,/^(a|c)/i]},Pt={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Mt={any:[/1/i,/2/i,/3/i,/4/i]},Ot={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ct={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Tt={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Wt={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Et={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Yt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ft={ordinalNumber:kt({matchPattern:pt,parsePattern:Nt,valueCallback:a=>parseInt(a,10)}),era:K({matchPatterns:St,defaultMatchWidth:"wide",parsePatterns:Dt,defaultParseWidth:"any"}),quarter:K({matchPatterns:Pt,defaultMatchWidth:"wide",parsePatterns:Mt,defaultParseWidth:"any",valueCallback:a=>a+1}),month:K({matchPatterns:Ot,defaultMatchWidth:"wide",parsePatterns:Ct,defaultParseWidth:"any"}),day:K({matchPatterns:Tt,defaultMatchWidth:"wide",parsePatterns:Wt,defaultParseWidth:"any"}),dayPeriod:K({matchPatterns:Et,defaultMatchWidth:"any",parsePatterns:Yt,defaultParseWidth:"any"})},It={code:"en-US",formatDistance:nt,formatLong:ot,formatRelative:lt,localize:yt,match:Ft,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Lt(a,e){const t=O(a,e==null?void 0:e.in);return Ke(t,at(t))+1}function jt(a,e){const t=O(a,e==null?void 0:e.in),r=+se(t)-+Ze(t);return Math.round(r/Le)+1}function Ae(a,e){var w,y,k,N,S,Y,f,q;const t=O(a,e==null?void 0:e.in),r=t.getFullYear(),s=ie(),o=(q=(f=(N=(k=e==null?void 0:e.firstWeekContainsDate)!=null?k:(y=(w=e==null?void 0:e.locale)==null?void 0:w.options)==null?void 0:y.firstWeekContainsDate)!=null?N:s.firstWeekContainsDate)!=null?f:(Y=(S=s.locale)==null?void 0:S.options)==null?void 0:Y.firstWeekContainsDate)!=null?q:1,d=L((e==null?void 0:e.in)||a,0);d.setFullYear(r+1,0,o),d.setHours(0,0,0,0);const u=Z(d,e),x=L((e==null?void 0:e.in)||a,0);x.setFullYear(r,0,o),x.setHours(0,0,0,0);const b=Z(x,e);return+t>=+u?r+1:+t>=+b?r:r-1}function At(a,e){var u,x,b,w,y,k,N,S;const t=ie(),r=(S=(N=(w=(b=e==null?void 0:e.firstWeekContainsDate)!=null?b:(x=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:x.firstWeekContainsDate)!=null?w:t.firstWeekContainsDate)!=null?N:(k=(y=t.locale)==null?void 0:y.options)==null?void 0:k.firstWeekContainsDate)!=null?S:1,s=Ae(a,e),o=L((e==null?void 0:e.in)||a,0);return o.setFullYear(s,0,r),o.setHours(0,0,0,0),Z(o,e)}function qt(a,e){const t=O(a,e==null?void 0:e.in),r=+Z(t,e)-+At(t,e);return Math.round(r/Le)+1}function l(a,e){const t=a<0?"-":"",r=Math.abs(a).toString().padStart(e,"0");return t+r}const I={y(a,e){const t=a.getFullYear(),r=t>0?t:1-t;return l(e==="yy"?r%100:r,e.length)},M(a,e){const t=a.getMonth();return e==="M"?String(t+1):l(t+1,2)},d(a,e){return l(a.getDate(),e.length)},a(a,e){const t=a.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(a,e){return l(a.getHours()%12||12,e.length)},H(a,e){return l(a.getHours(),e.length)},m(a,e){return l(a.getMinutes(),e.length)},s(a,e){return l(a.getSeconds(),e.length)},S(a,e){const t=e.length,r=a.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return l(s,e.length)}},B={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ee={G:function(a,e,t){const r=a.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(a,e,t){if(e==="yo"){const r=a.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return I.y(a,e)},Y:function(a,e,t,r){const s=Ae(a,r),o=s>0?s:1-s;if(e==="YY"){const d=o%100;return l(d,2)}return e==="Yo"?t.ordinalNumber(o,{unit:"year"}):l(o,e.length)},R:function(a,e){const t=je(a);return l(t,e.length)},u:function(a,e){const t=a.getFullYear();return l(t,e.length)},Q:function(a,e,t){const r=Math.ceil((a.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return l(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(a,e,t){const r=Math.ceil((a.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return l(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(a,e,t){const r=a.getMonth();switch(e){case"M":case"MM":return I.M(a,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(a,e,t){const r=a.getMonth();switch(e){case"L":return String(r+1);case"LL":return l(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(a,e,t,r){const s=qt(a,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):l(s,e.length)},I:function(a,e,t){const r=jt(a);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):l(r,e.length)},d:function(a,e,t){return e==="do"?t.ordinalNumber(a.getDate(),{unit:"date"}):I.d(a,e)},D:function(a,e,t){const r=Lt(a);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):l(r,e.length)},E:function(a,e,t){const r=a.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(a,e,t,r){const s=a.getDay(),o=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return l(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(a,e,t,r){const s=a.getDay(),o=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return l(o,e.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(a,e,t){const r=a.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return l(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(a,e,t){const s=a.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(a,e,t){const r=a.getHours();let s;switch(r===12?s=B.noon:r===0?s=B.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(a,e,t){const r=a.getHours();let s;switch(r>=17?s=B.evening:r>=12?s=B.afternoon:r>=4?s=B.morning:s=B.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(a,e,t){if(e==="ho"){let r=a.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return I.h(a,e)},H:function(a,e,t){return e==="Ho"?t.ordinalNumber(a.getHours(),{unit:"hour"}):I.H(a,e)},K:function(a,e,t){const r=a.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):l(r,e.length)},k:function(a,e,t){let r=a.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):l(r,e.length)},m:function(a,e,t){return e==="mo"?t.ordinalNumber(a.getMinutes(),{unit:"minute"}):I.m(a,e)},s:function(a,e,t){return e==="so"?t.ordinalNumber(a.getSeconds(),{unit:"second"}):I.s(a,e)},S:function(a,e){return I.S(a,e)},X:function(a,e,t){const r=a.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return Fe(r);case"XXXX":case"XX":return A(r);case"XXXXX":case"XXX":default:return A(r,":")}},x:function(a,e,t){const r=a.getTimezoneOffset();switch(e){case"x":return Fe(r);case"xxxx":case"xx":return A(r);case"xxxxx":case"xxx":default:return A(r,":")}},O:function(a,e,t){const r=a.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Ye(r,":");case"OOOO":default:return"GMT"+A(r,":")}},z:function(a,e,t){const r=a.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Ye(r,":");case"zzzz":default:return"GMT"+A(r,":")}},t:function(a,e,t){const r=Math.trunc(+a/1e3);return l(r,e.length)},T:function(a,e,t){return l(+a,e.length)}};function Ye(a,e=""){const t=a>0?"-":"+",r=Math.abs(a),s=Math.trunc(r/60),o=r%60;return o===0?t+String(s):t+String(s)+e+l(o,2)}function Fe(a,e){return a%60===0?(a>0?"-":"+")+l(Math.abs(a)/60,2):A(a,e)}function A(a,e=""){const t=a>0?"-":"+",r=Math.abs(a),s=l(Math.trunc(r/60),2),o=l(r%60,2);return t+s+e+o}const Ie=(a,e)=>{switch(a){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},qe=(a,e)=>{switch(a){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},_t=(a,e)=>{const t=a.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return Ie(a,e);let o;switch(r){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",Ie(r,e)).replace("{{time}}",qe(s,e))},Gt={p:qe,P:_t},Bt=/^D+$/,Qt=/^Y+$/,Ht=["D","DD","YY","YYYY"];function Rt(a){return Bt.test(a)}function Xt(a){return Qt.test(a)}function $t(a,e,t){const r=Vt(a,e,t);if(console.warn(r),Ht.includes(a))throw new RangeError(r)}function Vt(a,e,t){const r=a[0]==="Y"?"years":"days of the month";return`Use \`${a.toLowerCase()}\` instead of \`${a}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ut=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Jt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zt=/^'([^]*?)'?$/,Kt=/''/g,Zt=/[a-zA-Z]/;function ea(a,e,t){var w,y,k,N,S,Y,f,q,ee,Q,_,H,C,ce,D,te,R,ae;const r=ie(),s=(y=(w=t==null?void 0:t.locale)!=null?w:r.locale)!=null?y:It,o=(Q=(ee=(Y=(S=t==null?void 0:t.firstWeekContainsDate)!=null?S:(N=(k=t==null?void 0:t.locale)==null?void 0:k.options)==null?void 0:N.firstWeekContainsDate)!=null?Y:r.firstWeekContainsDate)!=null?ee:(q=(f=r.locale)==null?void 0:f.options)==null?void 0:q.firstWeekContainsDate)!=null?Q:1,d=(ae=(R=(ce=(C=t==null?void 0:t.weekStartsOn)!=null?C:(H=(_=t==null?void 0:t.locale)==null?void 0:_.options)==null?void 0:H.weekStartsOn)!=null?ce:r.weekStartsOn)!=null?R:(te=(D=r.locale)==null?void 0:D.options)==null?void 0:te.weekStartsOn)!=null?ae:0,u=O(a,t==null?void 0:t.in);if(!tt(u))throw new RangeError("Invalid time value");let x=e.match(Jt).map(p=>{const v=p[0];if(v==="p"||v==="P"){const X=Gt[v];return X(p,s.formatLong)}return p}).join("").match(Ut).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const v=p[0];if(v==="'")return{isToken:!1,value:ta(p)};if(Ee[v])return{isToken:!0,value:p};if(v.match(Zt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:p}});s.localize.preprocessor&&(x=s.localize.preprocessor(u,x));const b={firstWeekContainsDate:o,weekStartsOn:d,locale:s};return x.map(p=>{if(!p.isToken)return p.value;const v=p.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&Xt(v)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&Rt(v))&&$t(v,e,String(a));const X=Ee[v[0]];return X(u,v,s.localize,b)}).join("")}function ta(a){const e=a.match(zt);return e?e[1].replace(Kt,"'"):a}const sa=()=>{var le,ue,he,me,fe,ge,xe,we,ye,be,ve,ke,pe,Ne,Se,De,Pe,Me;Be();const[a,e]=W.exports.useState(""),[t,r]=W.exports.useState("all"),[s,o]=W.exports.useState(1),[d,u]=W.exports.useState(""),[x,b]=W.exports.useState(""),[w,y]=W.exports.useState([]),[k,N]=W.exports.useState(!1),[S,Y]=W.exports.useState(!1),[f,q]=W.exports.useState(null),[ee,Q]=W.exports.useState(!1),{data:_,isLoading:H,error:C,refetch:ce}=Qe({page:s,limit:10,search:a,status:t!=="all"?t:void 0,startDate:d,endDate:x});He();const D=(_==null?void 0:_.data)||[],te=()=>{e(""),r("all"),u(""),b(""),o(1)},R=async(i,g)=>{try{E.info("Preparing invoice for download...");const h=await fetch(`http://35.154.139.118/api/v0/invoices/${i}/download`,{method:"GET",headers:{"Content-Type":"application/json"}});if(h.ok){const T=await h.blob(),m=window.URL.createObjectURL(T),P=document.createElement("a");P.href=m,P.download=`${g||`invoice-${i}`}.pdf`,document.body.appendChild(P),P.click(),window.URL.revokeObjectURL(m),document.body.removeChild(P),E.success("Invoice downloaded successfully")}else E.error("Failed to download invoice")}catch(h){console.error("Download error:",h),E.error("Failed to download invoice")}},ae=async()=>{if(w.length===0){E.warning("Please select invoices to download");return}Y(!0);let i=0,g=0;try{for(const h of w){const T=D.find(m=>m._id===h);if(!!T)try{const m=await fetch(`http://35.154.139.118/api/v0/invoices/${h}/download`,{method:"GET"});if(m.ok){const P=await m.blob(),F=window.URL.createObjectURL(P),M=document.createElement("a");M.href=F,M.download=`${T.invoiceNumber}.pdf`,document.body.appendChild(M),M.click(),window.URL.revokeObjectURL(F),document.body.removeChild(M),i++,await new Promise(j=>setTimeout(j,500))}else g++}catch(m){console.error(`Error downloading invoice ${T.invoiceNumber}:`,m),g++}}i>0&&E.success(`Successfully downloaded ${i} invoice(s)`),g>0&&E.error(`Failed to download ${g} invoice(s)`),y([]),N(!1)}catch(h){console.error("Error in bulk download:",h),E.error("Bulk download failed")}finally{Y(!1)}},p=()=>{try{const i=D.map((m,P)=>{var F,M,j,$,V,U,J,re;return{"S.No":P+1,"Invoice Number":m.invoiceNumber||"N/A","Customer Name":((F=m.customerDetails)==null?void 0:F.name)||"N/A","Customer Email":((M=m.customerDetails)==null?void 0:M.email)||"N/A","Customer Phone":((j=m.customerDetails)==null?void 0:j.phone)||"N/A",Subtotal:(($=m.pricing)==null?void 0:$.subtotal)||0,"Making Charges":((V=m.pricing)==null?void 0:V.totalMakingCharges)||0,GST:((U=m.pricing)==null?void 0:U.totalGST)||0,Discount:((J=m.pricing)==null?void 0:J.totalDiscount)||0,"Grand Total":((re=m.pricing)==null?void 0:re.grandTotal)||0,Status:m.status||"N/A","Invoice Date":m.createdAt?new Date(m.createdAt).toLocaleDateString():"N/A"}}),g=oe.json_to_sheet(i),h=oe.book_new();oe.book_append_sheet(h,g,"Commerce Invoices");const T=[{wch:5},{wch:20},{wch:20},{wch:25},{wch:15},{wch:12},{wch:15},{wch:12},{wch:12},{wch:15},{wch:12},{wch:15}];g["!cols"]=T,Ve(h,`Commerce_Invoices_${new Date().toISOString().slice(0,10)}.xlsx`),E.success("Excel file downloaded successfully")}catch(i){console.error("Error exporting to Excel:",i),E.error("Failed to export to Excel")}},v=()=>{y(k?[]:D.map(i=>i._id)),N(!k)},X=i=>{y(g=>g.includes(i)?g.filter(h=>h!==i):[...g,i])},G=i=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(i),_e=i=>{const h={draft:{color:"secondary",text:"Draft"},sent:{color:"info",text:"Sent"},paid:{color:"success",text:"Paid"},overdue:{color:"danger",text:"Overdue"},cancelled:{color:"secondary",text:"Cancelled"}}[i]||{color:"secondary",text:i};return n($e,{className:`badge-${h.color}`,children:h.text})};return C?n("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:n("div",{className:"flex",children:c("div",{className:"ml-3",children:[n("h3",{className:"text-sm font-medium text-red-800",children:"Error loading invoices"}),n("div",{className:"mt-2 text-sm text-red-700",children:((le=C==null?void 0:C.data)==null?void 0:le.message)||(C==null?void 0:C.message)||"Unknown error occurred"})]})})}):c("div",{className:"space-y-5",children:[c("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[c("div",{children:[n("h4",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Commerce Invoices"}),n("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:"Manage and download customer invoices"})]}),c("div",{className:"flex gap-2",children:[n(ne,{icon:"heroicons-outline:download",text:"Export to Excel",className:"btn-success",onClick:p,disabled:H||D.length===0}),w.length>0&&n(ne,{icon:"heroicons-outline:download",text:`Download Selected (${w.length})`,className:"btn-primary",onClick:ae,disabled:S,isLoading:S})]})]}),n("div",{className:"card",children:n("div",{className:"card-body",children:c("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-4",children:[c("div",{children:[n("label",{className:"form-label",children:"Search"}),c("div",{className:"relative",children:[n("input",{type:"text",className:"form-control",placeholder:"Invoice No, Customer...",value:a,onChange:i=>e(i.target.value)}),n(Oe,{icon:"heroicons-outline:search",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400"})]})]}),c("div",{children:[n("label",{className:"form-label",children:"Status"}),c("select",{className:"form-control",value:t,onChange:i=>{r(i.target.value),o(1)},children:[n("option",{value:"all",children:"All Statuses"}),n("option",{value:"draft",children:"Draft"}),n("option",{value:"sent",children:"Sent"}),n("option",{value:"paid",children:"Paid"}),n("option",{value:"overdue",children:"Overdue"}),n("option",{value:"cancelled",children:"Cancelled"})]})]}),c("div",{children:[n("label",{className:"form-label",children:"Start Date"}),n("input",{type:"date",className:"form-control",value:d,onChange:i=>{u(i.target.value),o(1)}})]}),c("div",{children:[n("label",{className:"form-label",children:"End Date"}),n("input",{type:"date",className:"form-control",value:x,onChange:i=>{b(i.target.value),o(1)}})]}),n("div",{className:"flex items-end",children:n(ne,{text:"Clear Filters",className:"btn-outline-secondary w-full",onClick:te})})]})})}),n("div",{className:"card",children:n("div",{className:"card-body px-0 pb-0",children:H?n("div",{className:"flex justify-center items-center py-20",children:n(Re,{})}):D.length===0?c("div",{className:"text-center py-20",children:[n(Oe,{icon:"heroicons-outline:document-text",className:"mx-auto text-slate-300 dark:text-slate-600 mb-4",width:"64"}),n("p",{className:"text-slate-500 dark:text-slate-400",children:"No invoices found"})]}):c(Xe,{children:[n("div",{className:"overflow-x-auto",children:c("table",{className:"min-w-full divide-y divide-slate-200 dark:divide-slate-700",children:[n("thead",{className:"bg-slate-50 dark:bg-slate-800",children:c("tr",{children:[n("th",{className:"px-6 py-3 text-left",children:n("input",{type:"checkbox",checked:k,onChange:v,className:"form-checkbox"})}),n("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Invoice Details"}),n("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Customer"}),n("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Products"}),n("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Amount"}),n("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Status"}),n("th",{className:"px-6 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Actions"})]})}),n("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700",children:D.map(i=>{var g,h,T,m,P,F,M,j,$,V,U,J;return c("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700",children:[n("td",{className:"px-6 py-4",children:n("input",{type:"checkbox",checked:w.includes(i._id),onChange:()=>X(i._id),className:"form-checkbox"})}),n("td",{className:"px-6 py-4",children:c("div",{children:[n("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:i.invoiceNumber}),n("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:ea(new Date(i.createdAt),"dd MMM yyyy, hh:mm a")})]})}),n("td",{className:"px-6 py-4",children:c("div",{children:[n("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:((g=i.customerDetails)==null?void 0:g.name)||"N/A"}),n("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:((h=i.customerDetails)==null?void 0:h.email)||"N/A"}),n("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:((T=i.customerDetails)==null?void 0:T.phone)||"N/A"})]})}),n("td",{className:"px-6 py-4",children:c("div",{children:[c("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:[((m=i.products)==null?void 0:m.length)||0," item(s)"]}),c("div",{className:"text-xs text-slate-500 dark:text-slate-500",children:["Total Weight: ",(P=i.products)==null?void 0:P.reduce((re,Ge)=>re+(Ge.weight||0),0).toFixed(2),"g"]})]})}),n("td",{className:"px-6 py-4",children:c("div",{children:[c("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:["\u20B9",((M=(F=i.pricing)==null?void 0:F.grandTotal)==null?void 0:M.toLocaleString("en-IN"))||0]}),c("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Subtotal: \u20B9",(($=(j=i.pricing)==null?void 0:j.subtotal)==null?void 0:$.toLocaleString("en-IN"))||0]}),(((V=i.pricing)==null?void 0:V.totalGST)||0)>0&&c("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["GST: \u20B9",(J=(U=i.pricing)==null?void 0:U.totalGST)==null?void 0:J.toLocaleString("en-IN")]})]})}),n("td",{className:"px-6 py-4",children:_e(i.status)}),n("td",{className:"px-6 py-4",children:n("div",{className:"flex gap-2 justify-center",children:n(ne,{icon:"heroicons-outline:download",className:"btn-sm btn-primary",onClick:()=>R(i._id,i.invoiceNumber),title:"Download Invoice"})})})]},i._id)})})]})}),n("div",{className:"px-6 py-4 bg-slate-50 dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700",children:c("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c("div",{children:[n("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total Invoices"}),n("p",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:D.length})]}),c("div",{children:[n("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total Amount"}),c("p",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:["\u20B9",D.reduce((i,g)=>{var h;return i+(((h=g.pricing)==null?void 0:h.grandTotal)||0)},0).toLocaleString("en-IN")]})]}),c("div",{children:[n("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total GST"}),c("p",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:["\u20B9",D.reduce((i,g)=>{var h;return i+(((h=g.pricing)==null?void 0:h.totalGST)||0)},0).toLocaleString("en-IN")]})]}),c("div",{children:[n("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Selected"}),n("p",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:w.length})]})]})})]})})}),ee&&f&&n("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:n("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white dark:bg-slate-800",children:c("div",{className:"mt-3",children:[c("div",{className:"flex justify-between items-center mb-4",children:[c("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Invoice Details - ",f.invoiceNumber]}),c("button",{onClick:()=>Q(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:[n("span",{className:"sr-only",children:"Close"}),n("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),c("div",{className:"space-y-4",children:[c("div",{children:[n("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Customer Information"}),c("div",{className:"bg-gray-50 dark:bg-slate-700 p-3 rounded-md",children:[c("p",{children:[n("strong",{children:"Name:"})," ",(ue=f.customerDetails)==null?void 0:ue.name]}),c("p",{children:[n("strong",{children:"Email:"})," ",(he=f.customerDetails)==null?void 0:he.email]}),c("p",{children:[n("strong",{children:"Phone:"})," ",(me=f.customerDetails)==null?void 0:me.phone]}),c("p",{children:[n("strong",{children:"Address:"})," ",(ge=(fe=f.customerDetails)==null?void 0:fe.address)==null?void 0:ge.street,", ",(we=(xe=f.customerDetails)==null?void 0:xe.address)==null?void 0:we.city,", ",(be=(ye=f.customerDetails)==null?void 0:ye.address)==null?void 0:be.state," - ",(ke=(ve=f.customerDetails)==null?void 0:ve.address)==null?void 0:ke.pincode]})]})]}),c("div",{children:[n("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Products"}),n("div",{className:"overflow-x-auto",children:c("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[n("thead",{className:"bg-gray-50 dark:bg-slate-700",children:c("tr",{children:[n("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-slate-300 uppercase",children:"Product"}),n("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-slate-300 uppercase",children:"Qty"}),n("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-slate-300 uppercase",children:"Weight"}),n("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-slate-300 uppercase",children:"Purity"}),n("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-slate-300 uppercase",children:"Price"})]})}),n("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-slate-700",children:(pe=f.products)==null?void 0:pe.map((i,g)=>c("tr",{children:[n("td",{className:"px-3 py-2 text-sm text-gray-900 dark:text-white",children:i.name}),n("td",{className:"px-3 py-2 text-sm text-gray-900 dark:text-white",children:i.quantity}),c("td",{className:"px-3 py-2 text-sm text-gray-900 dark:text-white",children:[i.weight||0,"g"]}),n("td",{className:"px-3 py-2 text-sm text-gray-900 dark:text-white",children:i.purity}),n("td",{className:"px-3 py-2 text-sm text-gray-900 dark:text-white",children:G(i.finalPrice||0)})]},g))})]})})]}),c("div",{children:[n("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Pricing Summary"}),c("div",{className:"bg-gray-50 dark:bg-slate-700 p-3 rounded-md space-y-1",children:[c("div",{className:"flex justify-between",children:[n("span",{children:"Subtotal:"}),n("span",{children:G(((Ne=f.pricing)==null?void 0:Ne.subtotal)||0)})]}),c("div",{className:"flex justify-between",children:[n("span",{children:"Making Charges:"}),n("span",{children:G(((Se=f.pricing)==null?void 0:Se.totalMakingCharges)||0)})]}),c("div",{className:"flex justify-between",children:[n("span",{children:"GST:"}),n("span",{children:G(((De=f.pricing)==null?void 0:De.totalGST)||0)})]}),c("div",{className:"flex justify-between",children:[n("span",{children:"Discount:"}),n("span",{children:G(((Pe=f.pricing)==null?void 0:Pe.totalDiscount)||0)})]}),c("div",{className:"flex justify-between font-bold border-t border-gray-200 dark:border-slate-600 pt-2",children:[n("span",{children:"Grand Total:"}),n("span",{children:G(((Me=f.pricing)==null?void 0:Me.grandTotal)||0)})]})]})]})]}),c("div",{className:"mt-6 flex justify-end space-x-3",children:[n("button",{onClick:()=>R(f._id,f.invoiceNumber),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700",children:"Download PDF"}),n("button",{onClick:()=>Q(!1),className:"bg-gray-300 dark:bg-slate-600 text-gray-700 dark:text-white px-4 py-2 rounded-md hover:bg-gray-400 dark:hover:bg-slate-500",children:"Close"})]})]})})})]})};export{sa as default};
