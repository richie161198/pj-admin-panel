import{r as l,j as e,c as a}from"./index.67c6c4a2.js";import{a as v}from"./axios.8132557a.js";const B=({children:i,className:n=""})=>e("div",{className:`border rounded bg-white ${n}`,children:i}),d=({children:i,className:n="",onClick:p,type:f="button",disabled:x})=>e("button",{type:f,disabled:x,onClick:p,className:`px-4 py-2 border rounded ${x?"opacity-60 cursor-not-allowed":""} ${n}`,children:i}),j=({className:i=""})=>e("span",{className:i,"aria-hidden":!0}),U=i=>e("input",{...i,className:`w-full border rounded px-3 py-2 ${i.className||""}`}),R=({children:i,...n})=>e("select",{...n,className:`w-full border rounded px-3 py-2 ${n.className||""}`,children:i}),q=({checked:i,onChange:n,name:p})=>e("input",{type:"checkbox",name:p,checked:i,onChange:n}),ee=()=>{const[i,n]=l.exports.useState([]),[p,f]=l.exports.useState(!0);l.exports.useState(!1);const[x,y]=l.exports.useState(!1),[J,L]=l.exports.useState(null),[k,P]=l.exports.useState(null),[F,I]=l.exports.useState(null),[E,T]=l.exports.useState(!1),[b,K]=l.exports.useState(""),[h,_]=l.exports.useState("all"),[g,$]=l.exports.useState(1),[N,z]=l.exports.useState(1),[o,D]=l.exports.useState({title:"",position:0,isActive:!0,category:""}),w=async()=>{var t;try{f(!0);const s=await v.get("/banners",{params:{page:g,limit:10,search:b,isActive:h==="all"?void 0:h==="active"}});s.data.success&&(n(s.data.data.banners||[]),z(((t=s.data.data.pagination)==null?void 0:t.totalPages)||1))}catch(s){console.error("Error fetching banners:",s)}finally{f(!1)}};l.exports.useEffect(()=>{w()},[g,b,h]);const S=t=>{const{name:s,value:c,type:m,checked:C}=t.target;D(r=>({...r,[s]:m==="checkbox"?C:c}))},W=t=>{var m;const s=(m=t.target.files)==null?void 0:m[0];if(!s)return;if(!s.type.startsWith("image/")){alert("Please select a valid image file");return}if(s.size>8*1024*1024){alert("Image size should be less than 8MB");return}P(s);const c=URL.createObjectURL(s);I(c)},G=async t=>{var s,c,m,C;if(t.preventDefault(),!k){alert("Please choose an image");return}T(!0);try{const r=new FormData;r.append("image",k);const O=await v.post("/images/upload",r,{headers:{"Content-Type":"multipart/form-data"}});if(!((s=O.data)!=null&&s.success))throw new Error("Image upload failed");const u=O.data.data,Y={title:o.title,position:Number(o.position)||0,isActive:!!o.isActive,category:o.category||void 0,imageUrl:u.url,publicId:u.public_id,imageWidth:u.width,imageHeight:u.height,imageFormat:u.format,imageBytes:u.bytes};if(!((c=(await v.post("/banners",Y)).data)!=null&&c.success))throw new Error("Banner save failed");A(),y(!1),await w()}catch(r){console.error("Error saving banner:",r),alert(((C=(m=r==null?void 0:r.response)==null?void 0:m.data)==null?void 0:C.message)||r.message||"Failed to save")}finally{T(!1)}},A=()=>{D({title:"",position:0,isActive:!0}),I(null),P(null),L(null)},M=()=>{A(),y(!0)},H=async t=>{if(!!window.confirm("Are you sure you want to delete this banner?"))try{(await v.delete(`/banners/${t}`)).data.success&&w()}catch(s){console.error("Error deleting banner:",s),alert("Failed to delete banner")}},V=async(t,s)=>{try{(await v.patch(`/banners/${t}/toggle`)).data.success&&w()}catch(c){console.error("Error toggling banner status:",c),alert("Failed to update banner status")}};return p?e("div",{className:"flex items-center justify-center h-64",children:"Loading..."}):a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900",children:"Banner Management"}),e("p",{className:"text-gray-600",children:"Manage your website banners and promotional content"})]}),a(d,{onClick:M,className:"bg-blue-600 text-white hover:bg-blue-700",children:[e(j,{icon:"heroicons:plus",className:"w-5 h-5 mr-2"}),"Add New Banner"]})]}),e(B,{className:"p-6",children:e("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a(R,{value:h,onChange:t=>_(t.target.value),children:[e("option",{value:"all",children:"All Banners"}),e("option",{value:"active",children:"Active Only"}),e("option",{value:"inactive",children:"Inactive Only"})]})]})})}),x&&a("div",{className:"p-4 border rounded space-y-3",children:[a("div",{className:"flex items-center justify-between",children:[e("h2",{className:"font-medium",children:"Create New Banner"}),e("button",{className:"text-sm",onClick:()=>y(!1),children:"Close"})]}),a("form",{onSubmit:G,className:"space-y-3",children:[a("div",{children:[e("label",{className:"block text-sm mb-1",children:"Title (optional)"}),e(U,{name:"title",value:o.title,onChange:S,placeholder:"Banner title"})]}),a("div",{children:[e("label",{className:"block text-sm mb-1",children:"Position"}),e(U,{type:"number",name:"position",value:o.position,onChange:S})]}),a("div",{children:[e("label",{className:"block text-sm mb-1",children:"Category"}),a(R,{name:"category",value:o.category,onChange:S,children:[e("option",{value:"",children:"Select category"}),e("option",{value:"main",children:"Main"}),e("option",{value:"top-collections",children:"Top collections"}),e("option",{value:"ecommerce",children:"Ecommerce"}),e("option",{value:"offer&deals",children:"Offer & Deals"})]})]}),a("div",{className:"flex items-center gap-2",children:[e(q,{name:"isActive",checked:o.isActive,onChange:S}),e("span",{className:"text-sm",children:"Active"})]}),a("div",{children:[e("input",{type:"file",accept:"image/*",onChange:W}),F&&e("img",{src:F,alt:"preview",className:"mt-3 h-40 object-cover rounded"})]}),a("div",{className:"flex justify-end gap-2",children:[e(d,{type:"button",onClick:()=>{A(),y(!1)},children:"Cancel"}),e(d,{type:"submit",className:"bg-blue-600 text-white",disabled:E||!k,children:E?"Saving...":"Save Banner"})]})]})]}),i.length===0?a(B,{className:"p-8 text-center",children:[e(j,{icon:"heroicons:photo",className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Banners Found"}),e("p",{className:"text-gray-600 mb-4",children:b||h!=="all"?"No banners match your current filters.":"Get started by creating your first banner."}),!b&&h==="all"&&a(d,{onClick:M,className:"bg-blue-600 hover:bg-blue-700",children:[e(j,{icon:"heroicons:plus",className:"w-5 h-5 mr-2"}),"Create Your First Banner"]})]}):e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(t=>a(B,{className:"overflow-hidden",children:[a("div",{className:"relative",children:[e("img",{src:t.imageUrl,alt:t.title,className:"w-full h-48 object-cover"}),e("div",{className:"absolute top-2 right-2",children:e("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})})]}),a("div",{className:"p-4",children:[e("h3",{className:"font-semibold text-lg text-gray-900 mb-2",children:t.title}),t.description&&e("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:t.description}),a("div",{className:"space-y-2 text-sm text-gray-500",children:[a("div",{className:"flex justify-between",children:[e("span",{children:"Position:"}),e("span",{children:t.position})]}),a("div",{className:"flex justify-between",children:[e("span",{children:"Target:"}),e("span",{className:"capitalize",children:t.targetAudience})]}),t.category&&a("div",{className:"flex justify-between",children:[e("span",{children:"Category:"}),e("span",{children:t.category})]}),a("div",{className:"flex justify-between",children:[e("span",{children:"Views:"}),e("span",{children:t.views||0})]}),a("div",{className:"flex justify-between",children:[e("span",{children:"Clicks:"}),e("span",{children:t.clicks||0})]})]}),a("div",{className:"flex gap-2 mt-4",children:[e(d,{onClick:()=>V(t._id,t.isActive),children:t.isActive?"Set Inactive":"Set Active"}),e(d,{onClick:()=>H(t._id),className:"text-red-600",children:"Delete"})]})]})]},t._id))}),N>1&&a("div",{className:"flex justify-center space-x-2",children:[e(d,{variant:"outline",onClick:()=>$(t=>Math.max(1,t-1)),disabled:g===1,children:"Previous"}),a("span",{className:"flex items-center px-4 py-2 text-sm text-gray-700",children:["Page ",g," of ",N]}),e(d,{variant:"outline",onClick:()=>$(t=>Math.min(N,t+1)),disabled:g===N,children:"Next"})]})]})};export{ee as default};
