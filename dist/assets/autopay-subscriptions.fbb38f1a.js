import{d as v,b as w,r as b,c as a,j as e,B as x,I as s,C as A,L as E,F as S}from"./index.575d0a96.js";import{B as f}from"./Badge.c3078f5c.js";const D=v.injectEndpoints({endpoints:g=>({getAllSubscriptionsAdmin:g.query({query:({page:r=1,limit:n=20,status:d,search:i,userId:c}={})=>{const l=new URLSearchParams;return r&&l.append("page",r),n&&l.append("limit",n),d&&l.append("status",d),i&&l.append("search",i),c&&l.append("userId",c),`/autopay/admin/subscriptions?${l.toString()}`},providesTags:["Autopay"]})})}),{useGetAllSubscriptionsAdminQuery:I}=D,P=()=>{var l,o,m;const g=w(),[r,n]=b.exports.useState({page:1,limit:20,status:"",search:""}),{data:d,isLoading:i,refetch:c}=I(r);return a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Autopay Subscriptions"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"View and manage all autopay subscriptions"})]}),a(x,{onClick:()=>g("/dashboard"),className:"btn btn-outline",children:[e(s,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Dashboard"]})]}),a(A,{title:"All Subscriptions",children:[a("div",{className:"mb-6 flex flex-wrap gap-4",children:[e("div",{className:"flex-1 min-w-[200px]",children:e("input",{type:"text",placeholder:"Search by subscription ID, order ID, VPA...",value:r.search,onChange:t=>n({...r,search:t.target.value,page:1}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})}),e("div",{className:"min-w-[150px]",children:a("select",{value:r.status,onChange:t=>n({...r,status:t.target.value,page:1}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"All Status"}),e("option",{value:"PENDING",children:"Pending"}),e("option",{value:"ACTIVE",children:"Active"}),e("option",{value:"PAUSED",children:"Paused"}),e("option",{value:"REVOKED",children:"Revoked"}),e("option",{value:"EXPIRED",children:"Expired"}),e("option",{value:"FAILED",children:"Failed"}),e("option",{value:"CANCELLED",children:"Cancelled"})]})}),a(x,{onClick:()=>c(),className:"btn btn-outline",children:[e(s,{icon:"ph:arrow-clockwise",className:"mr-2"}),"Refresh"]})]}),i?a("div",{className:"flex justify-center items-center py-12",children:[e(E,{}),e("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading subscriptions..."})]}):((o=(l=d==null?void 0:d.data)==null?void 0:l.subscriptions)==null?void 0:o.length)>0?a(S,{children:[e("div",{className:"overflow-x-auto",children:a("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e("thead",{className:"bg-gray-50 dark:bg-slate-800",children:a("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"User"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Subscription ID"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Amount"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Frequency"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"VPA"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Redemptions"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Created"})]})}),e("tbody",{className:"bg-white dark:bg-slate-900 divide-y divide-gray-200 dark:divide-gray-700",children:d.data.subscriptions.map(t=>{var p,h,y,u,N,k;return a("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800",children:[a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((p=t.userId)==null?void 0:p.name)||"N/A"}),e("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:((h=t.userId)==null?void 0:h.email)||"N/A"}),((y=t.userId)==null?void 0:y.phone)&&e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.userId.phone})]}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-mono text-gray-900 dark:text-white",children:t.merchantSubscriptionId}),t.merchantOrderId&&a("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Order: ",t.merchantOrderId]})]}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[a("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["\u20B9",((u=t.amount)==null?void 0:u.toLocaleString())||0]}),t.maxAmount&&a("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Max: \u20B9",t.maxAmount.toLocaleString()]}),t.amountType&&e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.amountType})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e(f,{className:`${t.frequency==="MONTHLY"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":t.frequency==="WEEKLY"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":t.frequency==="DAILY"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":t.frequency==="ON_DEMAND"?"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:t.frequency||"ON_DEMAND"})}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e(f,{className:`${t.status==="ACTIVE"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":t.status==="PAUSED"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":t.status==="REVOKED"||t.status==="CANCELLED"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":t.status==="EXPIRED"?"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200":t.status==="PENDING"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":t.status==="FAILED"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:t.status||"PENDING"}),t.failureReason&&e("div",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:t.failureReason})]}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm text-gray-900 dark:text-white",children:((N=t.metadata)==null?void 0:N.vpa)||"N/A"}),((k=t.metadata)==null?void 0:k.paymentMode)&&e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.metadata.paymentMode})]}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[a("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.redemptionCount||0," ",t.redemptionCount===1?"time":"times"]}),t.totalRedemptionAmount>0&&a("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Total: \u20B9",t.totalRedemptionAmount.toLocaleString()]}),t.lastRedemptionAt&&a("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last: ",new Date(t.lastRedemptionAt).toLocaleDateString()]})]}),a("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e("div",{children:new Date(t.createdAt).toLocaleDateString()}),e("div",{className:"text-xs",children:new Date(t.createdAt).toLocaleTimeString()}),t.expiresAt&&a("div",{className:"text-xs mt-1",children:["Expires: ",new Date(t.expiresAt).toLocaleDateString()]})]})]},t._id)})})]})}),((m=d==null?void 0:d.data)==null?void 0:m.pagination)&&d.data.pagination.totalPages>1&&a("div",{className:"mt-6 flex items-center justify-between",children:[a("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing ",(r.page-1)*r.limit+1," to"," ",Math.min(r.page*r.limit,d.data.pagination.totalCount)," of"," ",d.data.pagination.totalCount," subscriptions"]}),a("div",{className:"flex gap-2",children:[a(x,{onClick:()=>n({...r,page:r.page-1}),disabled:!d.data.pagination.hasPrevPage,className:"btn btn-outline btn-sm",children:[e(s,{icon:"ph:caret-left",className:"mr-1"}),"Previous"]}),a("span",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300",children:["Page ",r.page," of ",d.data.pagination.totalPages]}),a(x,{onClick:()=>n({...r,page:r.page+1}),disabled:!d.data.pagination.hasNextPage,className:"btn btn-outline btn-sm",children:["Next",e(s,{icon:"ph:caret-right",className:"ml-1"})]})]})]})]}):a("div",{className:"text-center py-12",children:[e(s,{icon:"ph:inbox",className:"text-4xl text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e("p",{className:"text-gray-600 dark:text-gray-400 text-lg mb-2",children:"No subscriptions found"}),e("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:r.search||r.status?"Try adjusting your filters":"No autopay subscriptions have been created yet"})]})]})]})};export{P as default};
