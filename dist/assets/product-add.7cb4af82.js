import{b as De,a1 as Ae,r as M,R as de,c as t,j as e,L as Pe,I as w,B as T,C as ue,F as me,Q as G}from"./index.ce738da1.js";import{c as Fe,d as Ie,e as Se,a as Le}from"./productApi.0617a2ca.js";import{u as Te,a as Me}from"./imageApi.7faabe19.js";import{u as Re}from"./utilsApi.50fbc768.js";const je=({detail:A,index:$,onUpdateDetail:C,onRemove:a})=>{const[p,V]=M.exports.useState(""),[E,U]=M.exports.useState(""),z=x=>{C({...A,type:x})},W=(x,R)=>{const O={...A.attributes,[x]:R};C({...A,attributes:O})},Z=()=>{if(p.trim()){const x={...A.attributes,[p]:E};C({...A,attributes:x}),V(""),U("")}},J=x=>{const R={...A.attributes};delete R[x],C({...A,attributes:R})};return t("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[t("div",{className:"mb-4",children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type (e.g., Metal, Stone)"}),e("input",{type:"text",value:A.type,onChange:x=>z(x.target.value),placeholder:"e.g., Metal, Stone",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{className:"mb-4",children:[t("div",{className:"flex justify-between items-center mb-2",children:[e("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Attributes"}),t("span",{className:"text-xs text-gray-500",children:[Object.keys(A.attributes||{}).length," attributes"]})]}),e("div",{className:"space-y-2 mb-3",children:Object.entries(A.attributes||{}).map(([x,R])=>t("div",{className:"flex gap-2 items-center bg-gray-50 dark:bg-slate-800 p-2 rounded",children:[e("input",{type:"text",value:x,readOnly:!0,className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-gray-100 dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:R,onChange:O=>W(x,O.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("button",{type:"button",onClick:()=>J(x),className:"text-red-500 hover:text-red-700 p-1",children:e(w,{icon:"ph:x"})})]},x))}),t("div",{className:"flex gap-2",children:[e("input",{type:"text",value:p,onChange:x=>V(x.target.value),placeholder:"Attribute name (e.g., karatage, name)",className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:E,onChange:x=>U(x.target.value),placeholder:"Value",className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("button",{type:"button",onClick:Z,className:"px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600",children:e(w,{icon:"ph:plus"})})]})]}),e("div",{className:"flex justify-end",children:t(T,{type:"button",onClick:a,className:"btn btn-sm btn-outline-danger",children:[e(w,{icon:"ph:trash",className:"mr-2"}),"Remove Detail"]})})]})},$e=()=>{var ne;const A=De(),{id:$}=Ae(),C=!!$,[a,p]=M.exports.useState({name:"",brand:"",description:"",active:!0,stock:0,CurrentlyNotavaiable:!1,categories:"",popular:!1,trending:!1,categoryId:"",skuId:"",rating:{value:0,count:0},selectedCaret:"",metalType:"gold",productDetails:[],priceDetails:[],subtotal:{weight:""},Discount:0,isDiscountAvaiable:!1,gst:0,images:[],isReturnAllowed:!0,isReplacementAllowed:!0,returnReplacementDays:5}),[V,E]=M.exports.useState([]),[U,z]=M.exports.useState(!1),W=M.exports.useRef(!1),[Z,{isLoading:J}]=Fe(),[x,{isLoading:R}]=Ie(),[O,{isLoading:Ge}]=Te(),[ge]=Me(),{data:v,isLoading:ee,error:_}=Se($,{skip:!C}),{data:I}=Le(),{data:te}=Re(),se=de.useMemo(()=>{if(!I)return[];if(I.data){if(Array.isArray(I.data.categories))return I.data.categories;if(Array.isArray(I.data))return I.data}return Array.isArray(I.categories)?I.categories:Array.isArray(I)?I:[]},[I]),h=te==null?void 0:te.data,Q=(h==null?void 0:h.goldPrice24kt)||(h==null?void 0:h.goldPrice)||0,ae=(h==null?void 0:h.goldPrice22kt)||0,re=(h==null?void 0:h.goldPrice18kt)||0,H=(h==null?void 0:h.silverPrice)||0,le=(h==null?void 0:h.silverRate925)||0,m=de.useMemo(()=>v?(v==null?void 0:v.products)&&Array.isArray(v.products)?v.products[0]:v!=null&&v.product?v.product:v!=null&&v.data?v.data:v&&typeof v=="object"?v:null:null,[v]);M.exports.useEffect(()=>{C&&console.log("Edit Mode Debug:",{id:$,isLoadingProduct:ee,productError:_,productResponse:v,extractedProduct:m})},[C,$,ee,_,v,m]),M.exports.useEffect(()=>{var n,r;C&&m&&(console.log("Prefilling form with product data:",m),p({name:m.name||"",brand:m.brand||"",description:m.description||"",active:(n=m.active)!=null?n:!0,stock:m.stock||0,CurrentlyNotavaiable:m.CurrentlyNotavaiable||!1,categories:m.categories||"",popular:m.popular||!1,trending:m.trending||!1,categoryId:m.categoryId||"",skuId:m.skuId||"",rating:m.rating||{value:0,count:0},selectedCaret:m.selectedCaret||"",metalType:m.metalType||((r=m.selectedCaret)!=null&&r.toLowerCase().includes("silver")?"silver":"gold"),productDetails:m.productDetails||[],priceDetails:(m.priceDetails||[]).map(l=>({name:l.name||"",weight:l.weight||"",value:typeof l.value=="number"?l.value:parseFloat(l.value||0)})),subtotal:m.subtotal||{weight:""},Discount:m.Discount||0,isDiscountAvaiable:m.isDiscountAvaiable||!1,gst:m.gst||0,images:m.images||[],isReturnAllowed:m.isReturnAllowed!==void 0?m.isReturnAllowed:!0,isReplacementAllowed:m.isReplacementAllowed!==void 0?m.isReplacementAllowed:!0,returnReplacementDays:m.returnReplacementDays!==void 0?m.returnReplacementDays:5}),E(m.images||[]))},[C,m]);const k=n=>{const{name:r,value:l,type:i,checked:s}=n.target;if(r.includes(".")){const[o,d]=r.split(".");p(u=>({...u,[o]:{...u[o],[d]:l}}))}else p(o=>{const d={...o,[r]:i==="checkbox"?s:l};return r==="metalType"&&(d.selectedCaret=""),d})},pe=async n=>{const r=Array.from(n.target.files);if(r.length===0)return;const l=5*1024*1024,i=r.filter(s=>s.size>l);if(i.length>0){G.error(`Some files exceed 5MB limit: ${i.map(s=>s.name).join(", ")}`),n.target.value="";return}console.log("Files selected:",r.length,r),z(!0);try{try{const s=new FormData;r.forEach((u,c)=>{s.append("images",u)}),console.log("FormData entries:");for(let[u,c]of s.entries())console.log(u,c);const o=await O(s).unwrap();console.log("Multiple upload response:",o);let d=[];if(o.urls&&Array.isArray(o.urls))d=o.urls;else if(o.data&&Array.isArray(o.data))d=o.data;else if(o.images&&Array.isArray(o.images))d=o.images;else if(Array.isArray(o))d=o;else if(o.url)d=[o.url];else throw new Error("Unexpected response format from multiple upload");if(d.length>0){const u=d.map(c=>typeof c=="string"?c:c&&c.url?c.url:c);E(c=>[...c,...u]),p(c=>({...c,images:[...c.images,...u]})),G.success(`${u.length} file(s) uploaded successfully`);return}}catch(s){console.log("Multiple upload failed, trying single uploads:",s);const o=[];for(const d of r)try{const u=new FormData;u.append("image",d);const c=await ge(u).unwrap();console.log("Single upload response:",c),c.url?o.push(c.url):c.data&&c.data.url?o.push(c.data.url):c.imageUrl?o.push(c.imageUrl):c.data&&typeof c.data=="string"&&o.push(c.data)}catch(u){console.error(`Failed to upload ${d.name}:`,u),G.error(`Failed to upload ${d.name}`)}o.length>0?(E(d=>[...d,...o]),p(d=>({...d,images:[...d.images,...o]})),G.success(`${o.length} file(s) uploaded successfully`)):G.error("Failed to upload any files")}}catch(s){G.error("Failed to upload files"),console.error("Upload error:",s)}finally{z(!1)}},be=n=>{E(r=>r.filter((l,i)=>i!==n)),p(r=>({...r,images:r.images.filter((l,i)=>i!==n)}))},he=()=>{p(n=>({...n,productDetails:[...n.productDetails,{type:"",attributes:{}}]}))},fe=n=>{p(r=>({...r,productDetails:r.productDetails.filter((l,i)=>i!==n)}))},ye=()=>{p(n=>({...n,priceDetails:[...n.priceDetails,{name:"",weight:"",value:""}]}))},xe=n=>{p(r=>({...r,priceDetails:r.priceDetails.filter((l,i)=>i!==n)}))},ve=(n,r,l)=>{if(!l||l==="")return 0;const i=parseFloat(l.toString().replace(/[^\d.]/g,""))||0;if(i===0)return 0;if(n==="gold"){let s=0;return r==="24K"?s=Q:r==="22K"?s=ae||Q*.916:r==="18K"&&(s=re||Q*.75),s*i}else if(n==="silver"){let s=0;return r==="Pure Silver 999"?s=H:r==="Silver 925"&&(s=le||H*.925),s*i}return 0},K=M.exports.useCallback(n=>{var oe,ce;if(!n.metalType||!n.selectedCaret||!h||W.current)return null;W.current=!0;const r=n.priceDetails.map(y=>({name:y.name||"",weight:y.weight||"",value:typeof y.value=="number"?y.value:parseFloat(y.value||0)}));let l=-1,i=null;const s=n.metalType==="gold"?"Gold":"Silver";if(l=r.findIndex(y=>{var L;return(L=y.name)==null?void 0:L.toLowerCase().includes(s.toLowerCase())}),l===-1&&(r.push({name:s,weight:"",value:0}),l=r.length-1),i={name:r[l].name||s,weight:r[l].weight||"",value:typeof r[l].value=="number"?r[l].value:parseFloat(r[l].value||0)},(oe=i.name)!=null&&oe.toLowerCase().includes(s.toLowerCase())||(i.name=s),i.weight){const y=ve(n.metalType,n.selectedCaret,i.weight);i.value=parseFloat(y.toFixed(2))}else i.value=parseFloat(i.value||0);r[l]=i;let o=0;r.forEach((y,L)=>{var P;if(L!==l){const j=((P=y.name)==null?void 0:P.toLowerCase())||"";(j.includes("stone")||j.includes("diamond")||j.includes("ruby")||j.includes("emerald")||j.includes("sapphire")||j.includes("pearl"))&&(o+=parseFloat(y.value||0))}});const d=parseFloat(i.value||0);let u=r.findIndex(y=>{var L;return(L=y.name)==null?void 0:L.toLowerCase().includes("making charges")}),c=0;if(u>=0){const y=((ce=r[u].weight)==null?void 0:ce.toString())||"";c=parseFloat(y.replace(/[^\d.]/g,""))||0}const D=d+o,b=D*c/100,N=D+b,F=n.Discount||0,B=N*F/100,f=N-B,g=n.gst||0,S=f*g/100,X=f+S,Ne=["sub total","subtotal","discount","gst","grand total","final price","total"],Y=r.filter((y,L)=>{var j;if(L===l)return!0;const P=((j=y.name)==null?void 0:j.toLowerCase())||"";return P.includes("making charges")||P.includes("stone")||P.includes("diamond")||P.includes("ruby")||P.includes("emerald")||P.includes("sapphire")||P.includes("pearl")?!0:!Ne.some(Ce=>P.includes(Ce))});if(u>=0){const y=Y.findIndex(L=>{var P;return(P=L.name)==null?void 0:P.toLowerCase().includes("making charges")});y>=0&&(Y[y].value=parseFloat(b.toFixed(2)))}else c>0&&Y.push({name:"Making Charges",weight:`${c}%`,value:parseFloat(b.toFixed(2))});const q=[...Y],ie=(i.weight||"").toString().replace(/[^\d.]/g,""),we=ie?`${ie}g Gross Wt.`:"Gross Wt.";return q.push({name:"Sub Total",weight:we,value:parseFloat(N.toFixed(2))}),F>0&&q.push({name:"Discount",weight:`${F}%`,value:parseFloat(B.toFixed(2))}),q.push({name:"Sub Total After Discount",weight:"After discount",value:parseFloat(f.toFixed(2))}),q.push({name:"GST",weight:`${g}%`,value:parseFloat(S.toFixed(2))}),q.push({name:"Grand Total",weight:"Final Price",value:parseFloat(X.toFixed(2))}),W.current=!1,q},[a.metalType,a.selectedCaret,a.Discount,a.gst,Q,ae,re,H,le,h]);M.exports.useEffect(()=>{if(!h||W.current)return;if((a.Discount>0||a.gst>0)&&(!a.metalType||!a.selectedCaret)){const r=a.priceDetails.find(l=>{var i,s;return((i=l.name)==null?void 0:i.toLowerCase().includes("sub total"))&&!((s=l.name)!=null&&s.toLowerCase().includes("after"))});if(r){const l=parseFloat(r.value||0),i=a.Discount||0,s=l*i/100,o=l-s,d=a.gst||0,u=o*d/100,c=o+u,D=a.priceDetails.map(b=>{var F;const N=((F=b.name)==null?void 0:F.toLowerCase())||"";return N.includes("discount")?{...b,weight:`${i}%`,value:parseFloat(s.toFixed(2))}:N.includes("sub total after discount")?{...b,value:parseFloat(o.toFixed(2))}:N.includes("gst")&&!N.includes("cgst")&&!N.includes("sgst")?{...b,weight:`${d}%`,value:parseFloat(u.toFixed(2))}:N.includes("grand total")?{...b,value:parseFloat(c.toFixed(2))}:b});if(!D.find(b=>{var N;return(N=b.name)==null?void 0:N.toLowerCase().includes("discount")})&&i>0){const b=D.findIndex(N=>{var F,B;return((F=N.name)==null?void 0:F.toLowerCase().includes("sub total"))&&!((B=N.name)!=null&&B.toLowerCase().includes("after"))});b>=0&&D.splice(b+1,0,{name:"Discount",weight:`${i}%`,value:parseFloat(s.toFixed(2))})}p(b=>({...b,priceDetails:D}));return}}if(!a.metalType||!a.selectedCaret)return;const n=K(a);if(n){const r=a.metalType==="gold"?"Gold":"Silver",l=a.priceDetails.find(s=>{var o;return(o=s.name)==null?void 0:o.toLowerCase().includes(r.toLowerCase())});((l==null?void 0:l.weight)||n.length!==a.priceDetails.length||a.Discount>0||a.gst>0)&&p(s=>({...s,priceDetails:n}))}},[a.metalType,a.selectedCaret,a.Discount,a.gst,Q,ae,re,H,le,h,K]);const ke=async n=>{var r;n.preventDefault();try{const l={...a,stock:parseInt(a.stock)||0,rating:{value:parseFloat(a.rating.value)||0,count:parseInt(a.rating.count)||0},subtotal:{weight:a.subtotal.weight},Discount:parseFloat(a.Discount)||0,gst:parseFloat(a.gst)||0};console.log("Submitting product data:",l),console.log("Images array:",l.images),l.images=l.images.map(i=>typeof i=="string"?i:i&&i.url?i.url:String(i)),console.log("Processed images:",l.images),C?(await x({id:$,...l}).unwrap(),G.success("Product updated successfully")):(await Z(l).unwrap(),G.success("Product added successfully")),A("/products")}catch(l){console.log("Submit error:",l),G.error(((r=l.data)==null?void 0:r.message)||"Failed to save product")}};return C&&ee?t("div",{className:"flex justify-center items-center h-64",children:[e(Pe,{}),e("p",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading product..."})]}):C&&_?t("div",{className:"flex flex-col justify-center items-center h-64",children:[e(w,{icon:"ph:warning-circle",className:"text-4xl text-red-500 mb-4"}),e("p",{className:"text-red-500 text-lg mb-2",children:"Failed to load product"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:((ne=_==null?void 0:_.data)==null?void 0:ne.message)||"Product not found"}),t(T,{onClick:()=>A("/products"),className:"btn btn-outline",children:[e(w,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}):C&&!m?t("div",{className:"flex flex-col justify-center items-center h-64",children:[e(w,{icon:"ph:magnifying-glass",className:"text-4xl text-gray-400 mb-4"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Product not found"}),t(T,{onClick:()=>A("/products"),className:"btn btn-outline",children:[e(w,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}):t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:C?"Edit Product":"Add New Product"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:C?"Update product information":"Create a new product"})]}),t(T,{onClick:()=>A("/products"),className:"btn btn-outline",children:[e(w,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e("div",{className:"lg:col-span-2",children:e(ue,{title:"Product Information",children:t("form",{onSubmit:ke,className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Product Name *"}),e("input",{type:"text",name:"name",value:a.name,onChange:k,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Brand *"}),e("input",{type:"text",name:"brand",value:a.brand,onChange:k,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"SKU ID *"}),e("input",{type:"text",name:"skuId",value:a.skuId,onChange:k,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),t("select",{name:"categoryId",value:a.categoryId,onChange:n=>p(r=>{var l;return{...r,categoryId:n.target.value,categories:((l=se.find(i=>i._id===n.target.value))==null?void 0:l.name)||""}}),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Category Id"}),se.map(n=>e("option",{value:n._id,children:n.name},n._id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Stock *"}),e("input",{type:"number",name:"stock",value:a.stock,onChange:k,required:!0,min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),e("textarea",{name:"description",value:a.description,onChange:k,required:!0,rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"active",checked:a.active,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Active"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"CurrentlyNotavaiable",checked:a.CurrentlyNotavaiable,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Currently Not Available"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"popular",checked:a.popular,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Popular"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"trending",checked:a.trending,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Trending"})]})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rating Value"}),e("input",{type:"number",name:"rating.value",value:a.rating.value,onChange:k,min:"0",max:"5",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rating Count"}),e("input",{type:"number",name:"rating.count",value:a.rating.count,onChange:k,min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]})]}),e("div",{className:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4",children:t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"isReturnAllowed",checked:a.isReturnAllowed,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Allow Return"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"isReplacementAllowed",checked:a.isReplacementAllowed,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Allow Replacement"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Days Allowed"}),e("input",{type:"number",name:"returnReplacementDays",value:a.returnReplacementDays,onChange:k,min:"0",max:"365",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-800 dark:text-white"}),e("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Days from delivery for return/replacement"})]})]})}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Metal Type"}),t("div",{className:"flex gap-6",children:[t("label",{className:"flex items-center cursor-pointer",children:[e("input",{type:"radio",name:"metalType",value:"gold",checked:a.metalType==="gold",onChange:k,className:"h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300"}),t("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[e(w,{icon:"ph:medal",className:"text-yellow-500 mr-1"}),"Gold"]})]}),t("label",{className:"flex items-center cursor-pointer",children:[e("input",{type:"radio",name:"metalType",value:"silver",checked:a.metalType==="silver",onChange:k,className:"h-4 w-4 text-gray-400 focus:ring-gray-500 border-gray-300"}),t("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[e(w,{icon:"ph:medal",className:"text-gray-400 mr-1"}),"Silver"]})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:a.metalType==="gold"?"Gold Karat":"Silver Purity"}),a.metalType==="gold"?t("select",{name:"selectedCaret",value:a.selectedCaret,onChange:k,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Karat"}),e("option",{value:"24K",children:"24 Karat (Pure Gold - 99.9%)"}),e("option",{value:"22K",children:"22 Karat (91.67%)"}),e("option",{value:"18K",children:"18 Karat (75%)"})]}):t("select",{name:"selectedCaret",value:a.selectedCaret,onChange:k,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Purity"}),e("option",{value:"Pure Silver 999",children:"Pure Silver 999 (99.9%)"}),e("option",{value:"Silver 925",children:"Silver 925 (92.5% - Sterling Silver)"})]})]}),t("div",{children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pricing & Discount"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subtotal Weight"}),e("input",{type:"text",name:"subtotal.weight",value:a.subtotal.weight,onChange:k,placeholder:"e.g., 2.96g",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Discount (%)"}),e("input",{type:"number",name:"Discount",value:a.Discount,onChange:n=>{const r=parseFloat(n.target.value)||0;p(l=>{const i={...l,Discount:r};return setTimeout(()=>{const s=K(i);s&&p(o=>({...o,priceDetails:s}))},0),i})},min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"GST (%)"}),e("input",{type:"number",name:"gst",value:a.gst,onChange:n=>{const r=parseFloat(n.target.value)||0;p(l=>{const i={...l,gst:r};return setTimeout(()=>{const s=K(i);s&&p(o=>({...o,priceDetails:s}))},0),i})},min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]}),e("div",{className:"mt-4",children:t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"isDiscountAvaiable",checked:a.isDiscountAvaiable,onChange:k,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Discount Available"})]})})]}),t("div",{children:[t("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Product Details"}),t(T,{type:"button",onClick:he,className:"btn btn-sm btn-outline",children:[e(w,{icon:"ph:plus",className:"mr-2"}),"Add Product Detail"]})]}),e("div",{className:"space-y-4",children:a.productDetails.map((n,r)=>e(je,{detail:n,index:r,onUpdateDetail:l=>{const i=[...a.productDetails];i[r]=l,p(s=>({...s,productDetails:i}))},onRemove:()=>fe(r)},r))})]}),t("div",{children:[e("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:t("div",{className:"flex items-start",children:[e(w,{icon:"heroicons-outline:information-circle",className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-2 mt-0.5 flex-shrink-0"}),t("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e("p",{className:"font-semibold mb-2",children:"Important Notes:"}),t("ul",{className:"list-disc list-inside space-y-1",children:[t("li",{children:["Making Charges, Discount, and GST should be entered as ",e("strong",{children:"percentage (%)"})]}),t("li",{children:["For stones (Diamond, Ruby, etc.), enter weight in ",e("strong",{children:"karat"})," and amount"]}),t("li",{children:["For Gold and Silver, enter weight in ",e("strong",{children:"grams (gms)"})," and amount"]})]})]})]})}),t("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Price Details"}),t(T,{type:"button",onClick:ye,className:"btn btn-sm btn-outline",children:[e(w,{icon:"ph:plus",className:"mr-2"}),"Add Price Detail"]})]}),e("div",{className:"space-y-2",children:a.priceDetails.map((n,r)=>t("div",{className:"flex gap-2",children:[e("input",{type:"text",value:n.name,onChange:l=>{const i=a.priceDetails.map((s,o)=>o===r?{name:l.target.value,weight:s.weight||"",value:typeof s.value=="number"?s.value:parseFloat(s.value||0)}:{name:s.name||"",weight:s.weight||"",value:typeof s.value=="number"?s.value:parseFloat(s.value||0)});p(s=>{var u;const o={...s,priceDetails:i};return(((u=l.target.value)==null?void 0:u.toLowerCase())||"").includes("making charges")&&setTimeout(()=>{const c=K(o);c&&p(D=>({...D,priceDetails:c}))},0),o})},placeholder:"Name (e.g., Gold, Stone, Making Charges)",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:n.weight||"",onChange:l=>{const i=a.priceDetails.map((s,o)=>o===r?{name:s.name||"",weight:l.target.value,value:typeof s.value=="number"?s.value:parseFloat(s.value||0)}:{name:s.name||"",weight:s.weight||"",value:typeof s.value=="number"?s.value:parseFloat(s.value||0)});p(s=>{var c;const o={...s,priceDetails:i},d=((c=n.name)==null?void 0:c.toLowerCase())||"",u=s.metalType==="gold"?"Gold":"Silver";return(d.includes(u.toLowerCase())||d.includes("making charges"))&&setTimeout(()=>{const D=K(o);D&&p(b=>({...b,priceDetails:D}))},0),o})},placeholder:"Weight (e.g., 2.903g) or % for Making Charges",className:"w-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e("input",{type:"number",value:n.value||"",onChange:l=>{const i=parseFloat(l.target.value)||0,s=a.priceDetails.map((o,d)=>d===r?{name:o.name||"",weight:o.weight||"",value:i}:{name:o.name||"",weight:o.weight||"",value:typeof o.value=="number"?o.value:parseFloat(o.value||0)});p(o=>{var c;const d={...o,priceDetails:s},u=((c=n.name)==null?void 0:c.toLowerCase())||"";return(u.includes("stone")||u.includes("diamond")||u.includes("ruby")||u.includes("emerald")||u.includes("sapphire")||u.includes("pearl")||u.includes("making charges"))&&setTimeout(()=>{const D=K(d);D&&p(b=>({...b,priceDetails:D}))},0),d})},placeholder:"Value",min:"0",step:"0.01",className:"w-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e(T,{type:"button",onClick:()=>xe(r),className:"btn btn-sm btn-outline-danger",children:e(w,{icon:"ph:trash"})})]},r))}),(()=>{var c,D,b,N,F,B;const n=a.metalType==="gold"?"Gold":"Silver",r=a.priceDetails.find(f=>{var g;return(g=f.name)==null?void 0:g.toLowerCase().includes(n.toLowerCase())}),l=a.priceDetails.filter(f=>{var S;const g=((S=f.name)==null?void 0:S.toLowerCase())||"";return(g.includes("stone")||g.includes("diamond")||g.includes("ruby")||g.includes("emerald")||g.includes("sapphire")||g.includes("pearl"))&&!g.includes(n.toLowerCase())}).reduce((f,g)=>f+(parseFloat(g.value)||0),0),i=a.priceDetails.find(f=>{var g;return(g=f.name)==null?void 0:g.toLowerCase().includes("making charges")}),s=a.priceDetails.find(f=>{var g,S;return((g=f.name)==null?void 0:g.toLowerCase().includes("sub total"))&&!((S=f.name)!=null&&S.toLowerCase().includes("after"))}),o=a.priceDetails.find(f=>{var g;return(g=f.name)==null?void 0:g.toLowerCase().includes("discount")}),d=a.priceDetails.find(f=>{var g,S,X;return((g=f.name)==null?void 0:g.toLowerCase().includes("gst"))&&!((S=f.name)!=null&&S.toLowerCase().includes("cgst"))&&!((X=f.name)!=null&&X.toLowerCase().includes("sgst"))}),u=a.priceDetails.find(f=>{var g;return(g=f.name)==null?void 0:g.toLowerCase().includes("grand total")});return!r||!r.weight?null:t("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[t("h4",{className:"text-sm font-semibold text-green-800 dark:text-green-200 mb-3 flex items-center",children:[e(w,{icon:"ph:calculator",className:"mr-2"}),"Price Calculation Summary"]}),t("div",{className:"space-y-2 text-sm",children:[t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:[n," (",a.selectedCaret,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((c=r.value)==null?void 0:c.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),l>0&&t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-700 dark:text-gray-300",children:"Stones:"}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",l.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i&&i.value>0&&t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:["Making Charges (",i.weight,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((D=i.value)==null?void 0:D.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),s&&t("div",{className:"flex justify-between pt-2 border-t border-green-200 dark:border-green-700",children:[e("span",{className:"font-medium text-gray-900 dark:text-white",children:"Sub Total:"}),t("span",{className:"font-semibold text-gray-900 dark:text-white",children:["\u20B9",((b=s.value)==null?void 0:b.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),o&&o.value>0&&t("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[t("span",{children:["Discount (",o.weight,"):"]}),t("span",{className:"font-medium",children:["-\u20B9",((N=o.value)==null?void 0:N.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),d&&d.value>0&&t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:["GST (",d.weight,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((F=d.value)==null?void 0:F.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),u&&t("div",{className:"flex justify-between pt-2 border-t-2 border-green-300 dark:border-green-600",children:[e("span",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:"Grand Total:"}),t("span",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:["\u20B9",((B=u.value)==null?void 0:B.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]})]})]})})()]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e(T,{type:"button",onClick:()=>A("/products"),className:"btn btn-outline",children:"Cancel"}),e(T,{type:"submit",disabled:J||R||U,className:"btn btn-primary",children:J||R||U?t(me,{children:[e(w,{icon:"ph:spinner",className:"animate-spin mr-2"}),C?"Updating...":"Adding..."]}):t(me,{children:[e(w,{icon:"ph:check",className:"mr-2"}),C?"Update Product":"Add Product"]})})]})]})})}),e("div",{className:"lg:col-span-1",children:e(ue,{title:"Product Images",children:t("div",{className:"space-y-4",children:[t("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[e("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:pe,disabled:U,className:"hidden",id:"image-upload"}),t("label",{htmlFor:"image-upload",className:`cursor-pointer ${U?"opacity-50 cursor-not-allowed":""}`,children:[e(w,{icon:"ph:cloud-arrow-up",className:"text-4xl text-gray-400 mx-auto mb-4"}),e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:U?"Uploading...":"Click to upload images & videos"}),e("p",{className:"text-xs text-gray-500 mt-1",children:"Images (PNG, JPG, GIF, WEBP) & Videos (MP4, WEBM, MOV) up to 5MB each"})]})]}),V.length>0&&t("div",{className:"space-y-2",children:[t("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Uploaded Media (",V.length,")"]}),e("div",{className:"grid grid-cols-2 gap-2",children:V.map((n,r)=>{const l=typeof n=="string"?n:n.url||n,i=l&&(l.includes(".mp4")||l.includes(".webm")||l.includes(".mov")||l.includes("/video/")||typeof n=="object"&&n.format&&n.format.includes("video"));return t("div",{className:"relative group",children:[i?e("video",{src:l,className:"w-full h-24 object-cover rounded-lg border border-gray-200 dark:border-gray-600",controls:!0,muted:!0}):e("img",{src:l,alt:`Product ${r+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200 dark:border-gray-600"}),e(T,{onClick:()=>be(r),className:"absolute -top-2 -right-2 btn btn-sm btn-danger rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e(w,{icon:"ph:x"})})]},r)})})]}),a.name&&t("div",{className:"border-t pt-4",children:[e("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Product Preview"}),e("div",{className:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4",children:t("div",{className:"text-sm space-y-2",children:[e("p",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),e("p",{className:"text-gray-600 dark:text-gray-400",children:a.brand}),t("p",{className:"text-gray-600 dark:text-gray-400",children:["SKU: ",a.skuId]}),a.stock>0&&t("p",{className:"text-gray-600 dark:text-gray-400",children:["Stock: ",a.stock]}),a.selectedCaret&&t("p",{className:"text-gray-600 dark:text-gray-400",children:["Carat: ",a.selectedCaret]}),t("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.active&&e("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:"Active"}),a.CurrentlyNotavaiable&&e("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Not Available"}),a.popular&&e("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:"Popular"}),a.trending&&e("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Trending"}),a.isDiscountAvaiable&&a.Discount>0&&t("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:[a.Discount,"% Off"]})]})]})})]})]})})})]})]})};export{$e as default};
