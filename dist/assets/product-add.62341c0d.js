import{b as Ie,a1 as Ae,r as T,R as Se,c as t,j as e,L as Le,I as k,B as L,C as pe,F as he,Q as E}from"./index.51fda1b3.js";import{c as Te,d as Ge,e as je,a as Ue}from"./productApi.a85569aa.js";import{u as Me,a as Be}from"./imageApi.a20e96cb.js";import{u as Ee}from"./utilsApi.fe011a03.js";const Ke=({detail:F,index:_,onUpdateDetail:N,onRemove:r})=>{const[m,q]=T.exports.useState(""),[K,M]=T.exports.useState(""),R=x=>{N({...F,type:x})},V=(x,G)=>{const Q={...F.attributes,[x]:G};N({...F,attributes:Q})},Z=()=>{if(m.trim()){const x={...F.attributes,[m]:K};N({...F,attributes:x}),q(""),M("")}},z=x=>{const G={...F.attributes};delete G[x],N({...F,attributes:G})};return t("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[t("div",{className:"mb-4",children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type (e.g., Metal, Stone)"}),e("input",{type:"text",value:F.type,onChange:x=>R(x.target.value),placeholder:"e.g., Metal, Stone",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{className:"mb-4",children:[t("div",{className:"flex justify-between items-center mb-2",children:[e("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Attributes"}),t("span",{className:"text-xs text-gray-500",children:[Object.keys(F.attributes||{}).length," attributes"]})]}),e("div",{className:"space-y-2 mb-3",children:Object.entries(F.attributes||{}).map(([x,G])=>t("div",{className:"flex gap-2 items-center bg-gray-50 dark:bg-slate-800 p-2 rounded",children:[e("input",{type:"text",value:x,readOnly:!0,className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-gray-100 dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:G,onChange:Q=>V(x,Q.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("button",{type:"button",onClick:()=>z(x),className:"text-red-500 hover:text-red-700 p-1",children:e(k,{icon:"ph:x"})})]},x))}),t("div",{className:"flex gap-2",children:[e("input",{type:"text",value:m,onChange:x=>q(x.target.value),placeholder:"Attribute name (e.g., karatage, name)",className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:K,onChange:x=>M(x.target.value),placeholder:"Value",className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("button",{type:"button",onClick:Z,className:"px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600",children:e(k,{icon:"ph:plus"})})]})]}),e("div",{className:"flex justify-end",children:t(L,{type:"button",onClick:r,className:"btn btn-sm btn-outline-danger",children:[e(k,{icon:"ph:trash",className:"mr-2"}),"Remove Detail"]})})]})},Oe=()=>{var ne,ie,oe,ce,de;const F=Ie(),{id:_}=Ae(),N=!!_,[r,m]=T.exports.useState({name:"",brand:"",description:"",active:!0,stock:0,CurrentlyNotavaiable:!1,categories:"",popular:!1,trending:!1,categoryId:"",skuId:"",rating:{value:0,count:0},selectedCaret:"",metalType:"gold",productDetails:[],priceDetails:[],subtotal:{weight:""},Discount:0,isDiscountAvaiable:!1,gst:0,images:[]}),[q,K]=T.exports.useState([]),[M,R]=T.exports.useState(!1),V=T.exports.useRef(!1),[Z,{isLoading:z}]=Te(),[x,{isLoading:G}]=Ge(),[Q,{isLoading:$e}]=Me(),[be]=Be(),{data:y,isLoading:ee,error:W}=je(_,{skip:!N}),{data:j}=Ue(),{data:te}=Ee(),ae=(ce=(oe=(ie=(ne=j==null?void 0:j.data)==null?void 0:ne.categories)!=null?ie:j==null?void 0:j.categories)!=null?oe:j==null?void 0:j.data)!=null?ce:[],h=te==null?void 0:te.data,J=(h==null?void 0:h.goldPrice24kt)||(h==null?void 0:h.goldPrice)||0,re=(h==null?void 0:h.goldPrice22kt)||0,le=(h==null?void 0:h.goldPrice18kt)||0,H=(h==null?void 0:h.silverPrice)||0,se=(h==null?void 0:h.silverRate925)||0,u=Se.useMemo(()=>y?(y==null?void 0:y.products)&&Array.isArray(y.products)?y.products[0]:y!=null&&y.product?y.product:y!=null&&y.data?y.data:y&&typeof y=="object"?y:null:null,[y]);T.exports.useEffect(()=>{N&&console.log("Edit Mode Debug:",{id:_,isLoadingProduct:ee,productError:W,productResponse:y,extractedProduct:u})},[N,_,ee,W,y,u]),T.exports.useEffect(()=>{var i,s;N&&u&&(console.log("Prefilling form with product data:",u),m({name:u.name||"",brand:u.brand||"",description:u.description||"",active:(i=u.active)!=null?i:!0,stock:u.stock||0,CurrentlyNotavaiable:u.CurrentlyNotavaiable||!1,categories:u.categories||"",popular:u.popular||!1,trending:u.trending||!1,categoryId:u.categoryId||"",skuId:u.skuId||"",rating:u.rating||{value:0,count:0},selectedCaret:u.selectedCaret||"",metalType:u.metalType||((s=u.selectedCaret)!=null&&s.toLowerCase().includes("silver")?"silver":"gold"),productDetails:u.productDetails||[],priceDetails:(u.priceDetails||[]).map(n=>({name:n.name||"",weight:n.weight||"",value:typeof n.value=="number"?n.value:parseFloat(n.value||0)})),subtotal:u.subtotal||{weight:""},Discount:u.Discount||0,isDiscountAvaiable:u.isDiscountAvaiable||!1,gst:u.gst||0,images:u.images||[]}),K(u.images||[]))},[N,u]);const w=i=>{const{name:s,value:n,type:a,checked:l}=i.target;if(s.includes(".")){const[o,c]=s.split(".");m(g=>({...g,[o]:{...g[o],[c]:n}}))}else m(o=>{const c={...o,[s]:a==="checkbox"?l:n};return s==="metalType"&&(c.selectedCaret=""),c})},fe=async i=>{const s=Array.from(i.target.files);if(s.length!==0){console.log("Files selected:",s.length,s),R(!0);try{try{const n=new FormData;s.forEach((o,c)=>{n.append("images",o)}),console.log("FormData entries:");for(let[o,c]of n.entries())console.log(o,c);const a=await Q(n).unwrap();console.log("Multiple upload response:",a);let l=[];if(a.urls&&Array.isArray(a.urls))l=a.urls;else if(a.data&&Array.isArray(a.data))l=a.data;else if(a.images&&Array.isArray(a.images))l=a.images;else if(Array.isArray(a))l=a;else if(a.url)l=[a.url];else throw new Error("Unexpected response format from multiple upload");if(l.length>0){const o=l.map(c=>typeof c=="string"?c:c&&c.url?c.url:c);K(c=>[...c,...o]),m(c=>({...c,images:[...c.images,...o]})),E.success(`${o.length} image(s) uploaded successfully`);return}}catch(n){console.log("Multiple upload failed, trying single uploads:",n);const a=[];for(const l of s)try{const o=new FormData;o.append("image",l);const c=await be(o).unwrap();console.log("Single upload response:",c),c.url?a.push(c.url):c.data&&c.data.url?a.push(c.data.url):c.imageUrl?a.push(c.imageUrl):c.data&&typeof c.data=="string"&&a.push(c.data)}catch(o){console.error(`Failed to upload ${l.name}:`,o),E.error(`Failed to upload ${l.name}`)}a.length>0?(K(l=>[...l,...a]),m(l=>({...l,images:[...l.images,...a]})),E.success(`${a.length} image(s) uploaded successfully`)):E.error("Failed to upload any images")}}catch(n){E.error("Failed to upload images"),console.error("Upload error:",n)}finally{R(!1)}}},xe=i=>{K(s=>s.filter((n,a)=>a!==i)),m(s=>({...s,images:s.images.filter((n,a)=>a!==i)}))},ye=()=>{m(i=>({...i,productDetails:[...i.productDetails,{type:"",attributes:{}}]}))},ve=i=>{m(s=>({...s,productDetails:s.productDetails.filter((n,a)=>a!==i)}))},ke=()=>{m(i=>({...i,priceDetails:[...i.priceDetails,{name:"",weight:"",value:""}]}))},Ne=i=>{m(s=>({...s,priceDetails:s.priceDetails.filter((n,a)=>a!==i)}))},we=(i,s,n)=>{if(!n||n==="")return 0;const a=parseFloat(n.toString().replace(/[^\d.]/g,""))||0;if(a===0)return 0;if(i==="gold"){let l=0;return s==="24K"?l=J:s==="22K"?l=re||J*.916:s==="18K"&&(l=le||J*.75),l*a}else if(i==="silver"){let l=0;return s==="Pure Silver 999"?l=H:s==="Silver 925"&&(l=se||H*.925),l*a}return 0},$=T.exports.useCallback(i=>{var me,ge;if(!i.metalType||!i.selectedCaret||!h||V.current)return null;V.current=!0;const s=i.priceDetails.map(f=>({name:f.name||"",weight:f.weight||"",value:typeof f.value=="number"?f.value:parseFloat(f.value||0)}));let n=-1,a=null;const l=i.metalType==="gold"?"Gold":"Silver";if(n=s.findIndex(f=>{var S;return(S=f.name)==null?void 0:S.toLowerCase().includes(l.toLowerCase())}),n===-1&&(s.push({name:l,weight:"",value:0}),n=s.length-1),a={name:s[n].name||l,weight:s[n].weight||"",value:typeof s[n].value=="number"?s[n].value:parseFloat(s[n].value||0)},(me=a.name)!=null&&me.toLowerCase().includes(l.toLowerCase())||(a.name=l),a.weight){const f=we(i.metalType,i.selectedCaret,a.weight);a.value=parseFloat(f.toFixed(2))}else a.value=parseFloat(a.value||0);s[n]=a;let o=0;s.forEach((f,S)=>{var P;if(S!==n){const U=((P=f.name)==null?void 0:P.toLowerCase())||"";(U.includes("stone")||U.includes("diamond")||U.includes("ruby")||U.includes("emerald")||U.includes("sapphire")||U.includes("pearl"))&&(o+=parseFloat(f.value||0))}});const c=parseFloat(a.value||0);let g=s.findIndex(f=>{var S;return(S=f.name)==null?void 0:S.toLowerCase().includes("making charges")}),C=0;if(g>=0){const f=((ge=s[g].weight)==null?void 0:ge.toString())||"";C=parseFloat(f.replace(/[^\d.]/g,""))||0}const D=c+o,p=D*C/100,v=D+p,I=i.Discount||0,B=v*I/100,b=v-B,d=i.gst||0,A=b*d/100,X=b+A,De=["sub total","subtotal","discount","gst","grand total","final price","total"],Y=s.filter((f,S)=>{var U;if(S===n)return!0;const P=((U=f.name)==null?void 0:U.toLowerCase())||"";return P.includes("making charges")||P.includes("stone")||P.includes("diamond")||P.includes("ruby")||P.includes("emerald")||P.includes("sapphire")||P.includes("pearl")?!0:!De.some(Pe=>P.includes(Pe))});if(g>=0){const f=Y.findIndex(S=>{var P;return(P=S.name)==null?void 0:P.toLowerCase().includes("making charges")});f>=0&&(Y[f].value=parseFloat(p.toFixed(2)))}else C>0&&Y.push({name:"Making Charges",weight:`${C}%`,value:parseFloat(p.toFixed(2))});const O=[...Y],ue=(a.weight||"").toString().replace(/[^\d.]/g,""),Fe=ue?`${ue}g Gross Wt.`:"Gross Wt.";return O.push({name:"Sub Total",weight:Fe,value:parseFloat(v.toFixed(2))}),I>0&&O.push({name:"Discount",weight:`${I}%`,value:parseFloat(B.toFixed(2))}),O.push({name:"Sub Total After Discount",weight:"After discount",value:parseFloat(b.toFixed(2))}),O.push({name:"GST",weight:`${d}%`,value:parseFloat(A.toFixed(2))}),O.push({name:"Grand Total",weight:"Final Price",value:parseFloat(X.toFixed(2))}),V.current=!1,O},[r.metalType,r.selectedCaret,r.Discount,r.gst,J,re,le,H,se,h]);T.exports.useEffect(()=>{if(!h||V.current)return;if((r.Discount>0||r.gst>0)&&(!r.metalType||!r.selectedCaret)){const s=r.priceDetails.find(n=>{var a,l;return((a=n.name)==null?void 0:a.toLowerCase().includes("sub total"))&&!((l=n.name)!=null&&l.toLowerCase().includes("after"))});if(s){const n=parseFloat(s.value||0),a=r.Discount||0,l=n*a/100,o=n-l,c=r.gst||0,g=o*c/100,C=o+g,D=r.priceDetails.map(p=>{var I;const v=((I=p.name)==null?void 0:I.toLowerCase())||"";return v.includes("discount")?{...p,weight:`${a}%`,value:parseFloat(l.toFixed(2))}:v.includes("sub total after discount")?{...p,value:parseFloat(o.toFixed(2))}:v.includes("gst")&&!v.includes("cgst")&&!v.includes("sgst")?{...p,weight:`${c}%`,value:parseFloat(g.toFixed(2))}:v.includes("grand total")?{...p,value:parseFloat(C.toFixed(2))}:p});if(!D.find(p=>{var v;return(v=p.name)==null?void 0:v.toLowerCase().includes("discount")})&&a>0){const p=D.findIndex(v=>{var I,B;return((I=v.name)==null?void 0:I.toLowerCase().includes("sub total"))&&!((B=v.name)!=null&&B.toLowerCase().includes("after"))});p>=0&&D.splice(p+1,0,{name:"Discount",weight:`${a}%`,value:parseFloat(l.toFixed(2))})}m(p=>({...p,priceDetails:D}));return}}if(!r.metalType||!r.selectedCaret)return;const i=$(r);if(i){const s=r.metalType==="gold"?"Gold":"Silver",n=r.priceDetails.find(l=>{var o;return(o=l.name)==null?void 0:o.toLowerCase().includes(s.toLowerCase())});((n==null?void 0:n.weight)||i.length!==r.priceDetails.length||r.Discount>0||r.gst>0)&&m(l=>({...l,priceDetails:i}))}},[r.metalType,r.selectedCaret,r.Discount,r.gst,J,re,le,H,se,h,$]);const Ce=async i=>{var s;i.preventDefault();try{const n={...r,stock:parseInt(r.stock)||0,rating:{value:parseFloat(r.rating.value)||0,count:parseInt(r.rating.count)||0},subtotal:{weight:r.subtotal.weight},Discount:parseFloat(r.Discount)||0,gst:parseFloat(r.gst)||0};console.log("Submitting product data:",n),console.log("Images array:",n.images),n.images=n.images.map(a=>typeof a=="string"?a:a&&a.url?a.url:String(a)),console.log("Processed images:",n.images),N?(await x({id:_,...n}).unwrap(),E.success("Product updated successfully")):(await Z(n).unwrap(),E.success("Product added successfully")),F("/products")}catch(n){console.log("Submit error:",n),E.error(((s=n.data)==null?void 0:s.message)||"Failed to save product")}};return N&&ee?t("div",{className:"flex justify-center items-center h-64",children:[e(Le,{}),e("p",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading product..."})]}):N&&W?t("div",{className:"flex flex-col justify-center items-center h-64",children:[e(k,{icon:"ph:warning-circle",className:"text-4xl text-red-500 mb-4"}),e("p",{className:"text-red-500 text-lg mb-2",children:"Failed to load product"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:((de=W==null?void 0:W.data)==null?void 0:de.message)||"Product not found"}),t(L,{onClick:()=>F("/products"),className:"btn btn-outline",children:[e(k,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}):N&&!u?t("div",{className:"flex flex-col justify-center items-center h-64",children:[e(k,{icon:"ph:magnifying-glass",className:"text-4xl text-gray-400 mb-4"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Product not found"}),t(L,{onClick:()=>F("/products"),className:"btn btn-outline",children:[e(k,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}):t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:N?"Edit Product":"Add New Product"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:N?"Update product information":"Create a new product"})]}),t(L,{onClick:()=>F("/products"),className:"btn btn-outline",children:[e(k,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e("div",{className:"lg:col-span-2",children:e(pe,{title:"Product Information",children:t("form",{onSubmit:Ce,className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Product Name *"}),e("input",{type:"text",name:"name",value:r.name,onChange:w,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Brand *"}),e("input",{type:"text",name:"brand",value:r.brand,onChange:w,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"SKU ID *"}),e("input",{type:"text",name:"skuId",value:r.skuId,onChange:w,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),t("select",{name:"categories",value:r.categories,onChange:w,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Category"}),ae.map(i=>e("option",{value:i.name,children:i.name},i._id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category Id *"}),t("select",{name:"categoryId",value:r.categoryId,onChange:i=>m(s=>{var n;return{...s,categoryId:i.target.value,categories:((n=ae.find(a=>a._id===i.target.value))==null?void 0:n.name)||""}}),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Category Id"}),ae.map(i=>e("option",{value:i._id,children:i.name},i._id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Stock *"}),e("input",{type:"number",name:"stock",value:r.stock,onChange:w,required:!0,min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),e("textarea",{name:"description",value:r.description,onChange:w,required:!0,rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"active",checked:r.active,onChange:w,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Active"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"CurrentlyNotavaiable",checked:r.CurrentlyNotavaiable,onChange:w,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Currently Not Available"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"popular",checked:r.popular,onChange:w,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Popular"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"trending",checked:r.trending,onChange:w,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Trending"})]})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rating Value"}),e("input",{type:"number",name:"rating.value",value:r.rating.value,onChange:w,min:"0",max:"5",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rating Count"}),e("input",{type:"number",name:"rating.count",value:r.rating.count,onChange:w,min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Metal Type"}),t("div",{className:"flex gap-6",children:[t("label",{className:"flex items-center cursor-pointer",children:[e("input",{type:"radio",name:"metalType",value:"gold",checked:r.metalType==="gold",onChange:w,className:"h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300"}),t("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[e(k,{icon:"ph:medal",className:"text-yellow-500 mr-1"}),"Gold"]})]}),t("label",{className:"flex items-center cursor-pointer",children:[e("input",{type:"radio",name:"metalType",value:"silver",checked:r.metalType==="silver",onChange:w,className:"h-4 w-4 text-gray-400 focus:ring-gray-500 border-gray-300"}),t("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[e(k,{icon:"ph:medal",className:"text-gray-400 mr-1"}),"Silver"]})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r.metalType==="gold"?"Gold Karat":"Silver Purity"}),r.metalType==="gold"?t("select",{name:"selectedCaret",value:r.selectedCaret,onChange:w,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Karat"}),e("option",{value:"24K",children:"24 Karat (Pure Gold - 99.9%)"}),e("option",{value:"22K",children:"22 Karat (91.67%)"}),e("option",{value:"18K",children:"18 Karat (75%)"})]}):t("select",{name:"selectedCaret",value:r.selectedCaret,onChange:w,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Purity"}),e("option",{value:"Pure Silver 999",children:"Pure Silver 999 (99.9%)"}),e("option",{value:"Silver 925",children:"Silver 925 (92.5% - Sterling Silver)"})]})]}),t("div",{children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pricing & Discount"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subtotal Weight"}),e("input",{type:"text",name:"subtotal.weight",value:r.subtotal.weight,onChange:w,placeholder:"e.g., 2.96g",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Discount (%)"}),e("input",{type:"number",name:"Discount",value:r.Discount,onChange:i=>{const s=parseFloat(i.target.value)||0;m(n=>{const a={...n,Discount:s};return setTimeout(()=>{const l=$(a);l&&m(o=>({...o,priceDetails:l}))},0),a})},min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"GST (%)"}),e("input",{type:"number",name:"gst",value:r.gst,onChange:i=>{const s=parseFloat(i.target.value)||0;m(n=>{const a={...n,gst:s};return setTimeout(()=>{const l=$(a);l&&m(o=>({...o,priceDetails:l}))},0),a})},min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]}),e("div",{className:"mt-4",children:t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"isDiscountAvaiable",checked:r.isDiscountAvaiable,onChange:w,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Discount Available"})]})})]}),t("div",{children:[t("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Product Details"}),t(L,{type:"button",onClick:ye,className:"btn btn-sm btn-outline",children:[e(k,{icon:"ph:plus",className:"mr-2"}),"Add Product Detail"]})]}),e("div",{className:"space-y-4",children:r.productDetails.map((i,s)=>e(Ke,{detail:i,index:s,onUpdateDetail:n=>{const a=[...r.productDetails];a[s]=n,m(l=>({...l,productDetails:a}))},onRemove:()=>ve(s)},s))})]}),t("div",{children:[e("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:t("div",{className:"flex items-start",children:[e(k,{icon:"heroicons-outline:information-circle",className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-2 mt-0.5 flex-shrink-0"}),t("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e("p",{className:"font-semibold mb-2",children:"Important Notes:"}),t("ul",{className:"list-disc list-inside space-y-1",children:[t("li",{children:["Making Charges, Discount, and GST should be entered as ",e("strong",{children:"percentage (%)"})]}),t("li",{children:["For stones (Diamond, Ruby, etc.), enter weight in ",e("strong",{children:"karat"})," and amount"]}),t("li",{children:["For Gold and Silver, enter weight in ",e("strong",{children:"grams (gms)"})," and amount"]})]})]})]})}),t("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Price Details"}),t(L,{type:"button",onClick:ke,className:"btn btn-sm btn-outline",children:[e(k,{icon:"ph:plus",className:"mr-2"}),"Add Price Detail"]})]}),e("div",{className:"space-y-2",children:r.priceDetails.map((i,s)=>t("div",{className:"flex gap-2",children:[e("input",{type:"text",value:i.name,onChange:n=>{const a=r.priceDetails.map((l,o)=>o===s?{name:n.target.value,weight:l.weight||"",value:typeof l.value=="number"?l.value:parseFloat(l.value||0)}:{name:l.name||"",weight:l.weight||"",value:typeof l.value=="number"?l.value:parseFloat(l.value||0)});m(l=>{var g;const o={...l,priceDetails:a};return(((g=n.target.value)==null?void 0:g.toLowerCase())||"").includes("making charges")&&setTimeout(()=>{const C=$(o);C&&m(D=>({...D,priceDetails:C}))},0),o})},placeholder:"Name (e.g., Gold, Stone, Making Charges)",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:i.weight||"",onChange:n=>{const a=r.priceDetails.map((l,o)=>o===s?{name:l.name||"",weight:n.target.value,value:typeof l.value=="number"?l.value:parseFloat(l.value||0)}:{name:l.name||"",weight:l.weight||"",value:typeof l.value=="number"?l.value:parseFloat(l.value||0)});m(l=>{var C;const o={...l,priceDetails:a},c=((C=i.name)==null?void 0:C.toLowerCase())||"",g=l.metalType==="gold"?"Gold":"Silver";return(c.includes(g.toLowerCase())||c.includes("making charges"))&&setTimeout(()=>{const D=$(o);D&&m(p=>({...p,priceDetails:D}))},0),o})},placeholder:"Weight (e.g., 2.903g) or % for Making Charges",className:"w-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e("input",{type:"number",value:i.value||"",onChange:n=>{const a=parseFloat(n.target.value)||0,l=r.priceDetails.map((o,c)=>c===s?{name:o.name||"",weight:o.weight||"",value:a}:{name:o.name||"",weight:o.weight||"",value:typeof o.value=="number"?o.value:parseFloat(o.value||0)});m(o=>{var C;const c={...o,priceDetails:l},g=((C=i.name)==null?void 0:C.toLowerCase())||"";return(g.includes("stone")||g.includes("diamond")||g.includes("ruby")||g.includes("emerald")||g.includes("sapphire")||g.includes("pearl")||g.includes("making charges"))&&setTimeout(()=>{const D=$(c);D&&m(p=>({...p,priceDetails:D}))},0),c})},placeholder:"Value",min:"0",step:"0.01",className:"w-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e(L,{type:"button",onClick:()=>Ne(s),className:"btn btn-sm btn-outline-danger",children:e(k,{icon:"ph:trash"})})]},s))}),(()=>{var C,D,p,v,I,B;const i=r.metalType==="gold"?"Gold":"Silver",s=r.priceDetails.find(b=>{var d;return(d=b.name)==null?void 0:d.toLowerCase().includes(i.toLowerCase())}),n=r.priceDetails.filter(b=>{var A;const d=((A=b.name)==null?void 0:A.toLowerCase())||"";return(d.includes("stone")||d.includes("diamond")||d.includes("ruby")||d.includes("emerald")||d.includes("sapphire")||d.includes("pearl"))&&!d.includes(i.toLowerCase())}).reduce((b,d)=>b+(parseFloat(d.value)||0),0),a=r.priceDetails.find(b=>{var d;return(d=b.name)==null?void 0:d.toLowerCase().includes("making charges")}),l=r.priceDetails.find(b=>{var d,A;return((d=b.name)==null?void 0:d.toLowerCase().includes("sub total"))&&!((A=b.name)!=null&&A.toLowerCase().includes("after"))}),o=r.priceDetails.find(b=>{var d;return(d=b.name)==null?void 0:d.toLowerCase().includes("discount")}),c=r.priceDetails.find(b=>{var d,A,X;return((d=b.name)==null?void 0:d.toLowerCase().includes("gst"))&&!((A=b.name)!=null&&A.toLowerCase().includes("cgst"))&&!((X=b.name)!=null&&X.toLowerCase().includes("sgst"))}),g=r.priceDetails.find(b=>{var d;return(d=b.name)==null?void 0:d.toLowerCase().includes("grand total")});return!s||!s.weight?null:t("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[t("h4",{className:"text-sm font-semibold text-green-800 dark:text-green-200 mb-3 flex items-center",children:[e(k,{icon:"ph:calculator",className:"mr-2"}),"Price Calculation Summary"]}),t("div",{className:"space-y-2 text-sm",children:[t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:[i," (",r.selectedCaret,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((C=s.value)==null?void 0:C.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),n>0&&t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-700 dark:text-gray-300",children:"Stones:"}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",n.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a&&a.value>0&&t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:["Making Charges (",a.weight,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((D=a.value)==null?void 0:D.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),l&&t("div",{className:"flex justify-between pt-2 border-t border-green-200 dark:border-green-700",children:[e("span",{className:"font-medium text-gray-900 dark:text-white",children:"Sub Total:"}),t("span",{className:"font-semibold text-gray-900 dark:text-white",children:["\u20B9",((p=l.value)==null?void 0:p.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),o&&o.value>0&&t("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[t("span",{children:["Discount (",o.weight,"):"]}),t("span",{className:"font-medium",children:["-\u20B9",((v=o.value)==null?void 0:v.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),c&&c.value>0&&t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:["GST (",c.weight,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((I=c.value)==null?void 0:I.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),g&&t("div",{className:"flex justify-between pt-2 border-t-2 border-green-300 dark:border-green-600",children:[e("span",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:"Grand Total:"}),t("span",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:["\u20B9",((B=g.value)==null?void 0:B.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]})]})]})})()]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e(L,{type:"button",onClick:()=>F("/products"),className:"btn btn-outline",children:"Cancel"}),e(L,{type:"submit",disabled:z||G||M,className:"btn btn-primary",children:z||G||M?t(he,{children:[e(k,{icon:"ph:spinner",className:"animate-spin mr-2"}),N?"Updating...":"Adding..."]}):t(he,{children:[e(k,{icon:"ph:check",className:"mr-2"}),N?"Update Product":"Add Product"]})})]})]})})}),e("div",{className:"lg:col-span-1",children:e(pe,{title:"Product Images",children:t("div",{className:"space-y-4",children:[t("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[e("input",{type:"file",multiple:!0,accept:"image/*",onChange:fe,disabled:M,className:"hidden",id:"image-upload"}),t("label",{htmlFor:"image-upload",className:`cursor-pointer ${M?"opacity-50 cursor-not-allowed":""}`,children:[e(k,{icon:"ph:cloud-arrow-up",className:"text-4xl text-gray-400 mx-auto mb-4"}),e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:M?"Uploading...":"Click to upload images"}),e("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, GIF up to 10MB each"})]})]}),q.length>0&&t("div",{className:"space-y-2",children:[t("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Uploaded Images (",q.length,")"]}),e("div",{className:"grid grid-cols-2 gap-2",children:q.map((i,s)=>t("div",{className:"relative group",children:[e("img",{src:typeof i=="string"?i:i.url||i,alt:`Product ${s+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200 dark:border-gray-600"}),e(L,{onClick:()=>xe(s),className:"absolute -top-2 -right-2 btn btn-sm btn-danger rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e(k,{icon:"ph:x"})})]},s))})]}),r.name&&t("div",{className:"border-t pt-4",children:[e("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Product Preview"}),e("div",{className:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4",children:t("div",{className:"text-sm space-y-2",children:[e("p",{className:"font-medium text-gray-900 dark:text-white",children:r.name}),e("p",{className:"text-gray-600 dark:text-gray-400",children:r.brand}),t("p",{className:"text-gray-600 dark:text-gray-400",children:["SKU: ",r.skuId]}),r.stock>0&&t("p",{className:"text-gray-600 dark:text-gray-400",children:["Stock: ",r.stock]}),r.selectedCaret&&t("p",{className:"text-gray-600 dark:text-gray-400",children:["Carat: ",r.selectedCaret]}),t("div",{className:"flex flex-wrap gap-2 mt-2",children:[r.active&&e("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:"Active"}),r.CurrentlyNotavaiable&&e("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Not Available"}),r.popular&&e("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:"Popular"}),r.trending&&e("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Trending"}),r.isDiscountAvaiable&&r.Discount>0&&t("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:[r.Discount,"% Off"]})]})]})})]})]})})})]})]})};export{Oe as default};
