import{u as U,a as D,r as L,j as e,L as X,t as Q,F as _,R as I,b as J,c as r,I as n}from"./index.93603967.js";import{C as k}from"./Card.43e3b2ea.js";import{_ as W}from"./react-apexcharts.min.b98a181c.js";import{u as ee,a as te,b as ae,c as re}from"./orderApi.c470ea6a.js";import{u as se}from"./userApi.b5031dfe.js";import{u as le,a as ie}from"./productApi.9df9a97b.js";import{r as R}from"./index.4c9f9a63.js";import{u as ne}from"./ticketApi.d1cca595.js";const ce=({height:c=400})=>{U();const[l]=D(),{data:f,isLoading:i}=ee({months:12}),o=(f==null?void 0:f.data)||{categories:[],series:[{name:"Gold",data:[],orderCounts:[]},{name:"Silver",data:[],orderCounts:[]}]},S=L.exports.useMemo(()=>{const d={};return o.series.forEach((u,m)=>{u.orderCounts.forEach((h,T)=>{const y=`${m}_${T}`;d[y]=h})}),d},[o.series]),w=o.series.map(d=>({name:d.name,data:d.data})),j=L.exports.useRef(o),F=L.exports.useRef(S);L.exports.useEffect(()=>{j.current=o,F.current=S},[o,S]);const O={chart:{toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,endingShape:"rounded",columnWidth:"55%",borderRadius:4}},legend:{show:!0,markers:{width:10,height:10,radius:12},labels:{colors:"#f9fafb"},itemMargin:{horizontal:10,vertical:5}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},yaxis:{opposite:!!l,labels:{style:{colors:"#f9fafb",fontFamily:"Inter"},formatter:function(d){return"\u20B9"+(d/1e3).toFixed(1)+"k"}},title:{text:"Value (\u20B9)",style:{color:"#f9fafb"}}},xaxis:{categories:o.categories,labels:{style:{colors:"#f9fafb",fontFamily:"Inter"}},axisBorder:{show:!1},axisTicks:{show:!1}},fill:{opacity:1},tooltip:{custom:function({seriesIndex:d,dataPointIndex:u,w:m}){var p;const h=j.current,T=F.current,y=m.globals.seriesNames[d]||((p=h==null?void 0:h.series[d])==null?void 0:p.name)||"Unknown",z=m.globals.series[d][u]||0;let A="Unknown Month";m.globals.categoryLabels&&m.globals.categoryLabels[u]?A=m.globals.categoryLabels[u]:(h==null?void 0:h.categories)&&h.categories[u]?A=h.categories[u]:m.config.xaxis&&m.config.xaxis.categories&&m.config.xaxis.categories[u]&&(A=m.config.xaxis.categories[u]);const C=T[`${d}_${u}`]||0;return`
          <div style="padding: 10px; background: rgba(0, 0, 0, 0.9); border-radius: 5px; border: 1px solid rgba(255, 255, 255, 0.1);">
            <div style="font-weight: bold; margin-bottom: 8px; color: #fff; font-size: 14px;">
              ${y} - ${A}
            </div>
            <div style="color: #f9fafb; margin-bottom: 5px; font-size: 13px;">
              <span style="opacity: 0.8;">Orders:</span> <strong style="color: #60a5fa;">${C}</strong>
            </div>
            <div style="color: #f9fafb; font-size: 13px;">
              <span style="opacity: 0.8;">Value:</span> <strong style="color: #60a5fa;">\u20B9${z.toLocaleString("en-IN")}</strong>
            </div>
          </div>
        `}},colors:["#FFD700","#C0C0C0"],grid:{show:!0,borderColor:"#60a5fa",strokeDashArray:10,position:"back"},responsive:[{breakpoint:600,options:{legend:{position:"bottom",offsetY:8,horizontalAlign:"center"},plotOptions:{bar:{columnWidth:"80%"}}}}]};return i?e("div",{className:"flex justify-center items-center",style:{height:c},children:e(X,{})}):e("div",{children:e(W,{options:O,series:w,type:"bar",height:c})})},oe=({height:c=340})=>{const[l]=U(),f=[50],i={chart:{toolbar:{show:!1}},plotOptions:{radialBar:{size:200,offsetY:-20,startAngle:-180,endAngle:150,hollow:{size:"60%"},track:{background:"#fff",strokeWidth:"100%"},dataLabels:{name:{fontSize:"22px",color:l?"#E2E8F0":"#475569"},value:{fontSize:"32px",offsetY:30,fontWeight:700,color:l?"#E2E8F0":"#475569"},total:{show:!0,label:"Completed Task",color:l?"#E2E8F0":"#475569",fontWeight:400,formatter:function(){return 8}}}}},fill:{type:"gradient",gradient:{shade:"light",shadeIntensity:.35,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,65,91]}},stroke:{dashArray:8},colors:[Q.colors.primary]};return e("div",{children:e(W,{series:f,options:i,type:"radialBar",height:c})})},de=({height:c=335})=>{const[l]=U(),f=[30,70],i={labels:["Sent","Opend"],dataLabels:{enabled:!0},colors:[Q.colors.warning,Q.colors.primary],legend:{position:"bottom",fontSize:"12px",fontFamily:"Inter",fontWeight:400,labels:{colors:l?"#CBD5E1":"#475569"},markers:{width:6,height:6,offsetY:-1,offsetX:-5,radius:12},itemMargin:{horizontal:10,vertical:0}},responsive:[{breakpoint:480,options:{legend:{position:"bottom"}}}]};return e(_,{children:e(W,{options:i,series:f,type:"pie",height:c})})};I.forwardRef(({indeterminate:c,...l},f)=>{const i=I.useRef(),o=f||i;return I.useEffect(()=>{o.current.indeterminate=c},[o,c]),e(_,{children:e("input",{type:"checkbox",ref:o,...l,className:"table-checkbox"})})});const me=()=>{const c=J(),{data:l,isLoading:f,error:i}=te();console.log("Orders response:",l,"Loading:",f,"Error:",i);const o=L.exports.useMemo(()=>{var s,g;if(!l)return[];const t=(l==null?void 0:l.orders)||(l==null?void 0:l.details)||((s=l==null?void 0:l.data)==null?void 0:s.orders)||((g=l==null?void 0:l.data)==null?void 0:g.details)||(Array.isArray(l==null?void 0:l.data)?l.data:null)||(Array.isArray(l)?l:[]);return Array.isArray(t)?t.slice(0,10):[]},[l]),S=t=>t?new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}):"N/A",w=t=>!t&&t!==0?"\u20B90.00":`\u20B9${parseFloat(t).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,j=t=>{switch((t==null?void 0:t.toLowerCase())||""){case"delivered":return"bg-green-500 text-green-500";case"shipped":return"bg-blue-500 text-blue-500";case"placed":return"bg-yellow-500 text-yellow-500";case"cancelled":return"bg-red-500 text-red-500";default:return"bg-gray-500 text-gray-500"}},F=[{Header:"Order ID",accessor:"_id",Cell:({row:t})=>{var a;const s=((a=t==null?void 0:t.original)==null?void 0:a._id)||"",g=s.slice(-8).toUpperCase();return r("span",{className:"text-sm text-indigo-500 font-medium cursor-pointer hover:underline",onClick:()=>c(`/orders/${s}`),children:["#",g]})}},{Header:"Customer",accessor:"userId",Cell:({row:t})=>{var a,v,b;(a=t==null?void 0:t.original)==null||a.userId;const s=((v=t==null?void 0:t.original.user)==null?void 0:v.name)||"Guest User",g=((b=t==null?void 0:t.original.user)==null?void 0:b.email)||"N/A";return r("div",{children:[e("span",{className:"text-sm text-gray-600 dark:text-gray-300 capitalize block",children:s}),e("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-light mt-[1px] block lowercase",children:g})]})}},{Header:"Date",accessor:"createdAt",Cell:({row:t})=>{var s;return e("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:S((s=t==null?void 0:t.original)==null?void 0:s.createdAt)})}},{Header:"Items",accessor:"products",Cell:({row:t})=>{var g,a,v,b,q;return(((g=t==null?void 0:t.original)==null?void 0:g.products)||[]).reduce((K,Z)=>K+(Z.quantity||0),0),r("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[((v=(a=t==null?void 0:t.original)==null?void 0:a.items)==null?void 0:v.length)||0," ",((q=(b=t==null?void 0:t.original)==null?void 0:b.items)==null?void 0:q.length)===1?"item":"items"]})}},{Header:"Amount",accessor:"totalAmount",Cell:({row:t})=>{var s;return e("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:w((s=t==null?void 0:t.original)==null?void 0:s.totalAmount)})}},{Header:"Status",accessor:"status",Cell:({row:t})=>{var a;const s=((a=t==null?void 0:t.original)==null?void 0:a.status)||"pending",g=j(s);return r("span",{className:"flex items-center space-x-2",children:[e("span",{className:`h-2 w-2 rounded-full inline-block ${g.split(" ")[0]}`}),e("span",{className:`text-sm capitalize ${g.split(" ")[1]}`,children:s})]})}}],O=L.exports.useMemo(()=>F,[c]),d=L.exports.useMemo(()=>o,[o]),u=R.exports.useTable({columns:O,data:d},R.exports.useGlobalFilter,R.exports.useSortBy,R.exports.usePagination,R.exports.useRowSelect),{getTableProps:m,getTableBodyProps:h,headerGroups:T,footerGroups:y,page:z,nextPage:A,previousPage:C,canNextPage:p,canPreviousPage:x,pageOptions:N,state:$,gotoPage:B,pageCount:Y,setPageSize:E,setGlobalFilter:V,prepareRow:G}=u,{globalFilter:M,pageIndex:P,pageSize:H}=$;return f?e("div",{className:"card",children:e("div",{className:"flex items-center justify-center py-20",children:r("div",{className:"flex flex-col items-center space-y-4",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"}),e("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading recent orders..."})]})})}):i?e("div",{className:"card",children:e("div",{className:"flex items-center justify-center py-20",children:r("div",{className:"text-center",children:[e(n,{icon:"heroicons-outline:exclamation-circle",className:"text-red-500 text-5xl mb-4 mx-auto"}),e("p",{className:"text-red-500 font-semibold mb-2",children:"Failed to load orders"}),e("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:(i==null?void 0:i.message)||"Something went wrong"})]})})}):o.length===0?e("div",{className:"card",children:e("div",{className:"flex items-center justify-center py-20",children:r("div",{className:"text-center",children:[e(n,{icon:"heroicons-outline:shopping-bag",className:"text-gray-400 text-5xl mb-4 mx-auto"}),e("p",{className:"text-gray-500 dark:text-gray-400 font-semibold mb-2",children:"No orders yet"}),e("p",{className:"text-gray-400 dark:text-gray-500 text-sm",children:"Recent product orders will appear here"})]})})}):e(_,{children:r("div",{className:"card",children:[e("div",{className:"overflow-x-auto",children:e("div",{className:"inline-block min-w-full align-middle",children:e("div",{className:"overflow-hidden",children:r("table",{className:"min-w-full divide-y divide-gray-100 table-fixed dark:divide-gray-700",...m,children:[e("thead",{className:"bg-gray-100 dark:bg-gray-700",children:T.map(t=>e("tr",{...t.getHeaderGroupProps(),children:t.headers.map(s=>e("th",{...s.getHeaderProps(s.getSortByToggleProps()),scope:"col",className:"table-th",children:r("div",{className:"flex items-center justify-between",children:[s.render("Header"),e("span",{children:s.isSorted?s.isSortedDesc?e(n,{icon:"ph:caret-up-fill"}):e(n,{icon:"ph:caret-down-fill"}):e(n,{icon:"ri:expand-up-down-fill",className:"text-[15px] text-gray-400"})})]})}))}))}),e("tbody",{className:"bg-white divide-y divide-gray-100 dark:bg-gray-800 dark:divide-gray-700",...h,children:z.map(t=>(G(t),e("tr",{...t.getRowProps(),className:"hover:bg-gray-100 dark:hover:bg-gray-700 hover:bg-opacity-30 transition-all duration-200 cursor-pointer",onClick:()=>c(`/orders/${t.original._id}`),children:t.cells.map(s=>e("td",{...s.getCellProps(),className:"table-td",children:s.render("Cell")}))})))})]})})})}),N.length>1&&e("div",{className:"p-6",children:r("ul",{className:"flex items-center justify-center space-x-3 rtl:space-x-reverse",children:[e("li",{className:"text-xl leading-4 text-gray-900 dark:text-white rtl:rotate-180",children:e("button",{className:`${x?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>C(),disabled:!x,children:e(n,{icon:"heroicons-outline:chevron-left"})})}),N.map((t,s)=>e("li",{children:e("button",{"aria-current":"page",className:`${s===P?"bg-indigo-500 text-white font-medium":"bg-gray-100 dark:bg-gray-700 dark:text-gray-400 text-gray-900 font-normal"} text-sm rounded leading-[16px] flex h-6 w-6 items-center justify-center transition-all duration-150`,onClick:()=>B(s),children:t+1})},s)),e("li",{className:"text-xl leading-4 text-gray-900 dark:text-white rtl:rotate-180",children:e("button",{className:`${p?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>A(),disabled:!p,children:e(n,{icon:"heroicons-outline:chevron-right"})})})]})})]})})},be=()=>{var M,P,H,t,s,g;const c=J(),[l,f]=L.exports.useState({status:"",category:"",page:1,limit:10}),{data:i,isLoading:o,refetch:S}=ne(l),{data:w,isLoading:j,error:F}=se(),{data:O,isLoading:d}=le(),{data:u,isLoading:m}=ae(),{data:h,isLoading:T}=ie(),{data:y,isLoading:z}=re();console.log("Users Query State:",{users:w,usersLoading:j,usersError:F});const A=j||d||m||T,C=(a,v=["details","data","users","products","orders","categories"])=>{if(!a)return console.log("extractArrayData: response is null/undefined"),[];if(Array.isArray(a))return console.log("extractArrayData: response is already an array",a.length),a;console.log("extractArrayData: response structure",{response:a,type:typeof a,keys:Object.keys(a||{}),hasDetails:a==null?void 0:a.details,detailsIsArray:Array.isArray(a==null?void 0:a.details)});for(const b of v)if(a[b]&&Array.isArray(a[b]))return console.log(`extractArrayData: Found array in key "${b}"`,a[b].length),a[b];return console.log("extractArrayData: No array found, returning empty array"),[]},p=C(w,["details","data","users"]),x=C(O,["details","data","products"]),N=C(u,["details","data","orders"]),$=C(h,["details","data","categories"]);console.log("usersData?.length",p==null?void 0:p.length,w);const B=(p==null?void 0:p.length)||0,Y=(x==null?void 0:x.length)||0,E=(N==null?void 0:N.length)||0,V=($==null?void 0:$.length)||0;console.log("Ticket:",i==null?void 0:i.data.tickets);const G=((M=y==null?void 0:y.data)==null?void 0:M.netRevenue)||((P=y==null?void 0:y.data)==null?void 0:P.totalRevenue)||0;return N!=null&&N.slice(0,5),A?e("div",{className:"flex justify-center items-center h-64",children:e(X,{})}):r("div",{className:" space-y-5",children:[r("div",{className:"grid xl:grid-cols-4 sm:grid-cols-2 grid-cols-1 gap-5",children:[e(k,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Total Orders"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-indigo-500 text-white text-2xl flex items-center justify-center",children:e(n,{icon:"ph:shopping-cart"})})})]}),r("div",{children:[e("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:E}),r("span",{className:"  space-x-2 block mt-4 ",children:[e("span",{className:"badge bg-indigo-500/10 text-indigo-500 ",children:E>0?"Active":"No Orders"}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Total orders"})]})]})]})}),e(k,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Total Revenue"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-yellow-500 text-white text-2xl flex items-center justify-center",children:e(n,{icon:"ph:currency-inr"})})})]}),r("div",{children:[r("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:["\u20B9 ",G.toLocaleString("en-IN").trim()]}),r("span",{className:"  space-x-2 block mt-4 ",children:[r("span",{className:"badge bg-yellow-500/10 text-yellow-500 ",children:[E," orders"]}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Total revenue"})]})]})]})}),e(k,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Total Users"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-red-500 text-white text-2xl flex items-center justify-center",children:e(n,{icon:"ph:users"})})})]}),r("div",{children:[e("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:B}),r("span",{className:"  space-x-2 block mt-4 ",children:[e("span",{className:"badge bg-red-500/10 text-red-500 ",children:"Active"}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Registered users"})]})]})]})}),e(k,{children:r("div",{children:[r("div",{className:"flex",children:[e("div",{className:"flex-1 text-base font-medium",children:"Products"}),e("div",{className:"flex-none",children:e("div",{className:"h-10 w-10  rounded-full bg-green-500 text-white text-2xl flex items-center justify-center",children:e(n,{icon:"ph:package"})})})]}),r("div",{children:[e("span",{className:" text-2xl font-medium text-gray-800  dark:text-white",children:Y}),r("span",{className:"  space-x-2 block mt-4 ",children:[r("span",{className:"badge bg-green-500/10 text-green-500 ",children:[V," categories"]}),e("span",{className:" text-sm text-gray-500 dark:text-gray-400",children:"Total products"})]})]})]})})]}),r("div",{className:"grid   grid-cols-12 gap-5",children:[e("div",{className:"xl:col-span-7 col-span-12",children:e(k,{className:"!bg-indigo-500 ",title:"Investment History",titleClass:"!text-white",noborder:!0,children:e(ce,{})})}),e("div",{className:"xl:col-span-5 col-span-12",children:r(k,{title:"Support Tracker",subscribe:!0,children:[e(oe,{}),r("div",{className:"grid  grid-cols-3 gap-2 py-4",children:[r("div",{className:" text-center",children:[e("div",{children:e("div",{className:"h-10 w-10 mb-2 mx-auto rounded-md bg-indigo-500/10 text-indigo-500 text-xl flex items-center justify-center",children:e(n,{icon:"ph:ticket"})})}),r("div",{children:[e("div",{className:" font-medium text-gray-800 dark:text-white text-sm truncate mb-[2px]",children:"All Tickets"}),e("div",{className:" text-xs text-gray-400",children:i==null?void 0:i.data.tickets.length})]})]}),r("div",{className:" text-center",children:[e("div",{children:e("div",{className:"h-10 w-10 mb-2 mx-auto rounded-md bg-green-500/10 text-green-500 text-xl flex items-center justify-center",children:e(n,{icon:"ph:clock-countdown"})})}),r("div",{children:[e("div",{className:" font-medium text-gray-800 dark:text-white text-sm truncate mb-[2px]",children:"Open Tickets"}),e("div",{className:" text-xs text-gray-400",children:i==null?void 0:i.data.tickets.filter(a=>a.status==="open").length})]})]}),r("div",{className:" text-center",children:[e("div",{children:e("div",{className:"h-10 w-10 mb-2 mx-auto rounded-md bg-yellow-500/10 text-yellow-500 text-xl flex items-center justify-center",children:e(n,{icon:"ph:check"})})}),r("div",{children:[e("div",{className:" font-medium text-gray-800 dark:text-white text-sm truncate mb-[2px]",children:"Resolved Tickets"}),e("div",{className:" text-xs text-gray-400",children:i==null?void 0:i.data.tickets.filter(a=>a.status==="resolved").length})]})]})]})]})})]}),r("div",{className:"grid xl:grid-cols-3 gap-5 ",children:[e(k,{title:"Trending Products",subtitle:"Trending products Overview",children:e("ul",{className:" space-y-4",children:(t=(H=x==null?void 0:x.filter(a=>a.trending===!0))==null?void 0:H.slice(0,x.filter(a=>a.popular===!0).length<=5?void 0:5))==null?void 0:t.map((a,v)=>r("li",{className:"flex justify-between items-center",children:[r("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",onClick:()=>c(`/products/${a._id}`),children:[e("div",{className:"flex-none",children:e("div",{className:"h-[34px] w-[34px] rounded-full",children:a.images&&a.images.length>0?e("img",{src:a.images[0],alt:a.name,className:"w-full h-full object-cover"}):e("div",{className:"w-full h-full flex items-center justify-center",children:e(n,{icon:"ph:image",className:"text-4xl text-gray-400"})})})}),e("div",{className:"flex-1",children:e("div",{className:" text-sm ",children:a.name})})]}),r("div",{className:"text-gray-800 dark:text-white   flex items-center space-x-[2px] rtl:space-x-reverse",children:[e("span",{className:" text-sm  ",children:a.rating.value}),e(n,{icon:a.icon,className:`${a.icon==="heroicons:arrow-small-up"?" text-green-500 ":" text-red-500"}  text-lg`})]})]},v))})}),e(k,{title:"Popular Products",subtitle:"Most popular products",children:e("ul",{className:" space-y-4",children:(g=(s=x==null?void 0:x.filter(a=>a.popular===!0))==null?void 0:s.slice(0,x.filter(a=>a.popular===!0).length<=5?void 0:5))==null?void 0:g.map((a,v)=>r("li",{className:"flex justify-between items-center",children:[r("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",onClick:()=>c(`/products/${a._id}`),children:[e("div",{className:"flex-none",children:e("div",{className:"h-[34px] w-[34px] bg-gray-200 text-gray-500 dark:bg-gray-700 dark:text-gray-300 flex  items-center justify-center rounded-full",children:a.images&&a.images.length>0?e("img",{src:a.images[0],alt:a.name,className:"w-full h-full object-cover"}):e("div",{className:"w-full h-full flex items-center justify-center",children:e(n,{icon:"ph:image",className:"text-4xl text-gray-400"})})})}),e("div",{className:"flex-1",children:e("div",{className:" text-sm ",children:a.name})})]}),r("div",{className:"text-gray-800 dark:text-white   flex items-center space-x-[2px] rtl:space-x-reverse",children:[e("span",{className:" text-sm  ",children:a.rating.value}),e(n,{icon:a.icon,className:`${a.icon==="heroicons:arrow-small-up"?" text-green-500 ":" text-red-500"}  text-lg`})]})]},v))})}),e(k,{title:"Total Earning",children:e(de,{})})]}),r("div",{children:[e("div",{className:"card-title mb-5",children:"Latest Order"}),e(me,{})]})]})};export{be as default};
