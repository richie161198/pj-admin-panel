import{b as H,r as g,j as e,L as J,c as a,I as d,B as c,Q as p}from"./index.93603967.js";import{g as K}from"./orderApi.c470ea6a.js";import{B as F}from"./Badge.2391c60f.js";import{u as v,a as X}from"./xlsx.0799a57e.js";const re=()=>{var A,C,D,I,O;const M=H(),[y,j]=g.exports.useState(""),[L,m]=g.exports.useState(1),[b,B]=g.exports.useState(""),[f,G]=g.exports.useState(""),[u,k]=g.exports.useState(""),[N,$]=g.exports.useState(""),V={page:L,limit:10,...b&&{status:b},...f&&{type:f},...y&&{search:y},...u&&{startDate:u},...N&&{endDate:N}},{data:n,isLoading:z,error:w,refetch:P}=K(V),o=((A=n==null?void 0:n.data)==null?void 0:A.orders)||[],r=((C=n==null?void 0:n.data)==null?void 0:C.pagination)||{},h=((D=n==null?void 0:n.data)==null?void 0:D.summary)||{};console.log("Investment Orders Response:",n),console.log("Orders:",o),console.log("Pagination:",r),console.log("Summary:",h);const Q=async(t,i)=>{try{p.success("Order status updated successfully"),P()}catch{p.error("Failed to update order status")}},R=t=>{M(`/investment-orders/${t}`)},U=t=>{const l={pending:{color:"warning",text:"Pending"},processing:{color:"info",text:"Processing"},completed:{color:"success",text:"Completed"},failed:{color:"danger",text:"Failed"},cancelled:{color:"secondary",text:"Cancelled"},refunded:{color:"warning",text:"Refunded"}}[t]||{color:"secondary",text:t};return e(F,{className:`badge-${l.color}`,children:l.text})},S=t=>{const l={deposit:{color:"success",text:"Deposit"},withdrawal:{color:"warning",text:"Withdrawal"},gold_purchase:{color:"info",text:"Gold Purchase"},silver_purchase:{color:"secondary",text:"Silver Purchase"},gold_sale:{color:"danger",text:"Gold Sale"},silver_sale:{color:"secondary",text:"Silver Sale"}}[t]||{color:"secondary",text:t};return e(F,{className:`badge-${l.color}`,children:l.text})},W=()=>{try{const t=o.map((s,q)=>{var _,T,E;return{"S.No":q+1,"Order ID":s.orderId||"N/A","Customer Name":((_=s.userId)==null?void 0:_.name)||"N/A","Customer Email":((T=s.userId)==null?void 0:T.email)||"N/A","Customer Phone":((E=s.userId)==null?void 0:E.phone)||"N/A",Type:s.orderType||"N/A",Asset:s.transactionType||"N/A",Status:s.status||"N/A",Amount:s.inramount||0,Currency:s.currency||"INR","Payment Method":s.Payment_method||"N/A","Created At":s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A","Updated At":s.updatedAt?new Date(s.updatedAt).toLocaleDateString():"N/A"}}),i=v.json_to_sheet(t),l=v.book_new();v.book_append_sheet(l,i,"Investment Orders");const x=`investment-orders-${new Date().toISOString().split("T")[0]}.xlsx`;X(l,x),p.success("Excel file downloaded successfully")}catch(t){console.error("Error downloading Excel:",t),p.error("Failed to download Excel file")}};return z?e("div",{className:"flex justify-center items-center h-64",children:e(J,{})}):w?a("div",{className:"text-center py-12",children:[e(d,{icon:"ph:warning-circle",className:"text-6xl text-red-500 mx-auto mb-4"}),e("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Error Loading Orders"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:w.message}),a(c,{onClick:()=>P(),className:"btn btn-primary",children:[e(d,{icon:"ph:arrow-clockwise",className:"mr-2"}),"Try Again"]})]}):a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Investment Orders"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage investment transactions and orders"})]}),e("div",{className:"flex space-x-3",children:a(c,{onClick:W,className:"btn btn-outline-success",disabled:!o||o.length===0,children:[e(d,{icon:"ph:download",className:"mr-2"}),"Export Excel"]})})]}),h&&a("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-3 rounded-full bg-blue-100 dark:bg-blue-900/20",children:e(d,{icon:"ph:shopping-cart",className:"text-2xl text-blue-600 dark:text-blue-400"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Orders"}),e("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h.totalOrders||0})]})]})}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-3 rounded-full bg-green-100 dark:bg-green-900/20",children:e(d,{icon:"ph:currency-circle-dollar",className:"text-2xl text-green-600 dark:text-green-400"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Revenue"}),a("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["\u20B9",((I=h.totalAmount)==null?void 0:I.toLocaleString())||0]})]})]})}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-3 rounded-full bg-purple-100 dark:bg-purple-900/20",children:e(d,{icon:"ph:chart-line",className:"text-2xl text-purple-600 dark:text-purple-400"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Average Order Value"}),a("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["\u20B9",((O=h.averageOrderValue)==null?void 0:O.toLocaleString())||0]})]})]})})]}),a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[a("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e("div",{className:"lg:col-span-2",children:a("div",{className:"relative",children:[e(d,{icon:"ph:magnifying-glass",className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e("input",{type:"text",placeholder:"Search orders, customers...",value:y,onChange:t=>j(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})}),e("div",{children:a("select",{value:b,onChange:t=>B(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"All Statuses"}),e("option",{value:"pending",children:"Pending"}),e("option",{value:"processing",children:"Processing"}),e("option",{value:"completed",children:"Completed"}),e("option",{value:"failed",children:"Failed"}),e("option",{value:"cancelled",children:"Cancelled"}),e("option",{value:"refunded",children:"Refunded"})]})}),e("div",{children:a("select",{value:f,onChange:t=>G(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"All Types"}),e("option",{value:"deposit",children:"Deposit"}),e("option",{value:"withdrawal",children:"Withdrawal"}),e("option",{value:"gold_purchase",children:"Gold Purchase"}),e("option",{value:"silver_purchase",children:"Silver Purchase"}),e("option",{value:"gold_sale",children:"Gold Sale"}),e("option",{value:"silver_sale",children:"Silver Sale"})]})}),e("div",{children:e("input",{type:"date",value:u,onChange:t=>k(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",placeholder:"Start Date"})})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date"}),e("input",{type:"date",value:u,onChange:t=>k(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Date"}),e("input",{type:"date",value:N,onChange:t=>$(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]})]}),a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-hidden",children:[e("div",{className:"overflow-x-auto",children:a("table",{className:"w-full",children:[e("thead",{className:"bg-gray-50 dark:bg-slate-700",children:a("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Order ID"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Customer"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Type"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Asset"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Payment Method"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),e("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-gray-700",children:o.length===0?e("tr",{children:e("td",{colSpan:"8",className:"px-6 py-12 text-center",children:a("div",{className:"flex flex-col items-center",children:[e(d,{icon:"ph:shopping-cart",className:"text-6xl text-gray-400 mb-4"}),e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Investment Orders Found"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"No orders match your current filters."})]})})}):o.map(t=>{var i,l,x;return a("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700",children:[a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.orderId||"N/A"}),e("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.currency||"INR"})]}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((i=t.userId)==null?void 0:i.name)||"N/A"}),e("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:((l=t.userId)==null?void 0:l.email)||"N/A"})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:S(t.orderType)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:S(t.transactionType)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:U(t.status)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["\u20B9 ",((x=t.inramount)==null?void 0:x.toLocaleString())||0]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"text-sm text-gray-900 dark:text-white",children:t.Payment_method||"N/A"})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a("div",{className:"flex justify-end space-x-2",children:[e(c,{onClick:()=>R(t._id),className:"btn btn-sm btn-outline-primary",children:e(d,{icon:"ph:eye"})}),a("select",{value:t.status,onChange:s=>Q(t._id,s.target.value),className:"text-xs px-2 py-1 border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"pending",children:"Pending"}),e("option",{value:"processing",children:"Processing"}),e("option",{value:"completed",children:"Completed"}),e("option",{value:"failed",children:"Failed"}),e("option",{value:"cancelled",children:"Cancelled"}),e("option",{value:"refunded",children:"Refunded"})]})]})})]},t._id)})})]})}),r.totalPages>1&&a("div",{className:"bg-white dark:bg-slate-800 px-4 py-3 flex items-center justify-between border-t border-gray-200 dark:border-gray-700 sm:px-6",children:[a("div",{className:"flex-1 flex justify-between sm:hidden",children:[e(c,{onClick:()=>m(t=>Math.max(t-1,1)),disabled:!r.hasPrevPage,className:"btn btn-outline",children:"Previous"}),e(c,{onClick:()=>m(t=>Math.min(t+1,r.totalPages)),disabled:!r.hasNextPage,className:"btn btn-outline",children:"Next"})]}),a("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e("div",{children:a("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing"," ",e("span",{className:"font-medium",children:(r.currentPage-1)*r.limit+1})," ","to"," ",e("span",{className:"font-medium",children:Math.min(r.currentPage*r.limit,r.totalOrders)})," ","of"," ",e("span",{className:"font-medium",children:r.totalOrders})," ","results"]})}),e("div",{children:a("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e(c,{onClick:()=>m(t=>Math.max(t-1,1)),disabled:!r.hasPrevPage,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600",children:e(d,{icon:"ph:caret-left"})}),Array.from({length:Math.min(5,r.totalPages)},(t,i)=>{const l=Math.max(1,Math.min(r.totalPages-4,r.currentPage-2))+i;return l>r.totalPages?null:e(c,{onClick:()=>m(l),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${l===r.currentPage?"z-10 bg-blue-50 dark:bg-blue-900/20 border-blue-500 text-blue-600 dark:text-blue-400":"bg-white dark:bg-slate-700 border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600"}`,children:l},l)}),e(c,{onClick:()=>m(t=>Math.min(t+1,r.totalPages)),disabled:!r.hasNextPage,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600",children:e(d,{icon:"ph:caret-right"})})]})})]})]})]})]})};export{re as default};
