import{b as ae,r as o,j as e,L as re,c as a,B as i,I as x,Q as $}from"./index.db1e92fc.js";import{a as se}from"./orderApi.44bcba49.js";import{B as le}from"./Badge.ab3e07af.js";import{u as P,w as de}from"./xlsx.0799a57e.js";const ge=()=>{var D,O,L,_,j,B,E,T;const V=ae(),[w,Q]=o.exports.useState(""),[q,m]=o.exports.useState(1),[f,z]=o.exports.useState(""),[v,G]=o.exports.useState(""),[k,R]=o.exports.useState(""),[S,W]=o.exports.useState(""),H={page:q,limit:10,...f&&{status:f},...v&&{paymentStatus:v},...w&&{search:w},...k&&{startDate:k},...S&&{endDate:S}},{data:l,isLoading:J,error:A,refetch:K}=se(H),g=((D=l==null?void 0:l.data)==null?void 0:D.orders)||[],r=((O=l==null?void 0:l.data)==null?void 0:O.pagination)||{},h=((L=l==null?void 0:l.data)==null?void 0:L.summary)||{},C=((_=l==null?void 0:l.data)==null?void 0:_.breakdown)||{};console.log("Orders Response:",l),console.log("Orders:",g),console.log("Pagination:",r),console.log("Summary:",h);const X=t=>{V(`/orders/${t}`)},Y=t=>{const n={pending:{color:"bg-yellow-100 text-yellow-800",label:"Pending"},processing:{color:"bg-blue-100 text-blue-800",label:"Processing"},shipped:{color:"bg-purple-100 text-purple-800",label:"Shipped"},delivered:{color:"bg-green-100 text-green-800",label:"Delivered"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"},refunded:{color:"bg-gray-100 text-gray-800",label:"Refunded"}}[t]||{color:"bg-gray-100 text-gray-800",label:t};return e(le,{className:`${n.color} border-0`,children:n.label})},Z=((j=C.status)==null?void 0:j.map(t=>t._id))||[],ee=((B=C.paymentStatus)==null?void 0:B.map(t=>t._id))||[],te=()=>{try{const t=g.map((s,N)=>{var I,M,F,U;return{"S.No":N+1,"Order ID":s.orderCode||"N/A","Customer Name":((I=s.user)==null?void 0:I.name)||"N/A","Customer Email":((M=s.user)==null?void 0:M.email)||"N/A","Customer Phone":((F=s.user)==null?void 0:F.phone)||"N/A",Status:s.status||"N/A","Payment Status":s.paymentStatus||"N/A","Total Amount":s.totalAmount||0,"Items Count":((U=s.items)==null?void 0:U.length)||0,"Created At":s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A","Updated At":s.updatedAt?new Date(s.updatedAt).toLocaleDateString():"N/A"}}),d=P.book_new(),n=P.json_to_sheet(t),p=[{wch:5},{wch:20},{wch:25},{wch:15},{wch:15},{wch:12},{wch:12},{wch:10},{wch:12},{wch:15},{wch:10},{wch:12},{wch:15},{wch:15}];n["!cols"]=p,P.book_append_sheet(d,n,"Orders");const b=de(d,{bookType:"xlsx",type:"array"}),y=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),u=window.URL.createObjectURL(y),c=document.createElement("a");c.href=u,c.download=`orders_export_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(u),$.success("Order data exported successfully!")}catch(t){console.error("Export error:",t),$.error("Failed to export order data")}};return J?e("div",{className:"flex justify-center items-center h-64",children:e(re,{})}):A?a("div",{className:"text-center py-8",children:[a("p",{className:"text-red-500",children:["Error loading orders: ",A.message]}),e(i,{onClick:()=>K(),className:"mt-4",children:"Retry"})]}):a("div",{className:"space-y-6",children:[a("div",{className:"flex justify-between items-center",children:[a("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Product Orders"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage customer product orders"})]}),e("div",{className:"flex space-x-3",children:a(i,{onClick:te,className:"btn btn-outline-success",disabled:!g||g.length===0,children:[e(x,{icon:"ph:download",className:"mr-2"}),"Export Excel"]})})]}),h&&a("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-2 bg-blue-100 rounded-lg",children:e(x,{icon:"ph:shopping-cart",className:"text-blue-600 text-xl"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Orders"}),e("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h.totalOrders||0})]})]})}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-2 bg-green-100 rounded-lg",children:e(x,{icon:"ph:currency-dollar",className:"text-green-600 text-xl"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Revenue"}),a("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["\u20B9 ",((E=h.totalAmount)==null?void 0:E.toLocaleString())||0]})]})]})}),e("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:a("div",{className:"flex items-center",children:[e("div",{className:"p-2 bg-purple-100 rounded-lg",children:e(x,{icon:"ph:chart-line",className:"text-purple-600 text-xl"})}),a("div",{className:"ml-4",children:[e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Average Order Value"}),a("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["\u20B9 ",((T=h.averageOrderValue)==null?void 0:T.toLocaleString())||0]})]})]})})]}),a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-6",children:[a("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e("div",{className:"lg:col-span-2",children:a("div",{className:"relative",children:[e(x,{icon:"ph:magnifying-glass",className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e("input",{type:"text",placeholder:"Search orders, customers, or products...",value:w,onChange:t=>Q(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})}),e("div",{children:a("select",{value:f,onChange:t=>z(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"All Statuses"}),Z.map(t=>e("option",{value:t,children:t},t))]})}),e("div",{children:a("select",{value:v,onChange:t=>G(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"All Payment Status"}),ee.map(t=>e("option",{value:t,children:t},t))]})})]}),a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date"}),e("input",{type:"date",value:k,onChange:t=>R(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Date"}),e("input",{type:"date",value:S,onChange:t=>W(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]})]}),a("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-hidden",children:[e("div",{className:"overflow-x-auto",children:a("table",{className:"w-full",children:[e("thead",{className:"bg-gray-50 dark:bg-slate-700",children:a("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Order ID"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Customer"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Products"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"})]})}),e("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-gray-700",children:g.map(t=>{var d,n,p,b,y,u;return a("tr",{onClick:()=>X(t._id),className:"hover:bg-gray-50 dark:hover:bg-slate-700",children:[a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.orderCode||"N/A"}),a("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[((d=t.items)==null?void 0:d.length)||0," items"]})]}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:[e("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((n=t.user)==null?void 0:n.name)||"N/A"}),e("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:((p=t.user)==null?void 0:p.email)||"N/A"})]}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a("div",{className:"text-sm text-gray-900 dark:text-white",children:[(b=t.items)==null?void 0:b.slice(0,2).map((c,s)=>{var N;return e("div",{className:"truncate max-w-32",children:((N=c.productDataid)==null?void 0:N.name)||"Product"},s)}),((y=t.items)==null?void 0:y.length)>2&&a("div",{className:"text-xs text-gray-500",children:["+",t.items.length-2," more"]})]})}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:Y(t.status)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["\u20B9",((u=t.totalAmount)==null?void 0:u.toLocaleString())||0]})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]},t._id)})})]})}),r.totalPages>1&&a("div",{className:"bg-white dark:bg-slate-800 px-4 py-3 flex items-center justify-between border-t border-gray-200 dark:border-gray-700 sm:px-6",children:[a("div",{className:"flex-1 flex justify-between sm:hidden",children:[e(i,{onClick:()=>m(t=>Math.max(t-1,1)),disabled:!r.hasPrevPage,className:"btn btn-sm btn-outline",children:"Previous"}),e(i,{onClick:()=>m(t=>Math.min(t+1,r.totalPages)),disabled:!r.hasNextPage,className:"btn btn-sm btn-outline",children:"Next"})]}),a("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e("div",{children:a("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Showing ",e("span",{className:"font-medium",children:(r.currentPage-1)*r.limit+1})," to"," ",e("span",{className:"font-medium",children:Math.min(r.currentPage*r.limit,r.totalOrders)})," ","of ",e("span",{className:"font-medium",children:r.totalOrders})," results"]})}),e("div",{children:a("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e(i,{onClick:()=>m(t=>Math.max(t-1,1)),disabled:!r.hasPrevPage,className:"btn btn-sm btn-outline rounded-l-md",children:"Previous"}),Array.from({length:r.totalPages},(t,d)=>d+1).map(t=>e(i,{onClick:()=>m(t),className:`btn btn-sm ${r.currentPage===t?"btn-primary":"btn-outline"}`,children:t},t)),e(i,{onClick:()=>m(t=>Math.min(t+1,r.totalPages)),disabled:!r.hasNextPage,className:"btn btn-sm btn-outline rounded-r-md",children:"Next"})]})})]})]})]})]})};export{ge as default};
