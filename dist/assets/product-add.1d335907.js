import{b as De,a1 as Pe,r as M,R as de,c as t,j as e,L as Fe,I as N,B as T,C as ue,F as me,Q as U}from"./index.a3fd4963.js";import{c as Ae,d as Ie,e as Se,a as Le}from"./productApi.0747bb22.js";import{u as Te,a as Me}from"./imageApi.c1c7af18.js";import{u as je}from"./utilsApi.c40d388b.js";const Ge=({detail:P,index:V,onUpdateDetail:w,onRemove:a})=>{const[p,W]=M.exports.useState(""),[K,B]=M.exports.useState(""),z=x=>{w({...P,type:x})},_=(x,j)=>{const O={...P.attributes,[x]:j};w({...P,attributes:O})},Z=()=>{if(p.trim()){const x={...P.attributes,[p]:K};w({...P,attributes:x}),W(""),B("")}},J=x=>{const j={...P.attributes};delete j[x],w({...P,attributes:j})};return t("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[t("div",{className:"mb-4",children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type (e.g., Metal, Stone)"}),e("input",{type:"text",value:P.type,onChange:x=>z(x.target.value),placeholder:"e.g., Metal, Stone",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{className:"mb-4",children:[t("div",{className:"flex justify-between items-center mb-2",children:[e("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Attributes"}),t("span",{className:"text-xs text-gray-500",children:[Object.keys(P.attributes||{}).length," attributes"]})]}),e("div",{className:"space-y-2 mb-3",children:Object.entries(P.attributes||{}).map(([x,j])=>t("div",{className:"flex gap-2 items-center bg-gray-50 dark:bg-slate-800 p-2 rounded",children:[e("input",{type:"text",value:x,readOnly:!0,className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-gray-100 dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:j,onChange:O=>_(x,O.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("button",{type:"button",onClick:()=>J(x),className:"text-red-500 hover:text-red-700 p-1",children:e(N,{icon:"ph:x"})})]},x))}),t("div",{className:"flex gap-2",children:[e("input",{type:"text",value:p,onChange:x=>W(x.target.value),placeholder:"Attribute name (e.g., karatage, name)",className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:K,onChange:x=>B(x.target.value),placeholder:"Value",className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:bg-slate-700 dark:text-white"}),e("button",{type:"button",onClick:Z,className:"px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600",children:e(N,{icon:"ph:plus"})})]})]}),e("div",{className:"flex justify-end",children:t(T,{type:"button",onClick:a,className:"btn btn-sm btn-outline-danger",children:[e(N,{icon:"ph:trash",className:"mr-2"}),"Remove Detail"]})})]})},Ve=()=>{var ne;const P=De(),{id:V}=Pe(),w=!!V,[a,p]=M.exports.useState({name:"",brand:"",description:"",active:!0,stock:0,CurrentlyNotavaiable:!1,categories:"",popular:!1,trending:!1,categoryId:"",skuId:"",rating:{value:0,count:0},selectedCaret:"",metalType:"gold",productDetails:[],priceDetails:[],subtotal:{weight:""},Discount:0,isDiscountAvaiable:!1,gst:0,images:[]}),[W,K]=M.exports.useState([]),[B,z]=M.exports.useState(!1),_=M.exports.useRef(!1),[Z,{isLoading:J}]=Ae(),[x,{isLoading:j}]=Ie(),[O,{isLoading:Ue}]=Te(),[ge]=Me(),{data:v,isLoading:ee,error:q}=Se(V,{skip:!w}),{data:I}=Le(),{data:te}=je(),ae=de.useMemo(()=>{if(!I)return[];if(I.data){if(Array.isArray(I.data.categories))return I.data.categories;if(Array.isArray(I.data))return I.data}return Array.isArray(I.categories)?I.categories:Array.isArray(I)?I:[]},[I]),h=te==null?void 0:te.data,Q=(h==null?void 0:h.goldPrice24kt)||(h==null?void 0:h.goldPrice)||0,re=(h==null?void 0:h.goldPrice22kt)||0,se=(h==null?void 0:h.goldPrice18kt)||0,H=(h==null?void 0:h.silverPrice)||0,le=(h==null?void 0:h.silverRate925)||0,g=de.useMemo(()=>v?(v==null?void 0:v.products)&&Array.isArray(v.products)?v.products[0]:v!=null&&v.product?v.product:v!=null&&v.data?v.data:v&&typeof v=="object"?v:null:null,[v]);M.exports.useEffect(()=>{w&&console.log("Edit Mode Debug:",{id:V,isLoadingProduct:ee,productError:q,productResponse:v,extractedProduct:g})},[w,V,ee,q,v,g]),M.exports.useEffect(()=>{var n,r;w&&g&&(console.log("Prefilling form with product data:",g),p({name:g.name||"",brand:g.brand||"",description:g.description||"",active:(n=g.active)!=null?n:!0,stock:g.stock||0,CurrentlyNotavaiable:g.CurrentlyNotavaiable||!1,categories:g.categories||"",popular:g.popular||!1,trending:g.trending||!1,categoryId:g.categoryId||"",skuId:g.skuId||"",rating:g.rating||{value:0,count:0},selectedCaret:g.selectedCaret||"",metalType:g.metalType||((r=g.selectedCaret)!=null&&r.toLowerCase().includes("silver")?"silver":"gold"),productDetails:g.productDetails||[],priceDetails:(g.priceDetails||[]).map(s=>({name:s.name||"",weight:s.weight||"",value:typeof s.value=="number"?s.value:parseFloat(s.value||0)})),subtotal:g.subtotal||{weight:""},Discount:g.Discount||0,isDiscountAvaiable:g.isDiscountAvaiable||!1,gst:g.gst||0,images:g.images||[]}),K(g.images||[]))},[w,g]);const C=n=>{const{name:r,value:s,type:i,checked:l}=n.target;if(r.includes(".")){const[o,d]=r.split(".");p(u=>({...u,[o]:{...u[o],[d]:s}}))}else p(o=>{const d={...o,[r]:i==="checkbox"?l:s};return r==="metalType"&&(d.selectedCaret=""),d})},pe=async n=>{const r=Array.from(n.target.files);if(r.length===0)return;const s=5*1024*1024,i=r.filter(l=>l.size>s);if(i.length>0){U.error(`Some files exceed 5MB limit: ${i.map(l=>l.name).join(", ")}`),n.target.value="";return}console.log("Files selected:",r.length,r),z(!0);try{try{const l=new FormData;r.forEach((u,c)=>{l.append("images",u)}),console.log("FormData entries:");for(let[u,c]of l.entries())console.log(u,c);const o=await O(l).unwrap();console.log("Multiple upload response:",o);let d=[];if(o.urls&&Array.isArray(o.urls))d=o.urls;else if(o.data&&Array.isArray(o.data))d=o.data;else if(o.images&&Array.isArray(o.images))d=o.images;else if(Array.isArray(o))d=o;else if(o.url)d=[o.url];else throw new Error("Unexpected response format from multiple upload");if(d.length>0){const u=d.map(c=>typeof c=="string"?c:c&&c.url?c.url:c);K(c=>[...c,...u]),p(c=>({...c,images:[...c.images,...u]})),U.success(`${u.length} file(s) uploaded successfully`);return}}catch(l){console.log("Multiple upload failed, trying single uploads:",l);const o=[];for(const d of r)try{const u=new FormData;u.append("image",d);const c=await ge(u).unwrap();console.log("Single upload response:",c),c.url?o.push(c.url):c.data&&c.data.url?o.push(c.data.url):c.imageUrl?o.push(c.imageUrl):c.data&&typeof c.data=="string"&&o.push(c.data)}catch(u){console.error(`Failed to upload ${d.name}:`,u),U.error(`Failed to upload ${d.name}`)}o.length>0?(K(d=>[...d,...o]),p(d=>({...d,images:[...d.images,...o]})),U.success(`${o.length} file(s) uploaded successfully`)):U.error("Failed to upload any files")}}catch(l){U.error("Failed to upload files"),console.error("Upload error:",l)}finally{z(!1)}},be=n=>{K(r=>r.filter((s,i)=>i!==n)),p(r=>({...r,images:r.images.filter((s,i)=>i!==n)}))},he=()=>{p(n=>({...n,productDetails:[...n.productDetails,{type:"",attributes:{}}]}))},fe=n=>{p(r=>({...r,productDetails:r.productDetails.filter((s,i)=>i!==n)}))},ye=()=>{p(n=>({...n,priceDetails:[...n.priceDetails,{name:"",weight:"",value:""}]}))},xe=n=>{p(r=>({...r,priceDetails:r.priceDetails.filter((s,i)=>i!==n)}))},ve=(n,r,s)=>{if(!s||s==="")return 0;const i=parseFloat(s.toString().replace(/[^\d.]/g,""))||0;if(i===0)return 0;if(n==="gold"){let l=0;return r==="24K"?l=Q:r==="22K"?l=re||Q*.916:r==="18K"&&(l=se||Q*.75),l*i}else if(n==="silver"){let l=0;return r==="Pure Silver 999"?l=H:r==="Silver 925"&&(l=le||H*.925),l*i}return 0},$=M.exports.useCallback(n=>{var oe,ce;if(!n.metalType||!n.selectedCaret||!h||_.current)return null;_.current=!0;const r=n.priceDetails.map(y=>({name:y.name||"",weight:y.weight||"",value:typeof y.value=="number"?y.value:parseFloat(y.value||0)}));let s=-1,i=null;const l=n.metalType==="gold"?"Gold":"Silver";if(s=r.findIndex(y=>{var L;return(L=y.name)==null?void 0:L.toLowerCase().includes(l.toLowerCase())}),s===-1&&(r.push({name:l,weight:"",value:0}),s=r.length-1),i={name:r[s].name||l,weight:r[s].weight||"",value:typeof r[s].value=="number"?r[s].value:parseFloat(r[s].value||0)},(oe=i.name)!=null&&oe.toLowerCase().includes(l.toLowerCase())||(i.name=l),i.weight){const y=ve(n.metalType,n.selectedCaret,i.weight);i.value=parseFloat(y.toFixed(2))}else i.value=parseFloat(i.value||0);r[s]=i;let o=0;r.forEach((y,L)=>{var F;if(L!==s){const G=((F=y.name)==null?void 0:F.toLowerCase())||"";(G.includes("stone")||G.includes("diamond")||G.includes("ruby")||G.includes("emerald")||G.includes("sapphire")||G.includes("pearl"))&&(o+=parseFloat(y.value||0))}});const d=parseFloat(i.value||0);let u=r.findIndex(y=>{var L;return(L=y.name)==null?void 0:L.toLowerCase().includes("making charges")}),c=0;if(u>=0){const y=((ce=r[u].weight)==null?void 0:ce.toString())||"";c=parseFloat(y.replace(/[^\d.]/g,""))||0}const D=d+o,b=D*c/100,k=D+b,A=n.Discount||0,E=k*A/100,f=k-E,m=n.gst||0,S=f*m/100,X=f+S,Ne=["sub total","subtotal","discount","gst","grand total","final price","total"],Y=r.filter((y,L)=>{var G;if(L===s)return!0;const F=((G=y.name)==null?void 0:G.toLowerCase())||"";return F.includes("making charges")||F.includes("stone")||F.includes("diamond")||F.includes("ruby")||F.includes("emerald")||F.includes("sapphire")||F.includes("pearl")?!0:!Ne.some(Ce=>F.includes(Ce))});if(u>=0){const y=Y.findIndex(L=>{var F;return(F=L.name)==null?void 0:F.toLowerCase().includes("making charges")});y>=0&&(Y[y].value=parseFloat(b.toFixed(2)))}else c>0&&Y.push({name:"Making Charges",weight:`${c}%`,value:parseFloat(b.toFixed(2))});const R=[...Y],ie=(i.weight||"").toString().replace(/[^\d.]/g,""),we=ie?`${ie}g Gross Wt.`:"Gross Wt.";return R.push({name:"Sub Total",weight:we,value:parseFloat(k.toFixed(2))}),A>0&&R.push({name:"Discount",weight:`${A}%`,value:parseFloat(E.toFixed(2))}),R.push({name:"Sub Total After Discount",weight:"After discount",value:parseFloat(f.toFixed(2))}),R.push({name:"GST",weight:`${m}%`,value:parseFloat(S.toFixed(2))}),R.push({name:"Grand Total",weight:"Final Price",value:parseFloat(X.toFixed(2))}),_.current=!1,R},[a.metalType,a.selectedCaret,a.Discount,a.gst,Q,re,se,H,le,h]);M.exports.useEffect(()=>{if(!h||_.current)return;if((a.Discount>0||a.gst>0)&&(!a.metalType||!a.selectedCaret)){const r=a.priceDetails.find(s=>{var i,l;return((i=s.name)==null?void 0:i.toLowerCase().includes("sub total"))&&!((l=s.name)!=null&&l.toLowerCase().includes("after"))});if(r){const s=parseFloat(r.value||0),i=a.Discount||0,l=s*i/100,o=s-l,d=a.gst||0,u=o*d/100,c=o+u,D=a.priceDetails.map(b=>{var A;const k=((A=b.name)==null?void 0:A.toLowerCase())||"";return k.includes("discount")?{...b,weight:`${i}%`,value:parseFloat(l.toFixed(2))}:k.includes("sub total after discount")?{...b,value:parseFloat(o.toFixed(2))}:k.includes("gst")&&!k.includes("cgst")&&!k.includes("sgst")?{...b,weight:`${d}%`,value:parseFloat(u.toFixed(2))}:k.includes("grand total")?{...b,value:parseFloat(c.toFixed(2))}:b});if(!D.find(b=>{var k;return(k=b.name)==null?void 0:k.toLowerCase().includes("discount")})&&i>0){const b=D.findIndex(k=>{var A,E;return((A=k.name)==null?void 0:A.toLowerCase().includes("sub total"))&&!((E=k.name)!=null&&E.toLowerCase().includes("after"))});b>=0&&D.splice(b+1,0,{name:"Discount",weight:`${i}%`,value:parseFloat(l.toFixed(2))})}p(b=>({...b,priceDetails:D}));return}}if(!a.metalType||!a.selectedCaret)return;const n=$(a);if(n){const r=a.metalType==="gold"?"Gold":"Silver",s=a.priceDetails.find(l=>{var o;return(o=l.name)==null?void 0:o.toLowerCase().includes(r.toLowerCase())});((s==null?void 0:s.weight)||n.length!==a.priceDetails.length||a.Discount>0||a.gst>0)&&p(l=>({...l,priceDetails:n}))}},[a.metalType,a.selectedCaret,a.Discount,a.gst,Q,re,se,H,le,h,$]);const ke=async n=>{var r;n.preventDefault();try{const s={...a,stock:parseInt(a.stock)||0,rating:{value:parseFloat(a.rating.value)||0,count:parseInt(a.rating.count)||0},subtotal:{weight:a.subtotal.weight},Discount:parseFloat(a.Discount)||0,gst:parseFloat(a.gst)||0};console.log("Submitting product data:",s),console.log("Images array:",s.images),s.images=s.images.map(i=>typeof i=="string"?i:i&&i.url?i.url:String(i)),console.log("Processed images:",s.images),w?(await x({id:V,...s}).unwrap(),U.success("Product updated successfully")):(await Z(s).unwrap(),U.success("Product added successfully")),P("/products")}catch(s){console.log("Submit error:",s),U.error(((r=s.data)==null?void 0:r.message)||"Failed to save product")}};return w&&ee?t("div",{className:"flex justify-center items-center h-64",children:[e(Fe,{}),e("p",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading product..."})]}):w&&q?t("div",{className:"flex flex-col justify-center items-center h-64",children:[e(N,{icon:"ph:warning-circle",className:"text-4xl text-red-500 mb-4"}),e("p",{className:"text-red-500 text-lg mb-2",children:"Failed to load product"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:((ne=q==null?void 0:q.data)==null?void 0:ne.message)||"Product not found"}),t(T,{onClick:()=>P("/products"),className:"btn btn-outline",children:[e(N,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}):w&&!g?t("div",{className:"flex flex-col justify-center items-center h-64",children:[e(N,{icon:"ph:magnifying-glass",className:"text-4xl text-gray-400 mb-4"}),e("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Product not found"}),t(T,{onClick:()=>P("/products"),className:"btn btn-outline",children:[e(N,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}):t("div",{className:"space-y-6",children:[t("div",{className:"flex justify-between items-center",children:[t("div",{children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:w?"Edit Product":"Add New Product"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:w?"Update product information":"Create a new product"})]}),t(T,{onClick:()=>P("/products"),className:"btn btn-outline",children:[e(N,{icon:"ph:arrow-left",className:"mr-2"}),"Back to Products"]})]}),t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e("div",{className:"lg:col-span-2",children:e(ue,{title:"Product Information",children:t("form",{onSubmit:ke,className:"space-y-6",children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Product Name *"}),e("input",{type:"text",name:"name",value:a.name,onChange:C,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Brand *"}),e("input",{type:"text",name:"brand",value:a.brand,onChange:C,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"SKU ID *"}),e("input",{type:"text",name:"skuId",value:a.skuId,onChange:C,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),t("select",{name:"categories",value:a.categories,onChange:C,required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Category"}),ae.map(n=>e("option",{value:n.name,children:n.name},n._id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category Id *"}),t("select",{name:"categoryId",value:a.categoryId,onChange:n=>p(r=>{var s;return{...r,categoryId:n.target.value,categories:((s=ae.find(i=>i._id===n.target.value))==null?void 0:s.name)||""}}),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Category Id"}),ae.map(n=>e("option",{value:n._id,children:n.name},n._id))]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Stock *"}),e("input",{type:"number",name:"stock",value:a.stock,onChange:C,required:!0,min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),e("textarea",{name:"description",value:a.description,onChange:C,required:!0,rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t("div",{className:"flex items-center space-x-4",children:[t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"active",checked:a.active,onChange:C,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Active"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"CurrentlyNotavaiable",checked:a.CurrentlyNotavaiable,onChange:C,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Currently Not Available"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"popular",checked:a.popular,onChange:C,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Popular"})]}),t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"trending",checked:a.trending,onChange:C,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Trending"})]})]}),t("div",{className:"grid grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rating Value"}),e("input",{type:"number",name:"rating.value",value:a.rating.value,onChange:C,min:"0",max:"5",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rating Count"}),e("input",{type:"number",name:"rating.count",value:a.rating.count,onChange:C,min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Metal Type"}),t("div",{className:"flex gap-6",children:[t("label",{className:"flex items-center cursor-pointer",children:[e("input",{type:"radio",name:"metalType",value:"gold",checked:a.metalType==="gold",onChange:C,className:"h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300"}),t("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[e(N,{icon:"ph:medal",className:"text-yellow-500 mr-1"}),"Gold"]})]}),t("label",{className:"flex items-center cursor-pointer",children:[e("input",{type:"radio",name:"metalType",value:"silver",checked:a.metalType==="silver",onChange:C,className:"h-4 w-4 text-gray-400 focus:ring-gray-500 border-gray-300"}),t("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[e(N,{icon:"ph:medal",className:"text-gray-400 mr-1"}),"Silver"]})]})]})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:a.metalType==="gold"?"Gold Karat":"Silver Purity"}),a.metalType==="gold"?t("select",{name:"selectedCaret",value:a.selectedCaret,onChange:C,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Karat"}),e("option",{value:"24K",children:"24 Karat (Pure Gold - 99.9%)"}),e("option",{value:"22K",children:"22 Karat (91.67%)"}),e("option",{value:"18K",children:"18 Karat (75%)"})]}):t("select",{name:"selectedCaret",value:a.selectedCaret,onChange:C,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white",children:[e("option",{value:"",children:"Select Purity"}),e("option",{value:"Pure Silver 999",children:"Pure Silver 999 (99.9%)"}),e("option",{value:"Silver 925",children:"Silver 925 (92.5% - Sterling Silver)"})]})]}),t("div",{children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pricing & Discount"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subtotal Weight"}),e("input",{type:"text",name:"subtotal.weight",value:a.subtotal.weight,onChange:C,placeholder:"e.g., 2.96g",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Discount (%)"}),e("input",{type:"number",name:"Discount",value:a.Discount,onChange:n=>{const r=parseFloat(n.target.value)||0;p(s=>{const i={...s,Discount:r};return setTimeout(()=>{const l=$(i);l&&p(o=>({...o,priceDetails:l}))},0),i})},min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]}),t("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"GST (%)"}),e("input",{type:"number",name:"gst",value:a.gst,onChange:n=>{const r=parseFloat(n.target.value)||0;p(s=>{const i={...s,gst:r};return setTimeout(()=>{const l=$(i);l&&p(o=>({...o,priceDetails:l}))},0),i})},min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"})]})]}),e("div",{className:"mt-4",children:t("div",{className:"flex items-center",children:[e("input",{type:"checkbox",name:"isDiscountAvaiable",checked:a.isDiscountAvaiable,onChange:C,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e("label",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Discount Available"})]})})]}),t("div",{children:[t("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Product Details"}),t(T,{type:"button",onClick:he,className:"btn btn-sm btn-outline",children:[e(N,{icon:"ph:plus",className:"mr-2"}),"Add Product Detail"]})]}),e("div",{className:"space-y-4",children:a.productDetails.map((n,r)=>e(Ge,{detail:n,index:r,onUpdateDetail:s=>{const i=[...a.productDetails];i[r]=s,p(l=>({...l,productDetails:i}))},onRemove:()=>fe(r)},r))})]}),t("div",{children:[e("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:t("div",{className:"flex items-start",children:[e(N,{icon:"heroicons-outline:information-circle",className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-2 mt-0.5 flex-shrink-0"}),t("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e("p",{className:"font-semibold mb-2",children:"Important Notes:"}),t("ul",{className:"list-disc list-inside space-y-1",children:[t("li",{children:["Making Charges, Discount, and GST should be entered as ",e("strong",{children:"percentage (%)"})]}),t("li",{children:["For stones (Diamond, Ruby, etc.), enter weight in ",e("strong",{children:"karat"})," and amount"]}),t("li",{children:["For Gold and Silver, enter weight in ",e("strong",{children:"grams (gms)"})," and amount"]})]})]})]})}),t("div",{className:"flex justify-between items-center mb-4",children:[e("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Price Details"}),t(T,{type:"button",onClick:ye,className:"btn btn-sm btn-outline",children:[e(N,{icon:"ph:plus",className:"mr-2"}),"Add Price Detail"]})]}),e("div",{className:"space-y-2",children:a.priceDetails.map((n,r)=>t("div",{className:"flex gap-2",children:[e("input",{type:"text",value:n.name,onChange:s=>{const i=a.priceDetails.map((l,o)=>o===r?{name:s.target.value,weight:l.weight||"",value:typeof l.value=="number"?l.value:parseFloat(l.value||0)}:{name:l.name||"",weight:l.weight||"",value:typeof l.value=="number"?l.value:parseFloat(l.value||0)});p(l=>{var u;const o={...l,priceDetails:i};return(((u=s.target.value)==null?void 0:u.toLowerCase())||"").includes("making charges")&&setTimeout(()=>{const c=$(o);c&&p(D=>({...D,priceDetails:c}))},0),o})},placeholder:"Name (e.g., Gold, Stone, Making Charges)",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e("input",{type:"text",value:n.weight||"",onChange:s=>{const i=a.priceDetails.map((l,o)=>o===r?{name:l.name||"",weight:s.target.value,value:typeof l.value=="number"?l.value:parseFloat(l.value||0)}:{name:l.name||"",weight:l.weight||"",value:typeof l.value=="number"?l.value:parseFloat(l.value||0)});p(l=>{var c;const o={...l,priceDetails:i},d=((c=n.name)==null?void 0:c.toLowerCase())||"",u=l.metalType==="gold"?"Gold":"Silver";return(d.includes(u.toLowerCase())||d.includes("making charges"))&&setTimeout(()=>{const D=$(o);D&&p(b=>({...b,priceDetails:D}))},0),o})},placeholder:"Weight (e.g., 2.903g) or % for Making Charges",className:"w-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e("input",{type:"number",value:n.value||"",onChange:s=>{const i=parseFloat(s.target.value)||0,l=a.priceDetails.map((o,d)=>d===r?{name:o.name||"",weight:o.weight||"",value:i}:{name:o.name||"",weight:o.weight||"",value:typeof o.value=="number"?o.value:parseFloat(o.value||0)});p(o=>{var c;const d={...o,priceDetails:l},u=((c=n.name)==null?void 0:c.toLowerCase())||"";return(u.includes("stone")||u.includes("diamond")||u.includes("ruby")||u.includes("emerald")||u.includes("sapphire")||u.includes("pearl")||u.includes("making charges"))&&setTimeout(()=>{const D=$(d);D&&p(b=>({...b,priceDetails:D}))},0),d})},placeholder:"Value",min:"0",step:"0.01",className:"w-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"}),e(T,{type:"button",onClick:()=>xe(r),className:"btn btn-sm btn-outline-danger",children:e(N,{icon:"ph:trash"})})]},r))}),(()=>{var c,D,b,k,A,E;const n=a.metalType==="gold"?"Gold":"Silver",r=a.priceDetails.find(f=>{var m;return(m=f.name)==null?void 0:m.toLowerCase().includes(n.toLowerCase())}),s=a.priceDetails.filter(f=>{var S;const m=((S=f.name)==null?void 0:S.toLowerCase())||"";return(m.includes("stone")||m.includes("diamond")||m.includes("ruby")||m.includes("emerald")||m.includes("sapphire")||m.includes("pearl"))&&!m.includes(n.toLowerCase())}).reduce((f,m)=>f+(parseFloat(m.value)||0),0),i=a.priceDetails.find(f=>{var m;return(m=f.name)==null?void 0:m.toLowerCase().includes("making charges")}),l=a.priceDetails.find(f=>{var m,S;return((m=f.name)==null?void 0:m.toLowerCase().includes("sub total"))&&!((S=f.name)!=null&&S.toLowerCase().includes("after"))}),o=a.priceDetails.find(f=>{var m;return(m=f.name)==null?void 0:m.toLowerCase().includes("discount")}),d=a.priceDetails.find(f=>{var m,S,X;return((m=f.name)==null?void 0:m.toLowerCase().includes("gst"))&&!((S=f.name)!=null&&S.toLowerCase().includes("cgst"))&&!((X=f.name)!=null&&X.toLowerCase().includes("sgst"))}),u=a.priceDetails.find(f=>{var m;return(m=f.name)==null?void 0:m.toLowerCase().includes("grand total")});return!r||!r.weight?null:t("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[t("h4",{className:"text-sm font-semibold text-green-800 dark:text-green-200 mb-3 flex items-center",children:[e(N,{icon:"ph:calculator",className:"mr-2"}),"Price Calculation Summary"]}),t("div",{className:"space-y-2 text-sm",children:[t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:[n," (",a.selectedCaret,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((c=r.value)==null?void 0:c.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),s>0&&t("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-700 dark:text-gray-300",children:"Stones:"}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",s.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),i&&i.value>0&&t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:["Making Charges (",i.weight,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((D=i.value)==null?void 0:D.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),l&&t("div",{className:"flex justify-between pt-2 border-t border-green-200 dark:border-green-700",children:[e("span",{className:"font-medium text-gray-900 dark:text-white",children:"Sub Total:"}),t("span",{className:"font-semibold text-gray-900 dark:text-white",children:["\u20B9",((b=l.value)==null?void 0:b.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),o&&o.value>0&&t("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[t("span",{children:["Discount (",o.weight,"):"]}),t("span",{className:"font-medium",children:["-\u20B9",((k=o.value)==null?void 0:k.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),d&&d.value>0&&t("div",{className:"flex justify-between",children:[t("span",{className:"text-gray-700 dark:text-gray-300",children:["GST (",d.weight,"):"]}),t("span",{className:"font-medium text-gray-900 dark:text-white",children:["\u20B9",((A=d.value)==null?void 0:A.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]}),u&&t("div",{className:"flex justify-between pt-2 border-t-2 border-green-300 dark:border-green-600",children:[e("span",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:"Grand Total:"}),t("span",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:["\u20B9",((E=u.value)==null?void 0:E.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]})]})]})})()]}),t("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e(T,{type:"button",onClick:()=>P("/products"),className:"btn btn-outline",children:"Cancel"}),e(T,{type:"submit",disabled:J||j||B,className:"btn btn-primary",children:J||j||B?t(me,{children:[e(N,{icon:"ph:spinner",className:"animate-spin mr-2"}),w?"Updating...":"Adding..."]}):t(me,{children:[e(N,{icon:"ph:check",className:"mr-2"}),w?"Update Product":"Add Product"]})})]})]})})}),e("div",{className:"lg:col-span-1",children:e(ue,{title:"Product Images",children:t("div",{className:"space-y-4",children:[t("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[e("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:pe,disabled:B,className:"hidden",id:"image-upload"}),t("label",{htmlFor:"image-upload",className:`cursor-pointer ${B?"opacity-50 cursor-not-allowed":""}`,children:[e(N,{icon:"ph:cloud-arrow-up",className:"text-4xl text-gray-400 mx-auto mb-4"}),e("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:B?"Uploading...":"Click to upload images & videos"}),e("p",{className:"text-xs text-gray-500 mt-1",children:"Images (PNG, JPG, GIF, WEBP) & Videos (MP4, WEBM, MOV) up to 5MB each"})]})]}),W.length>0&&t("div",{className:"space-y-2",children:[t("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Uploaded Media (",W.length,")"]}),e("div",{className:"grid grid-cols-2 gap-2",children:W.map((n,r)=>{const s=typeof n=="string"?n:n.url||n,i=s&&(s.includes(".mp4")||s.includes(".webm")||s.includes(".mov")||s.includes("/video/")||typeof n=="object"&&n.format&&n.format.includes("video"));return t("div",{className:"relative group",children:[i?e("video",{src:s,className:"w-full h-24 object-cover rounded-lg border border-gray-200 dark:border-gray-600",controls:!0,muted:!0}):e("img",{src:s,alt:`Product ${r+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200 dark:border-gray-600"}),e(T,{onClick:()=>be(r),className:"absolute -top-2 -right-2 btn btn-sm btn-danger rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e(N,{icon:"ph:x"})})]},r)})})]}),a.name&&t("div",{className:"border-t pt-4",children:[e("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Product Preview"}),e("div",{className:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4",children:t("div",{className:"text-sm space-y-2",children:[e("p",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),e("p",{className:"text-gray-600 dark:text-gray-400",children:a.brand}),t("p",{className:"text-gray-600 dark:text-gray-400",children:["SKU: ",a.skuId]}),a.stock>0&&t("p",{className:"text-gray-600 dark:text-gray-400",children:["Stock: ",a.stock]}),a.selectedCaret&&t("p",{className:"text-gray-600 dark:text-gray-400",children:["Carat: ",a.selectedCaret]}),t("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.active&&e("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:"Active"}),a.CurrentlyNotavaiable&&e("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Not Available"}),a.popular&&e("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:"Popular"}),a.trending&&e("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Trending"}),a.isDiscountAvaiable&&a.Discount>0&&t("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:[a.Discount,"% Off"]})]})]})})]})]})})})]})]})};export{Ve as default};
